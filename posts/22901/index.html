<!DOCTYPE html><html class="hide-aside" lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹ | Muggledy's Blog</title><meta name="keywords" content="Python"><meta name="author" content="Muggledy"><meta name="copyright" content="Muggledy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ç±»æ˜¯åˆ›å»ºæ–°å¯¹è±¡ç±»å‹çš„æœºåˆ¶ï¼Œå½“è§£å†³ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œé¢å‘å¯¹è±¡ä¼šæŠŠäº‹ç‰©æŠ½è±¡æˆå¯¹è±¡çš„æ¦‚å¿µï¼Œå°±æ˜¯è¯´è¿™ä¸ªé—®é¢˜é‡Œé¢æœ‰å“ªäº›å¯¹è±¡ï¼Œç„¶åç»™å¯¹è±¡èµ‹ä¸€äº›å±æ€§å’Œæ–¹æ³•ï¼Œç„¶åè®©æ¯ä¸ªå¯¹è±¡å»æ‰§è¡Œè‡ªå·±çš„æ–¹æ³•ï¼Œé—®é¢˜å¾—åˆ°è§£å†³..."><meta property="og:type" content="article"><meta property="og:title" content="PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹"><meta property="og:url" content="https://muggledy.top/posts/22901/index.html"><meta property="og:site_name" content="Muggledy&#39;s Blog"><meta property="og:description" content="ç±»æ˜¯åˆ›å»ºæ–°å¯¹è±¡ç±»å‹çš„æœºåˆ¶ï¼Œå½“è§£å†³ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œé¢å‘å¯¹è±¡ä¼šæŠŠäº‹ç‰©æŠ½è±¡æˆå¯¹è±¡çš„æ¦‚å¿µï¼Œå°±æ˜¯è¯´è¿™ä¸ªé—®é¢˜é‡Œé¢æœ‰å“ªäº›å¯¹è±¡ï¼Œç„¶åç»™å¯¹è±¡èµ‹ä¸€äº›å±æ€§å’Œæ–¹æ³•ï¼Œç„¶åè®©æ¯ä¸ªå¯¹è±¡å»æ‰§è¡Œè‡ªå·±çš„æ–¹æ³•ï¼Œé—®é¢˜å¾—åˆ°è§£å†³..."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://i.loli.net/2021/09/16/tdDuVfFBgy5bGpr.jpg"><meta property="article:published_time" content="2021-05-01T13:05:41.000Z"><meta property="article:modified_time" content="2021-05-05T15:36:03.000Z"><meta property="article:author" content="Muggledy"><meta property="article:tag" content="Python"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://i.loli.net/2021/09/16/tdDuVfFBgy5bGpr.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210207091812.png"><link rel="canonical" href="https://muggledy.top/posts/22901/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v5.7/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç°¡"},noticeOutdate:{limitDay:500,position:"top",messagePrev:"è¿™ç¯‡æ–‡ç« å·²ç»å‘è¡¨äº†",messageNext:"å¤©äº†ï¼Œå…¶ä¸­æŸäº›å†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ã€‚"},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"å¤©",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:{limitCount:50,languages:{author:"ä½œè€…: Muggledy",link:"é“¾æ¥: ",source:"æ¥æº: Muggledy's Blog",info:"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},lightbox:"fancybox",Snackbar:void 0,source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isanchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!0,isToc:!0,postUpdate:"2021-05-05 23:36:03"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,n={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(n))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const a=saveToLocal.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"))})(window)</script><link rel="stylesheet" href="/css/mystyle.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/font_awesome/font-awesome-animation.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/button/buttons.min.css"><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.2/data/katong_font/katong-font.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.9/data/img_preview/article_img_preview.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v1.0/data/bubble/bubble.js"></script><script src="https://cdn.staticfile.org/moment.js/2.24.0/moment.js"></script><script src="https://cdn.jsdelivr.net/npm/echarts@5.1.2/dist/echarts.min.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/data/is_pc/is-pc-etc.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v3.1/data/hint/hint.min.css"><script>IsPC()&&loadJS("/live2d-widget/autoload.js",(function(){}))</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Muggledy's Blog" type="application/atom+xml"></head><div class="dyminibox"></div><body><div class="dy-show-cbg" id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.1/img/20210202152223.jpg" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/img/20210328224511.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">3</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-book"></i> <span>æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child" style="left:-73.89999999999999px"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i> <span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-folder-open faa-tada"></i> <span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart card-announcement-animation"></i> <span>å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/note/"><i class="fa-fw fas fa-bullhorn"></i> <span>å…¬ç¤º</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>æ›´å¤š</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child" style="left:-90.69999999999999px"><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><i class="fa-fw fas fa-image faa-tada"></i> <span>å›¾å†Œé›†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="fa-fw fas fa-video faa-tada"></i> <span>ç”µå½±</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:void(0);" rel="external nofollow noreferrer" onclick="dogo()"><i class="fa-fw fas fa-layer-group faa-tada"></i> <span>éšä¾¿çœ‹çœ‹</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v2.1/compress/16.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Muggledy's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw faa-wrench animated"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-book"></i> <span>æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child" style="left:-73.89999999999999px"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i> <span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-folder-open faa-tada"></i> <span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart card-announcement-animation"></i> <span>å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/note/"><i class="fa-fw fas fa-bullhorn"></i> <span>å…¬ç¤º</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>æ›´å¤š</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child" style="left:-90.69999999999999px"><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><i class="fa-fw fas fa-image faa-tada"></i> <span>å›¾å†Œé›†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="fa-fw fas fa-video faa-tada"></i> <span>ç”µå½±</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:void(0);" rel="external nofollow noreferrer" onclick="dogo()"><i class="fa-fw fas fa-layer-group faa-tada"></i> <span>éšä¾¿çœ‹çœ‹</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-05-01T13:05:41.000Z" title="å‘è¡¨äº 2021-05-01 21:05:41">2021-05-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-05-05T15:36:03.000Z" title="æ›´æ–°äº 2021-05-05 23:36:03">2021-05-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">è®¡ç®—æœºåŸºç¡€</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">ç¼–ç¨‹è¯­è¨€</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">11.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>44åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/posts/22901/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/posts/22901/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div style="display:none"><div class="note green icon flat"><i class="note-icon fas fa-rocket"></i><p>ğŸ“š æ–‡æ¡£ç›®å½•<br>ğŸƒ <span style="color:#49b1f5;cursor:pointer" onclick='pjax.loadUrl("/posts/5311/")'><span style="color:#3a96dd">ç±»å‹å’Œå¯¹è±¡</span></span> - ğŸˆ <span style="color:#49b1f5;cursor:pointer" onclick='pjax.loadUrl("/posts/176/")'><span style="color:#3a96dd">ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹</span></span> - ğŸ é¢å‘å¯¹è±¡ç¼–ç¨‹</p></div></div><div class="note green icon flat"><i class="note-icon fas fa-rocket"></i><p>ğŸ“š æ–‡æ¡£ç›®å½•<br>ğŸƒ <a href="/posts/5311/"><span style="color:#3a96dd">ç±»å‹å’Œå¯¹è±¡</span></a> - ğŸˆ <a href="/posts/176/"><span style="color:#3a96dd">ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹</span></a> - ğŸ é¢å‘å¯¹è±¡ç¼–ç¨‹</p></div><h2 id="ç±»">ç±»</h2><div class="tabs" id="sxfwkz"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#sxfwkz-1"><code>class</code>è¯­å¥</button></li><li class="tab"><button type="button" data-href="#sxfwkz-2"><code>__slots__</code></button></li><li class="tab"><button type="button" data-href="#sxfwkz-3">ç§æœ‰å±æ€§</button></li><li class="tab"><button type="button" data-href="#sxfwkz-4"><code>__new__()</code></button></li><li class="tab"><button type="button" data-href="#sxfwkz-5">å…ƒç±»</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="sxfwkz-1"><p>ç±»å®šä¹‰äº†ä¸€ç»„å±æ€§ï¼ŒåŒ…æ‹¬å˜é‡ï¼ˆæŒ‡ç±»å˜é‡ï¼Œä¸ºæ‰€æœ‰å®ä¾‹å…±äº«ï¼‰ã€æ–¹æ³•ï¼ˆæœ‰ä¸‰ç§ç±»å‹ï¼Œå®ä¾‹æ–¹æ³•ã€é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•ï¼‰ä»¥åŠç”±<code>@property</code>æ”¯æŒçš„ç‰¹æ€§ï¼ˆéœ€è¦è®¡ç®—çš„å±æ€§ï¼‰ï¼Œä½¿ç”¨<code>class</code>è¯­å¥å¯ä»¥åˆ›å»ºç±»å¯¹è±¡ï¼ˆæ³¨æ„åŒºåˆ†â€œç±»å¯¹è±¡â€å’Œâ€œç±»å®ä¾‹â€ï¼‰ï¼Œç±»å¯ä»¥å……å½“ä¸€ä¸ªå‘½åç©ºé—´ï¼Œä¸æ¨¡å—å¾ˆç±»ä¼¼ï¼Œç±»çš„å®ä¾‹æ˜¯ä»¥å‡½æ•°å½¢å¼è°ƒç”¨ç±»å¯¹è±¡æ¥åˆ›å»ºçš„ï¼ˆç±»åååŠ å°æ‹¬å·ï¼‰ï¼Œç„¶åå°†åˆ›å»ºçš„å®ä¾‹ä¼ é€’ç»™ç±»çš„<code>__init__()</code>æ–¹æ³•ï¼Œ<code>__init__()</code>æ–¹æ³•çš„å‚æ•°åŒ…æ‹¬æ–°åˆ›å»ºçš„å®ä¾‹<code>self</code>å’Œç”¨äºåˆå§‹åŒ–å®ä¾‹çš„ä¸€äº›å…¶ä»–å‚æ•°ï¼ˆå¯ä»¥ç¼ºçœï¼‰ï¼Œæ³¨æ„<code>__init__()</code>åªèƒ½è¿”å›<code>None</code>ï¼Œå¯ä»¥åœ¨å…¶ä¸­å°†ä¸€äº›åˆå§‹åŒ–å‚æ•°ç»‘å®šåœ¨<code>self</code>å¯¹è±¡ä¸Šä½œä¸ºå®ä¾‹å±æ€§ï¼Œä¹‹åå¯ä»¥é€šè¿‡å±æ€§åå’Œ<code>.</code>è¿ç®—ç¬¦è®¿é—®åˆ°å®ä¾‹çš„è¿™äº›å±æ€§ï¼ˆä»»æ„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>__dict__</code>å­—å…¸å±æ€§ï¼Œå½“ç„¶ä¹Ÿæœ‰ç‰¹ä¾‹ï¼Œå­˜å‚¨äº†æ‰€æœ‰é€šè¿‡<code>obj.property=value</code>æ–¹å¼åŠ¨æ€ç»‘å®šåœ¨å¯¹è±¡ä¸Šçš„å±æ€§ï¼‰ï¼Œåœ¨è®¿é—®å±æ€§æ—¶ï¼Œé¦–å…ˆä¼šæ£€æŸ¥å®ä¾‹ï¼Œå¦‚æœä¸çŸ¥é“è¯¥å±æ€§çš„ä»»ä½•ä¿¡æ¯ï¼Œåˆ™ä¼šå¯¹å®ä¾‹çš„ç±»è¿›è¡Œæœç´¢ï¼Œå¦‚æœè¿˜æ²¡æœ‰ï¼Œä¼šç»§ç»­æœç´¢å…¶çˆ¶ç±»ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„åŸºç±»å¯ä¾›æœç´¢</p><p>ç»§æ‰¿æ˜¯ä¸€ç§åˆ›å»ºæ–°ç±»çš„æœºåˆ¶ï¼Œç›®çš„æ˜¯ä¸“é—¨ä½¿ç”¨æˆ–ä¿®æ”¹ç°æœ‰ç±»çš„è¡Œä¸ºï¼ŒåŸå§‹ç±»ç§°ä¸ºåŸºç±»æˆ–è¶…ç±»ï¼Œæ–°ç±»ç§°ä¸ºæ´¾ç”Ÿç±»æˆ–å­ç±»ï¼Œé€šè¿‡ç»§æ‰¿åˆ›å»ºç±»æ—¶ï¼ˆå¯ä»¥æœ‰å¤šä¸ªåŸºç±»ï¼Œå³å¤šç»§æ‰¿ï¼Œå¦åˆ™å«å•ç»§æ‰¿ï¼‰ï¼Œæ‰€åˆ›å»ºçš„ç±»å°†ç»§æ‰¿å…¶åŸºç±»å®šä¹‰ä¸­çš„å±æ€§ï¼ˆæ³¨æ„ç»§æ‰¿çš„æ˜¯ç±»å±æ€§è€Œä¸ä¼šç»§æ‰¿åŸºç±»çš„ä»»ä½•å®ä¾‹çš„ç»‘å®šå±æ€§ï¼‰ï¼Œä¸”æ´¾ç”Ÿç±»å¯ä»¥é‡æ–°å®šä¹‰ä»»ä½•è¿™äº›å±æ€§å¹¶æ·»åŠ è‡ªå·±çš„æ–°å±æ€§ã€‚å­ç±»å¦‚æœæ²¡æœ‰å®šä¹‰è‡ªå·±çš„<code>__init__()</code>æ–¹æ³•ï¼Œå®ä¾‹åŒ–å­ç±»çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–å‡½æ•°ï¼ˆ<code>__new__()</code>ä¹Ÿä¸€æ ·ï¼‰ï¼Œåä¹‹ï¼Œåˆ™ä¸ä¼šè°ƒç”¨ï¼Œé™¤éæ‰‹åŠ¨æ‰§è¡Œ<code>super().__init__()</code>ï¼ˆä¸å»ºè®®é€šè¿‡çˆ¶ç±»ç±»åè°ƒç”¨<code>__init__()</code>æ–¹æ³•ï¼‰ï¼Œå…³äºå¤šé‡ç»§æ‰¿æ—¶çš„å±æ€§æŸ¥æ‰¾ï¼Œä¼šæŒ‰ç…§MROé¡ºåºï¼ˆ<a href="/posts/5311/">ç¬¬ä¸€ç« èŠ‚</a>å·²ç»è°ˆè¿‡è¿™ä¸ªé—®é¢˜ï¼‰ä¾åºæœç´¢åŸºç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name</span>):</span></span><br><span class="line">        self.name=name</span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WorkDog</span>(<span class="params">Dog</span>):</span> <span class="comment">#å·¥ä½œç‹—</span></span><br><span class="line">    allnum=<span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name,identity</span>):</span> <span class="comment">#å·¥ä½œç‹—é™¤äº†å§“åï¼Œè¿˜å…·æœ‰ç¼–åˆ¶identityï¼Œå½“å‰å…¨éƒ¨æ³¨å†Œçš„å·¥ä½œç‹—æ•°é‡ç”±allnumç±»å±æ€§è®°å½•</span></span><br><span class="line">        self.__class__.allnum+=<span class="number">1</span> <span class="comment">#åƒä¸‡ä¸èƒ½å†™æˆself.allnum+=1æˆ–è€…WorkDog.allnum+=1ï¼Œå¦‚æœæ²¡æœ‰æ´¾ç”Ÿç±»çš„è¯ï¼Œåè€…æ‰æ­£ç¡®ï¼Œå‰è€…å°†ä¼šåˆ›å»ºä¸€ä¸ªä¸ç±»å±æ€§allnumåŒåçš„å®ä¾‹ç»‘å®šå±æ€§ï¼ˆä½†è‹¥ç±»å®šä¹‰allnumæ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡çš„è¯ï¼Œåˆ™åˆä¸ä¼šæ–°åˆ›å»ºå®ä¾‹ç»‘å®šå±æ€§ï¼Œé™¤éå†™æˆself.allnum=self.allnum+1çš„å½¢å¼ï¼Œå› ä¸º+=å¯¹å¯å˜å¯¹è±¡æ¥è¯´æ˜¯ä¸€ä¸ªåŸå€æ“ä½œï¼Œç¤ºä¾‹å‚è§https://github.com/leisurelicht/wtfpython-cn#-class-attributes-and-instance-attributes%E7%B1%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7ï¼‰ï¼Œæ•°å€¼å°†æ€»æ˜¯ä¸º1ï¼Œä½†æ˜¯åœ¨è®¿é—®è¯¥ç±»å±æ€§çš„æ—¶å€™ï¼Œæ€»æ˜¯å¯ä»¥å†™æˆself.allnumï¼Œå› ä¸ºå®ä¾‹ä¸Šæ‰¾ä¸åˆ°ï¼Œä¼šè‡ªåŠ¨åˆ°ç±»ä¸­å¯»æ‰¾</span></span><br><span class="line">        self.identity=identity</span><br><span class="line">        <span class="built_in">super</span>().__init__(name) <span class="comment">#è‡ªå®šä¹‰__init__()åï¼Œé™¤éæ‰‹åŠ¨è°ƒç”¨çˆ¶ç±»åˆå§‹åŒ–æ–¹æ³•ï¼Œå¦åˆ™ä¸ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œåœ¨å•ç»§æ‰¿æƒ…å†µä¸‹å†™æˆDog.__init__(self,name)ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯å¤šç»§æ‰¿å°±ä¸ä¸€å®šäº†ï¼Œå› æ­¤æ€»æ˜¯å»ºè®®é‡‡ç”¨superæ–¹å¼ï¼Œè€Œä¸”åè€…å½¢å¼æ›´åŠ ç®€çº¦ï¼Œsuper()ï¼ˆpython3ä¸­ç­‰ä»·äºsuper(WorkDog,self)ï¼‰è¿”å›superå¯¹è±¡ï¼ˆç›¸å½“äºçˆ¶ç±»ä½†ä¸æ˜¯åŸå§‹çˆ¶ç±»ï¼Œæ˜¯ç»‘å®šäº†å®ä¾‹selfçš„bound super objectï¼Œä¸”å¤šç»§æ‰¿çš„æ—¶å€™è¿”å›çš„è¿˜å¯èƒ½æ˜¯å…„å¼Ÿç±»ï¼Œå…·ä½“å‚è§ç¬¬ä¸€ç« èŠ‚æ‰€æåˆ°çš„é’»çŸ³ç»§æ‰¿ï¼‰ï¼Œä¸åŒäºå…¶ä»–é€šè¿‡ç±»è®¿é—®å®ä¾‹æ–¹æ³•ï¼ˆè¿”å›éç»‘å®šæ–¹æ³•ï¼Œåªæœ‰é€šè¿‡å®ä¾‹è®¿é—®å®ä¾‹æ–¹æ³•æ‰è¿”å›ç»‘å®šæ–¹æ³•ï¼‰çš„æƒ…å†µï¼Œæ­¤å¤„è¿”å›çš„ä¹Ÿæ˜¯â€œç»‘å®šæ–¹æ³•â€ï¼Œå³ç»‘å®šäº†selfå‚æ•°çš„çˆ¶ç±»__init__()æ–¹æ³•ï¼Œå› æ­¤è°ƒç”¨æ—¶ä¸éœ€è¦å†ä¼ å…¥selfå‚æ•°</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">work</span>(<span class="params">self</span>):</span> <span class="comment">#ä¸€ä¸ªå…¬å¼€çš„æœªå®ç°çš„æ¥å£ï¼Œå­ç±»åº”é‡è½½ä¹‹</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__class__.allnum-=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArmyDog</span>(<span class="params">WorkDog</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">work</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;<span class="subst">&#123;self.name&#125;</span>(<span class="subst">&#123;self.identity&#125;</span>)åœ¨è¿½å‡»æ•Œäºº&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DrugDog</span>(<span class="params">WorkDog</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">work</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;<span class="subst">&#123;self.name&#125;</span>(<span class="subst">&#123;self.identity&#125;</span>)åœ¨è¿½æŸ¥æ¯’å“&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuperDog</span>(<span class="params">DrugDog,ArmyDog</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name,identity</span>):</span></span><br><span class="line">        self.__class__.allnum=<span class="number">0</span> <span class="comment">#è®¿é—®SuperDog.allnumæ—¶ä¼šåœ¨åŸºç±»ï¼ˆArmyDogæˆ–DrugDogï¼‰ä¸­æŸ¥æ‰¾ï¼Œå¯èƒ½å·²ç»éé›¶äº†</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name,identity)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">army_dog_1=ArmyDog(<span class="string">&#x27;Cherry&#x27;</span>,<span class="built_in">id</span>(<span class="string">&#x27;Cherry&#x27;</span>)) <span class="comment">#ArmyDogç›´æ¥ç»§æ‰¿äº†çˆ¶ç±»çš„__init__()æ–¹æ³•ï¼Œåˆå§‹åŒ–ArmyDogç±»å®ä¾‹çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ä¹‹</span></span><br><span class="line">army_dog_2=ArmyDog(<span class="string">&#x27;Black&#x27;</span>,<span class="built_in">id</span>(<span class="string">&#x27;Black&#x27;</span>))</span><br><span class="line"></span><br><span class="line">print(army_dog_2.__dict__) <span class="comment">#&#123;&#x27;identity&#x27;: 1761656222920, &#x27;name&#x27;: &#x27;Black&#x27;&#125; #é€šè¿‡__dict__å®ä¾‹å±æ€§å­—å…¸æŸ¥æ‰¾ç”¨æˆ·ç»‘å®šåœ¨å®ä¾‹ä¸Šçš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">army_dog_2_ref=army_dog_2 <span class="comment">#å¯¹army_dog_2æ‰€æŒ‡å‘çš„å¯¹è±¡å¼•ç”¨è®¡æ•°+1ï¼Œäºæ˜¯å½“å‰å¼•ç”¨æ•°æ€»è®¡ä¸º2</span></span><br><span class="line"></span><br><span class="line">drug_dog_1=DrugDog(<span class="string">&#x27;HelloKit&#x27;</span>,<span class="built_in">id</span>(<span class="string">&#x27;HelloKit&#x27;</span>))</span><br><span class="line">drug_dog_2=DrugDog(<span class="string">&#x27;Jack&#x27;</span>,<span class="built_in">id</span>(<span class="string">&#x27;Jack&#x27;</span>))</span><br><span class="line">drug_dog_3=DrugDog(<span class="string">&#x27;Pig&#x27;</span>,<span class="built_in">id</span>(<span class="string">&#x27;Pig&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> army_dog_2 <span class="comment">#delè¯­å¥çœ‹ä¼¼æ˜¯â€œåˆ é™¤å¯¹è±¡â€ï¼Œå‡†ç¡®è¯´å…¶å®æ˜¯å¯¹è±¡å¼•ç”¨è®¡æ•°-1ï¼Œä¸”delè¯­å¥å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œ__del__()æ–¹æ³•ï¼Œåªæœ‰åœ¨å¯¹è±¡çš„å¼•ç”¨è®¡æ•°é™ä¸º0çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼Œè¿™æ—¶å€™å¯¹è±¡æ‰ä¼šçœŸçš„ä»å†…å­˜ä¸­åˆ é™¤</span></span><br><span class="line">print(ArmyDog.allnum) <span class="comment">#2 #å†™æˆarmy_dog_1.allnumä¹Ÿæ­£ç¡®ï¼Œä½†æ˜¯è¯­ä¹‰ä¸æ˜ï¼Œå› ä¸ºallnumæ˜æ˜æ˜¯ä¸€ä¸ªç±»å±æ€§ï¼Œé€šè¿‡å®ä¾‹è®¿é—®ä¼šè®©äººè¯¯ä»¥ä¸ºæ˜¯å®ä¾‹å±æ€§</span></span><br><span class="line">print(DrugDog.allnum) <span class="comment">#3</span></span><br><span class="line"><span class="keyword">del</span> army_dog_2_ref</span><br><span class="line">print(ArmyDog.allnum) <span class="comment">#1</span></span><br><span class="line"></span><br><span class="line">drug_dog_2.work() <span class="comment">#Jack(2607617062368)åœ¨è¿½æŸ¥æ¯’å“</span></span><br><span class="line"></span><br><span class="line">super_dog_1=SuperDog(<span class="string">&#x27;Hero&#x27;</span>,<span class="built_in">id</span>(<span class="string">&#x27;Hero&#x27;</span>))</span><br><span class="line">print(super_dog_1.__class__.mro()) <span class="comment">#[&lt;class &#x27;__main__.SuperDog&#x27;&gt;, &lt;class &#x27;__main__.DrugDog&#x27;&gt;, &lt;class &#x27;__main__.ArmyDog&#x27;&gt;, &lt;class &#x27;__main__.WorkDog&#x27;&gt;, &lt;class &#x27;__main__.Dog&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;]</span></span><br><span class="line">super_dog_1.work() <span class="comment">#Hero(2359695357632)åœ¨è¿½æŸ¥æ¯’å“ #SuperDogå¹¶æœªå®ç°è‡ªå·±çš„work()æ–¹æ³•ï¼Œå› æ­¤åœ¨å±æ€§æŸ¥æ‰¾æ—¶ï¼Œä¼šé¡ºç€MROåˆ—è¡¨ä¾æ¬¡åœ¨â€œåŸºç±»â€ä¸­å¯»æ‰¾ï¼ŒMROåˆ—è¡¨ä¸­ä½äºSuperDogä¹‹åçš„æ­£æ˜¯DrugDogï¼Œè€ŒDrugDogç±»ç¡®å®å®šä¹‰äº†è‡ªå·±çš„work()æ–¹æ³•ï¼Œæ‰€ä»¥å±æ€§æŸ¥æ‰¾åˆ°æ­¤ç»“æŸï¼Œå°±æ˜¯å®ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span>(<span class="params">self</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;self.name&#125;</span>(<span class="subst">&#123;self.identity&#125;</span>)åœ¨è¿½å‡»æ•Œäººï¼ŒåŒæ—¶åœ¨è¿½æŸ¥æ¯’å“&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">SuperDog.work=work <span class="comment">#ç»™ç±»åŠ¨æ€ç»‘å®šå±æ€§æ–¹æ³•ï¼Œä¸”é»˜è®¤æ˜¯å®ä¾‹æ–¹æ³•ï¼Œç›¸å½“äºä½ ä¸€å¼€å§‹åœ¨å®šä¹‰SuperDogçš„åœ°æ–¹å†™äº†work()æ–¹æ³•</span></span><br><span class="line">super_dog_1.work() <span class="comment">#Hero(1559184520896)åœ¨è¿½å‡»æ•Œäººï¼ŒåŒæ—¶åœ¨è¿½æŸ¥æ¯’å“</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@classmethod</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_allnum</span>(<span class="params">cls</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;cls&#125;</span>ç±»æ€»æ•°é‡ä¸º<span class="subst">&#123;cls.allnum&#125;</span>&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">SuperDog.print_allnum=print_allnum <span class="comment">#ç»™ç±»å¯¹è±¡åŠ¨æ€ç»‘å®šç±»æ–¹æ³•ï¼ŒåŒç†é™æ€æ–¹æ³•ä¹Ÿå¯ä»¥</span></span><br><span class="line">SuperDog.print_allnum() <span class="comment">#&lt;class &#x27;__main__.SuperDog&#x27;&gt;ç±»æ€»æ•°é‡ä¸º1 #ä¹Ÿå¯ä»¥é€šè¿‡å®ä¾‹è°ƒç”¨ç±»æ–¹æ³•ï¼Œsuper_dog_1.print_allnum()</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="sxfwkz-2"><p>é€šå¸¸ä½ å¯ä»¥ä¸ºç±»å®ä¾‹åŠ¨æ€ç»‘å®šä»»æ„æ•°é‡çš„ä»»æ„å±æ€§ï¼Œå½“ä½ è¦é™åˆ¶æ­¤è¡Œä¸ºæ—¶ï¼Œæˆ–è€…å½“ä¸€ä¸ªç±»éœ€è¦åˆ›å»ºå¤§é‡å®ä¾‹è¦èŠ‚çœå†…å­˜æ—¶ï¼Œå¯ä»¥è®¾ç½®<code>__slots__</code>ç±»å±æ€§å£°æ˜å®ä¾‹å¯åŠ¨æ€ç»‘å®šçš„å±æ€§èŒƒå›´ï¼Œä¸€æ—¦å®šä¹‰<code>__slots__</code>ï¼Œç±»å®ä¾‹å°±ä¸å†æœ‰<code>__dict__</code>å±æ€§ï¼Œä¸”ç±»ä¸­ä¸èƒ½å†å®šä¹‰ä¸<code>__slots__</code>åˆ—è¡¨ä¸­åŒåçš„å±æ€§ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span>:</span></span><br><span class="line">    __slots__=(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">    <span class="comment">#name=&#x27;xxx&#x27; #ValueError: &#x27;name&#x27; in __slots__ conflicts with class variable #ç±»ä¸­ä¸èƒ½å†å®šä¹‰å‡ºç°åœ¨__slots__åˆ—è¡¨ä¸­çš„å±æ€§</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">s=student()</span><br><span class="line">s.name=<span class="string">&#x27;dy&#x27;</span></span><br><span class="line">s.score=<span class="number">8.0</span></span><br><span class="line"><span class="comment">#s.sex=&#x27;female&#x27; #AttributeError: &#x27;student&#x27; object has no attribute &#x27;sex&#x27; #æ— æ³•ä¸ºå®ä¾‹åŠ¨æ€ç»‘å®šé__slots__åˆ—è¡¨å±æ€§</span></span><br><span class="line"><span class="comment">#print(s.__dict__) #AttributeError: &#x27;student&#x27; object has no attribute &#x27;__dict__&#x27; #å®šä¹‰__slots__ç±»å±æ€§çš„ç±»å®ä¾‹ä¸å†æœ‰__dict__å±æ€§å­—å…¸</span></span><br><span class="line"></span><br><span class="line">student.school=<span class="string">&#x27;nuist&#x27;</span> <span class="comment">#__slots__ä¸ä¼šé™åˆ¶ç±»æœ¬èº«å¯åŠ¨æ€ç»‘å®šå±æ€§çš„èŒƒå›´</span></span><br><span class="line">print(student.__dict__) <span class="comment">#&#123;&#x27;__module__&#x27;: &#x27;__main__&#x27;, &#x27;__slots__&#x27;: (&#x27;name&#x27;, &#x27;score&#x27;), &#x27;name&#x27;: &lt;member &#x27;name&#x27; of &#x27;student&#x27; objects&gt;, &#x27;score&#x27;: &lt;member &#x27;score&#x27; of &#x27;student&#x27; objects&gt;, &#x27;__doc__&#x27;: None, &#x27;school&#x27;: &#x27;nuist&#x27;&#125; #æ³¨æ„çœ‹ç±»çš„__dict__ä¸­æœ‰äº†nameå’Œscoreä¸¤ä¸ªå±æ€§ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢åœ¨ç±»ä¸­å®šä¹‰åŒåå±æ€§nameæ—¶ä¼šå‘ç”Ÿå†²çª</span></span><br></pre></td></tr></table></figure><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œ<code>__slots__</code>ä¸æ˜¯ä½œä¸ºä¸€ç§å®‰å…¨ç‰¹æ€§ï¼Œè™½ç„¶å®šä¹‰äº†<code>__slots__</code>çš„ç±»ä¸å†ä¾èµ–<code>__dict__</code>å­—å…¸è¿›è¡Œå®ä¾‹å±æ€§çš„å­˜å‚¨å’ŒæŸ¥æ‰¾ï¼Œä»è€Œè¾¾åˆ°éšè—å®ä¾‹åŠ¨æ€ç»‘å®šçš„å±æ€§çš„ç›®çš„ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¯¹å±æ€§è®¿é—®æœ¬èº«å¢åŠ ä»»ä½•æ§åˆ¶ï¼Œå…¶ä¸»è¦ç›®çš„è¿˜æ˜¯å¯¹å†…å­˜å’Œæ€§èƒ½çš„ä¼˜åŒ–ï¼Œä½¿ç”¨<code>__slots__</code>çš„ç±»å®ä¾‹ä¸å†ä½¿ç”¨å­—å…¸æ¥å­˜å‚¨å®ä¾‹ç»‘å®šå±æ€§ï¼Œå®ƒä¼šä½¿ç”¨åŸºäºæ•°ç»„çš„æ›´åŠ ç´§å¯†çš„æ•°æ®ç»“æ„ï¼Œåœ¨åˆ›å»ºå¤§é‡å¯¹è±¡çš„ç¨‹åºä¸­ï¼Œä½¿ç”¨<code>__slots__</code>å¯ä»¥æ˜¾è‘—å‡å°‘<a target="_blank" rel="noopener external nofollow noreferrer" href="http://tech.oyster.com/save-ram-with-python-slots/">å†…å­˜å ç”¨</a>å’Œæ‰§è¡Œæ—¶é—´ï¼ˆç›´æ¥é€šè¿‡æ•°ç»„å†…å­˜åœ°å€åç§»è®¿é—®<code>__slots__</code>ä¸­å®šä¹‰çš„å±æ€§æ¯”é€šè¿‡<code>__dict__</code>å­—å…¸è¿›è¡Œå±æ€§æŸ¥æ‰¾è¦å¿«ï¼‰ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥ä¸€äº›éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Œ1ï¼‰<code>__slots__</code>æ— æ³•è¢«ç»§æ‰¿ï¼Œæ¯ä¸ªå­ç±»éƒ½è¦é‡æ–°å®šä¹‰ä¸€éï¼Œå¦‚æœå¿˜è®°è¿™ä¸€ç‚¹ï¼Œå­ç±»çš„æ‰§è¡Œé€Ÿåº¦å°†æ¯”æ²¡æœ‰ä½¿ç”¨<code>__slots__</code>æ—¶æ›´æ…¢ï¼Œ2ï¼‰å®ä¾‹åªèƒ½åŠ¨æ€ç»‘å®šé‚£äº›åœ¨<code>__slots__</code>åˆ—è¡¨ä¸­å‡ºç°çš„å±æ€§ï¼Œæå¤§å½±å“äº†ç¨‹åºçš„çµæ´»æ€§ï¼Œ3ï¼‰å®ä¾‹ä¸èƒ½è¢«å¼±å¼•ç”¨ï¼Œé™¤éå°†<code>'__weakref__'</code>æ”¾è¿›<code>__slots__</code></p><p>å…³äºä¸Šè¿°ç¬¬ä¸€ç‚¹ï¼Œå­ç±»å¦‚æœæ²¡æœ‰é‡æ–°å®šä¹‰<code>__slots__</code>ï¼ŒåŠ¨æ€ç»‘å®šå°†ä¸å—é™åˆ¶ï¼Œé‡æ–°å®šä¹‰æ—¶å¦‚æœå’ŒåŸºç±»ä¸€è‡´ï¼Œå¯ä»¥ç›´æ¥èµ‹ä¸€ä¸ªç©ºå€¼<code>__slots__=()</code>ï¼Œä¹Ÿå¯ä»¥åœ¨åŸºç±»çš„åŸºç¡€ä¸Šè¿›è¡Œå¢è¡¥ï¼Œä½†æ— æ³•åˆ é™¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">graduate</span>(<span class="params">student</span>):</span></span><br><span class="line">    __slots__=(<span class="string">&#x27;sex&#x27;</span>) <span class="comment">#ä¸€ä¸ªç¬”è¯¯ï¼Œä¹‹å‰ä»¥ä¸º__slots__å¿…é¡»æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ­¤å¤„ç­‰åŒäºï¼š__slots__=&#x27;sex&#x27;ï¼Œå½“å‰å­ç±»graduateçš„__slots__åœ¨åŸºç±»åŸºç¡€ä¸Šæ‰©å±•ï¼Œå±æ€§èŒƒå›´é™åˆ¶åœ¨[&#x27;name&#x27;,&#x27;score&#x27;,&#x27;sex&#x27;]</span></span><br><span class="line">    </span><br><span class="line">g=graduate()</span><br><span class="line">g.name=<span class="string">&#x27;dy&#x27;</span></span><br><span class="line">g.score=<span class="number">25</span></span><br><span class="line">g.sex=<span class="string">&#x27;female&#x27;</span></span><br><span class="line">print(g.sex)</span><br></pre></td></tr></table></figure><p>å…³äºç¬¬ä¸‰ç‚¹ï¼Œå¼±å¼•ç”¨çš„é—®é¢˜ï¼Œå®šä¹‰äº†<code>__slots__</code>çš„ç±»å®ä¾‹æ— æ³•è¢«å¼±å¼•ç”¨ï¼Œå› ä¸ºæ­¤æ—¶ä¸ä»…æ˜¯ç±»å®ä¾‹çš„<code>__dict__</code>å±æ€§è¢«ç¦ç”¨ï¼Œ<code>__weakref__</code>å±æ€§ä¹Ÿè¢«ç¦ç”¨ï¼Œ<code>__weakref__</code>å±æ€§æ˜¯å¹²å˜›çš„ï¼Ÿå‡è®¾å¯¹å¯¹è±¡è¿›è¡Œå¼±å¼•ç”¨ï¼Œé‚£ä¹ˆåˆ›å»ºçš„å¼±å¼•ç”¨å°†å­˜å‚¨åœ¨å¯¹è±¡çš„<code>__weakref__</code>å±æ€§ä¸­ï¼Œå› æ­¤è§£å†³åŠæ³•å°±æ˜¯å°†<code>'__weakref__'</code>æ”¾è¿›<code>__slots__</code>åˆ—è¡¨ä¸­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">graduate</span>(<span class="params">student</span>):</span></span><br><span class="line">    __slots__=(<span class="string">&#x27;sex&#x27;</span>,<span class="string">&#x27;__weakref__&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"></span><br><span class="line">g=graduate()</span><br><span class="line">print(g.__weakref__) <span class="comment">#None #æ­¤æ—¶è¿˜æ²¡æœ‰å¼±å¼•ç”¨</span></span><br><span class="line">ref=weakref.ref(g) <span class="comment">#å¦‚æœæ²¡æœ‰å°†&#x27;__weakref__&#x27;æ”¾åˆ°__slots__ä¸­ï¼Œåˆ™æŠ¥é”™ï¼šTypeError: cannot create weak reference to &#x27;graduate&#x27; object</span></span><br><span class="line">print(g.__weakref__) <span class="comment">#&lt;weakref at 0x000002595C39C4F8; to &#x27;graduate&#x27; at 0x000002595C60CDC8&gt;</span></span><br><span class="line"></span><br><span class="line">g.name=<span class="string">&#x27;muggle&#x27;</span></span><br><span class="line">g.score=<span class="number">25</span></span><br><span class="line">g.sex=<span class="string">&#x27;female&#x27;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">f&#x27;<span class="subst">&#123;ref().name&#125;</span>,<span class="subst">&#123;ref().sex&#125;</span>,<span class="subst">&#123;ref().score&#125;</span>&#x27;</span>) <span class="comment">#muggle,female,25 #è°ƒç”¨å¼±å¼•ç”¨å°†è·å–è¢«å¼±å¼•ç”¨çš„åŸå§‹å¯¹è±¡</span></span><br></pre></td></tr></table></figure><div class="hide-toggle"><div class="hide-button toggle-title"><i class="fas fa-caret-right fa-fw"></i><span>å¼±å¼•ç”¨</span></div><div class="hide-content"><p><code>weakref</code>æ¨¡å—å…è®¸ç”¨æˆ·åˆ›å»ºå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨ï¼ˆweak referenceï¼‰ï¼Œç›¸æ¯”äºæ™®é€šçš„å¼•ç”¨ï¼ˆä¸ºäº†å’Œâ€œå¼±å¼•ç”¨â€è¿™ä¸€åè¯å¯¹åº”ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£ä¸­æ˜ç¡®æœ‰strong referenceâ€œå¼ºå¼•ç”¨â€ä¸€è¯´ï¼‰æ¥è¯´ï¼Œåªè¦å­˜åœ¨ä»»ä½•ä¸€ä¸ªå¯¹å¯¹è±¡çš„å¼ºå¼•ç”¨ï¼ˆå³å¼•ç”¨è®¡æ•°å¤§äº1ï¼Œæ³¨æ„å¼±å¼•ç”¨ä¸è®¡åœ¨å†…ï¼Œè¦åˆ é™¤æŸä¸ªå¼ºå¼•ç”¨ï¼Œä½¿ç”¨<code>del</code>è¯­å¥ï¼Œå¼•ç”¨è®¡æ•°å‡ä¸€ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡å°±ä¸ä¼šè¢«åƒåœ¾æ”¶é›†å™¨é”€æ¯ï¼Œè€Œå½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼ˆæ²¡æœ‰å¼ºå¼•ç”¨ï¼‰ï¼Œæ— è®ºè¿˜æœ‰å¤šå°‘å¼±å¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šè¢«åƒåœ¾æ”¶é›†å™¨æ”¶å›ã€‚åœ¨å¯¹è±¡æœªè¢«é”€æ¯ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡å¼±å¼•ç”¨è®¿é—®åˆ°å¯¹è±¡ï¼Œå¦åˆ™åªèƒ½å¾—åˆ°<code>None</code></p><p>weakrefè¿è¡Œåœ¨â€œè§‚å¯Ÿè€…æ¨¡å¼â€ï¼Œå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨ï¼Œæ„å‘³ç€å¯¹è¯¥å¯¹è±¡è¿›è¡Œè§‚å¯Ÿï¼Œå½“å¯¹è±¡è¢«å›æ”¶ï¼Œè§‚å¯Ÿè€…å°†ç«‹å³å¾—åˆ°ä¸€ä¸ªåé¦ˆå¹¶æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå‡è®¾å­˜åœ¨çš„è¯ã€‚å¦å¤–å¹¶éæ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥åˆ›å»ºå¼±å¼•ç”¨ï¼Œå¯ä»¥åˆ›å»ºå¼±å¼•ç”¨çš„å¯¹è±¡åŒ…æ‹¬ç±»å®ä¾‹ã€å‡½æ•°å¯¹è±¡ã€å®ä¾‹æ–¹æ³•ã€é›†åˆã€å†°å†»é›†åˆã€æ–‡ä»¶å¯¹è±¡ã€ç”Ÿæˆå™¨ã€ç±»å¯¹è±¡ã€socketsã€æ•°ç»„ã€é˜Ÿåˆ—ï¼ˆdequeï¼‰ã€æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼ˆregular expression patternï¼‰ä»¥åŠcodeå¯¹è±¡ï¼Œè€Œåˆ—è¡¨å’Œå­—å…¸æ˜¯ä¸èƒ½ç›´æ¥æ”¯æŒå¼±å¼•ç”¨çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> weakref</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>wr=weakref.ref(a)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: cannot create weak reference to <span class="string">&#x27;list&#x27;</span> <span class="built_in">object</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡å­ç±»åŒ–åˆ—è¡¨æˆ–å­—å…¸å¯ä»¥å¢åŠ è¿™æ ·çš„æ”¯æŒï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">new_list</span>(<span class="params"><span class="built_in">list</span></span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">ref</span>):</span></span><br><span class="line">    <span class="keyword">if</span> ref <span class="keyword">is</span> wr:</span><br><span class="line">        print(<span class="string">&#x27;åˆ—è¡¨å¯¹è±¡[1,2,3]è¢«å›æ”¶&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a=new_list([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">wr=weakref.ref(a,callback)</span><br><span class="line"><span class="keyword">del</span> a</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">åˆ—è¡¨å¯¹è±¡[1,2,3]è¢«å›æ”¶</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åƒå…ƒç»„å’Œæ•´å‹ï¼Œå³ä½¿å­ç±»åŒ–ä¹Ÿä¸èƒ½æ”¯æŒå¼±å¼•ç”¨ã€‚åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œé€šè¿‡<code>weakref.ref()</code>åˆ›å»ºäº†ä¸€ä¸ªå¼±å¼•ç”¨å¯¹è±¡ï¼Œå¯ä»¥åƒè°ƒç”¨å‡½æ•°é‚£æ ·è°ƒç”¨å®ƒä»¥è·å–è¢«å¼•ç”¨çš„å¯¹è±¡ï¼ˆå› ä¸ºå¼±å¼•ç”¨ç±»å®ç°äº†<code>__call__()</code>æ–¹æ³•ï¼‰ï¼Œç§°ä¹‹ä¸ºreferentï¼Œå¦‚æœreferentä¸å†å­˜æ´»ï¼Œè°ƒç”¨å°†è¿”å›<code>None</code>ï¼Œå› æ­¤å¦‚æœä½ è¦æµ‹è¯•ä¸€ä¸ªreferentæ˜¯å¦å­˜æ´»ï¼Œå¯ä»¥ä½¿ç”¨é€»è¾‘è¡¨è¾¾å¼<code>ref() is not None</code>ï¼ˆå…¶ä¸­<code>ref</code>æ˜¯ä¸€ä¸ªå¼±å¼•ç”¨å¯¹è±¡ï¼‰</p><p>ç®€å•ä»‹ç»<code>weakref</code>æ¨¡å—çš„ç±»æˆ–æ–¹æ³•ï¼š</p><ul><li><p><code>class weakref.ref(obj[, callback])</code>ï¼ˆåˆ›å»ºå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨ï¼‰<br>å‚æ•°<code>obj</code>æ˜¯è¢«å¼±å¼•ç”¨çš„åŸå§‹å¯¹è±¡ï¼ˆè¢«ç§°ä¸ºreferentï¼‰ï¼Œ<code>callback</code>æ˜¯å›è°ƒå‡½æ•°ï¼Œå½“<code>obj</code>å¼•ç”¨è®¡æ•°å‡ä¸º0è¢«å½“ä½œåƒåœ¾å›æ”¶æ¸…ç†çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼Œä¸”ä¼ å…¥è¯¥å¼±å¼•ç”¨ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªå¼±å¼•ç”¨ï¼Œå½“referentè¢«å›æ”¶çš„æ—¶å€™ï¼Œä¼šæ ¹æ®å¼±å¼•ç”¨åˆ›å»ºçš„æ—¶é—´ç”±è¿‘åŠè¿œåœ°é€ä¸ªæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå‡è®¾å®šä¹‰äº†çš„è¯</p><p>å‡è®¾referentæ˜¯å¯å“ˆå¸Œçš„ï¼Œå¼±å¼•ç”¨å¯¹è±¡ä¹Ÿæ˜¯å¯å“ˆå¸Œçš„ï¼Œå³ä½¿referentè¢«é”€æ¯ï¼Œå¼±å¼•ç”¨å¯¹è±¡ä»èƒ½ç»´æŒå…¶å“ˆå¸Œå€¼ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨referentè¢«é”€æ¯ä¹‹åæ‰ç¬¬ä¸€æ¬¡è®¡ç®—å¼±å¼•ç”¨å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå°†å¯¼è‡´<code>TypeError</code></p><p>å¼±å¼•ç”¨å¯¹è±¡æ”¯æŒç­‰å€¼æµ‹è¯•ï¼ˆ<code>==</code>ï¼‰ï¼Œä½†æ˜¯ä¸æ”¯æŒæ’åºï¼Œä¸åŒå¼±å¼•ç”¨ä¹‹é—´çš„ç­‰å€¼å…³ç³»ç­‰åŒäºå„è‡ªå¯¹åº”çš„referentä¹‹é—´çš„ç­‰å€¼å…³ç³»ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªä¸åŒå¯¹è±¡æ»¡è¶³<code>a==b</code>ï¼Œä¸”<code>wra</code>æ˜¯å¯¹<code>a</code>çš„å¼±å¼•ç”¨ï¼Œ<code>wrb</code>æ˜¯å¯¹<code>b</code>çš„å¼±å¼•ç”¨ï¼Œé‚£ä¹ˆç«‹å³æ¨ï¼Œ<code>wra==wrb</code>æ˜¯æˆç«‹çš„ï¼Œè‹¥å…¶ä¸­ä¸€æ–¹çš„referentè¢«é”€æ¯ï¼Œåˆ™ä¸å†ç›¸ç­‰ï¼‰ï¼Œç‰¹åˆ«çš„ï¼Œå¯¹åŒä¸€å¯¹è±¡æ‰€åˆ›å»ºçš„ä¸åŒå¼±å¼•ç”¨æ€»æ˜¯ç­‰å€¼çš„ï¼ˆåˆ›å»ºå¼±å¼•ç”¨æ—¶æ‰€ä¼ å…¥çš„å›è°ƒå‡½æ•°å‚æ•°ä¸å½±å“ç­‰å€¼æµ‹è¯•çš„ç»“æœï¼Œä½†ä¼šå½±å“<code>is</code>åˆ¤æ–­çš„ç»“æœï¼‰ï¼Œç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name</span>):</span></span><br><span class="line">        self.name=name</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__hash__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>(self.name)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self,another</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.name==another.name:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">a=A(<span class="string">&#x27;msy&#x27;</span>)</span><br><span class="line">b=A(<span class="string">&#x27;msy&#x27;</span>)</span><br><span class="line">wra=weakref.ref(a)</span><br><span class="line">wrb=weakref.ref(b)</span><br><span class="line">print(a==b,wra==wrb)</span><br><span class="line"></span><br><span class="line">print(<span class="built_in">hash</span>(wra))</span><br><span class="line"><span class="keyword">del</span> b</span><br><span class="line"><span class="comment">#print(hash(wrb)) #TypeError: weak object has gone away</span></span><br><span class="line">print(wra==wrb) <span class="comment">#False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">ref</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">wra2=weakref.ref(a,<span class="built_in">callable</span>)</span><br><span class="line">print(wra==wra2,wra <span class="keyword">is</span> wra2) <span class="comment">#True False</span></span><br><span class="line">wra3=weakref.ref(a)</span><br><span class="line">print(wra==wra2,wra <span class="keyword">is</span> wra3) <span class="comment">#True True</span></span><br></pre></td></tr></table></figure></li><li><p><code>weakref.proxy(obj[, callback])</code>ï¼ˆåˆ›å»ºå¯¹å¯¹è±¡çš„ä»£ç†ï¼‰<br>ä»£ç†å¯¹è±¡æ˜¯ä¸å¯å“ˆå¸Œçš„ï¼ˆæ— è®ºreferentå¯ä¸å¯å“ˆå¸Œï¼‰ï¼Œè¿™é˜»æ­¢äº†å°†å…¶ç”¨äºå­—å…¸çš„é”®ï¼Œå’Œ<code>weakref.ref()</code>ä¸€æ ·ï¼Œæ”¯æŒå›è°ƒï¼Œä»£ç†å’Œå¼±å¼•ç”¨çš„æ˜¾è‘—çš„åŒºåˆ«æ˜¯ï¼Œ1ï¼‰è¦ä»å¼±å¼•ç”¨è·å–referentï¼Œä½ éœ€è¦ä½¿ç”¨<code>()</code>è°ƒç”¨è¿™ä¸ªå¼±å¼•ç”¨å¯¹è±¡ï¼Œä½†æ˜¯ä»£ç†ä¸éœ€è¦ï¼Œä½¿ç”¨ä»£ç†å¯¹è±¡å°±å¦‚åŒä½¿ç”¨å¯¹è±¡æœ¬èº«ä¸€æ ·ï¼Œ2ï¼‰å½“referenté”€æ¯åï¼Œå¼±å¼•ç”¨è°ƒç”¨ä¼šè¿”å›<code>None</code>ï¼Œè€Œè®¿é—®ä»£ç†åˆ™å¯¼è‡´<code>ReferenceError</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"></span><br><span class="line">a=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br><span class="line">wr=weakref.ref(a)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">ref</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;åˆ é™¤å¯¹è±¡&#x27;</span>)</span><br><span class="line"></span><br><span class="line">proxy=weakref.proxy(a,callback)</span><br><span class="line"></span><br><span class="line">print(wr()) <span class="comment">#&#123;1, 2, 3&#125;</span></span><br><span class="line">print(<span class="built_in">repr</span>(proxy))</span><br><span class="line">print(proxy) <span class="comment">#&#123;1, 2, 3&#125;</span></span><br><span class="line"></span><br><span class="line">proxy.add(<span class="number">4</span>)</span><br><span class="line">print(proxy) <span class="comment">#&#123;1, 2, 3, 4&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> a <span class="comment">#å¯¹è±¡açš„å¼•ç”¨è®¡æ•°é™ä¸º0åï¼Œè‡ªåŠ¨è°ƒç”¨ä»£ç†çš„å›è°ƒå‡½æ•°ï¼Œè¾“å‡ºï¼šåˆ é™¤å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">print(wr()) <span class="comment">#None</span></span><br><span class="line">print(proxy) <span class="comment">#ReferenceError: weakly-referenced object no longer exists</span></span><br></pre></td></tr></table></figure></li><li><p><code>weakref.getweakrefcount(obj)</code>ï¼ˆè¿”å›å¯¹è±¡<code>obj</code>çš„å…¨éƒ¨å¼±å¼•ç”¨ä»¥åŠä»£ç†æ•°é‡ï¼‰</p></li><li><p><code>weakref.getweakrefs(obj)</code>ï¼ˆè¿”å›å¯¹è±¡<code>obj</code>çš„å…¨éƒ¨å¼±å¼•ç”¨å’Œä»£ç†å¯¹è±¡ï¼Œä»¥åˆ—è¡¨è¿”å›ï¼‰</p></li><li><p><code>class weakref.WeakMethod(method)</code>ï¼ˆåˆ›å»ºå¯¹ç»‘å®šæ–¹æ³•çš„å¼±å¼•ç”¨ï¼‰<br>å‡è®¾ä½ æœ‰ä¸€ä¸ªç±»å®ä¾‹<code>a</code>ï¼Œ<code>f</code>æ˜¯å®ä¾‹æ–¹æ³•ï¼Œè¦å¯¹<code>a.f</code>åˆ›å»ºå¼±å¼•ç”¨ï¼Œä½¿ç”¨<code>WeakMethod(a.f)</code>å³å¯ï¼Œè€Œæ ‡å‡†å¼±å¼•ç”¨å¯¹è±¡æ„é€ åŠæ³•ï¼ˆ<code>ref(a.f)()</code>å°†è¿”å›<code>None</code>ï¼‰æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸º<code>a.f</code>è¿”å›çš„æ˜¯ä¸€ä¸ªå…¨æ–°çš„â€œç»‘å®šäº†å®ä¾‹çš„æ–¹æ³•â€ï¼Œå…¶å¼•ç”¨è®¡æ•°ä¸º0ï¼Œå¦‚æœä¸€å®šè¦ä½¿ç”¨æ ‡å‡†å¼±å¼•ç”¨å¯¹è±¡æ„é€ åŠæ³•ï¼Œåªè¦å°†<code>a.f</code>èµ‹ç»™ä¸€ä¸ªå˜é‡å³å¯ï¼ˆä½¿å¼•ç”¨è®¡æ•°é0ï¼‰ï¼Œå› ä¸º<code>WeakMethod</code>æ˜¯<code>ref</code>çš„å­ç±»ï¼Œå› æ­¤è¦è·å–è¢«å¼±å¼•ç”¨çš„åŸå§‹ç»‘å®šæ–¹æ³•å¯¹è±¡ï¼Œä¹Ÿæ˜¯é€šè¿‡<code>()</code>è¿›è¡Œè°ƒç”¨æ¥è·å–ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;å®ä¾‹æ–¹æ³•&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cf</span>(<span class="params">cls</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;ç±»æ–¹æ³•&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sf</span>():</span></span><br><span class="line">        print(<span class="string">&#x27;é™æ€æ–¹æ³•&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a=A()</span><br><span class="line">m1=weakref.WeakMethod(a.f) <span class="comment">#æ›¿æ¢æˆWeakMethod(a.cf)ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯æ›¿æ¢æˆWeakMethod(a.sf)ä¸è¡Œï¼Œå› ä¸ºa.sfè¿”å›çš„æ˜¯éç»‘å®šæ–¹æ³•</span></span><br><span class="line">m1()()</span><br><span class="line"></span><br><span class="line">print(weakref.ref(a.f)()) <span class="comment">#None</span></span><br><span class="line">t=a.f <span class="comment">#æ›¿æ¢æˆa.sfæˆ–a.cféƒ½å¯ä»¥</span></span><br><span class="line">m2=weakref.ref(t)</span><br><span class="line">m2()()</span><br></pre></td></tr></table></figure></li><li><p><code>class weakref.finalize(obj, func, *args, **kwargs)</code><br>åˆ›å»ºä¸€ä¸ªå¯é€šè¿‡<code>()</code>è°ƒç”¨çš„finalizerå¯¹è±¡ï¼ˆ<code>finalize</code>ç±»çš„<code>__call__()</code>æ–¹æ³•ä½“å³æ˜¯æ‰§è¡Œ<code>func(*args,**kwargs)</code>ï¼‰ï¼Œå½“referentå¯¹è±¡<code>obj</code>çš„å¼•ç”¨è®¡æ•°é™ä¸º0æ—¶å°†è‡ªåŠ¨è§¦å‘è°ƒç”¨ï¼Œå¦å¤–åœ¨ç¨‹åºç»“æŸæ—¶ä¹Ÿæ€»ä¼šè°ƒç”¨è¿™äº›finalizerå¯¹è±¡ï¼ˆè°ƒç”¨é¡ºåºå’Œè¿™äº›å¯¹è±¡çš„åˆ›å»ºé¡ºåºç›¸åï¼Œå¯¹æ¯”<code>ref(obj,callback)</code>ï¼Œç¨‹åºç»“æŸæ—¶åˆ™ä¸ä¼šè°ƒç”¨<code>callback()</code>ï¼Œé™¤éåœ¨ç¨‹åºä¸­æ‰‹åŠ¨æ‰§è¡Œ<code>del</code>è¯­å¥é™ä½å¼•ç”¨è®¡æ•°ä¸º0ï¼‰ï¼Œé™¤éå…¶<code>atexit</code>å±æ€§è¢«è®¾ç½®ä¸º<code>False</code>ï¼Œfinalizerä¸€æ—¦è¢«è°ƒç”¨ä¸€æ¬¡å°†â€œæ­»äº¡â€ï¼Œè‹¥è°ƒç”¨ä¸€ä¸ªæ­»äº¡äº†çš„finalizerï¼Œå°†è¿”å›<code>None</code>ï¼ˆå¦è¯·æ³¨æ„<code>func</code>ã€<code>args</code>å’Œ<code>kwargs</code>ä¸èƒ½ç›´æ¥æˆ–é—´æ¥å¯¹<code>obj</code>å­˜åœ¨ä»»ä½•å¼•ç”¨ï¼Œå¦åˆ™ä¼šå¯¼è‡´<code>obj</code>ä¸èƒ½è¢«å›æ”¶ï¼Œç‰¹åˆ«çš„ï¼Œ<code>func</code>ä¸èƒ½æ˜¯<code>obj</code>çš„å®ä¾‹ç»‘å®šæ–¹æ³•ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;å›æ”¶&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">888</span></span><br><span class="line"></span><br><span class="line">a=A()</span><br><span class="line">t=weakref.finalize(a,callback)</span><br><span class="line">print(t())</span><br><span class="line">print(t()) <span class="comment">#1ã€å¦‚æœæ›¿æ¢è¿™ä¸¤è¡Œä¸ºdel aï¼Œè¾“å‡ºç»“æœä¸€è‡´ï¼Œ2ã€å¦‚æœæ³¨é‡Šæ‰è¿™ä¸¤è¡Œï¼Œå°†å…ˆåè¾“å‡º&quot;OVER&quot;å’Œ&quot;å›æ”¶&quot;</span></span><br><span class="line">print(<span class="string">&#x27;OVER&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">å›æ”¶</span></span><br><span class="line"><span class="string">888</span></span><br><span class="line"><span class="string">None</span></span><br><span class="line"><span class="string">OVER</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>finalizerå¯¹è±¡çš„å±æ€§ã€æ–¹æ³•ï¼š</p><ul><li><code>__call__()</code><br>å½“finalizerå¯¹è±¡å­˜æ´»æ—¶è°ƒç”¨<code>__call__()</code>å°†è¿”å›<code>func(*args,**kwargs)</code>çš„ç»“æœï¼Œå¹¶åœ¨æ­¤ä¹‹åå®£åˆ¤å…¶æ­»äº¡ï¼Œå½“finalizerå¯¹è±¡æ­»äº¡æ—¶è°ƒç”¨<code>__call__()</code>å°†è¿”å›<code>None</code></li><li><code>detach()</code><br>å½“finalizerå¯¹è±¡å­˜æ´»æ—¶è°ƒç”¨<code>detach()</code>å°†è¿”å›<code>(obj, func, args, kwargs)</code>å…ƒç»„ï¼Œå¹¶åœ¨æ­¤ä¹‹åå®£åˆ¤å…¶æ­»äº¡ï¼Œå½“finalizerå¯¹è±¡æ­»äº¡æ—¶è°ƒç”¨<code>detach()</code>å°†è¿”å›<code>None</code></li><li><code>peek()</code><br>åŒ<code>detach()</code>ï¼Œä½†æ˜¯è°ƒç”¨åä¸ä¼šå¯¼è‡´finalizerå¯¹è±¡æ­»äº¡</li><li><code>alive</code><br>åˆ¤æ–­finalizerå¯¹è±¡æ˜¯å¦å­˜æ´»</li><li><code>atexit</code><br>ä¸€ä¸ªå¯å†™çš„å¸ƒå°”å±æ€§ï¼Œé»˜è®¤å€¼ä¸º<code>True</code>ï¼Œä¸”åªæœ‰<code>atexit</code>å±æ€§ä¸º<code>True</code>çš„finalizerå¯¹è±¡æ‰ä¼šè¢«è§¦å‘è°ƒç”¨</li></ul></li><li><p><code>weakref.ReferenceType</code>ï¼ˆè¿”å›å¼±å¼•ç”¨å¯¹è±¡çš„ç±»å‹<code>&lt;class 'weakref'&gt;</code>ï¼‰</p></li><li><p><code>weakref.ProxyType</code>ï¼ˆè¿”å›ä¸å¯è°ƒç”¨å¯¹è±¡çš„å¼±ä»£ç†çš„ç±»å‹<code>&lt;class 'weakproxy'&gt;</code>ï¼‰</p></li><li><p><code>weakref.CallableProxyType</code>ï¼ˆè¿”å›å¯è°ƒç”¨å¯¹è±¡çš„å¼±ä»£ç†çš„ç±»å‹<code>&lt;class 'weakcallableproxy'&gt;</code>ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">set</span>() <span class="comment">#ä¸å¯è°ƒç”¨å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">t1=weakref.proxy(s)</span><br><span class="line">print(<span class="built_in">type</span>(t1))</span><br><span class="line">print(<span class="built_in">isinstance</span>(t1,weakref.ProxyType))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span> <span class="comment">#å¯è°ƒç”¨å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">t2=weakref.proxy(f)</span><br><span class="line">print(<span class="built_in">type</span>(t2))</span><br><span class="line">print(<span class="built_in">isinstance</span>(t2,weakref.CallableProxyType))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">&lt;class &#x27;weakproxy&#x27;&gt;</span></span><br><span class="line"><span class="string">True</span></span><br><span class="line"><span class="string">&lt;class &#x27;weakcallableproxy&#x27;&gt;</span></span><br><span class="line"><span class="string">True</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p><code>weakref.ProxyTypes</code>ï¼ˆè¿”å›å…¨éƒ¨ä»£ç†ç±»å‹ï¼Œå³<code>(&lt;class 'weakproxy'&gt;, &lt;class 'weakcallableproxy'&gt;)</code>ï¼‰</p></li></ul><p>å¼±å¼•ç”¨çš„ä¸»è¦ç”¨é€”æ˜¯å®ç°æŒæœ‰å¤§é‡â€œå¤§â€å¯¹è±¡ï¼ˆæŒ‡å ç”¨å†…å­˜å¤§ï¼‰çš„é«˜é€Ÿç¼“å­˜æˆ–æ˜ å°„ï¼Œä»¥å¾€ç”±äºå¯¹è±¡ä½œä¸ºé«˜é€Ÿç¼“å­˜æˆ–æ˜ å°„çš„æ¡ç›®è¢«å¼•ç”¨ï¼Œå¯¼è‡´ç”¨æˆ·ä½¿ç”¨å®Œåæ— æ³•ä½¿ç”¨<code>del</code>å°†è¿™äº›å¯¹è±¡çš„å¼•ç”¨è®¡æ•°é™ä¸º0ï¼ˆåªè¦é«˜é€Ÿç¼“å­˜æˆ–æ˜ å°„è¿˜å­˜åœ¨ï¼‰ï¼Œä»è€Œæµªè´¹å¤§é‡ç©ºé—´ï¼Œä¸ºæ­¤<code>weakref</code>æ¨¡å—æä¾›äº†<code>WeakKeyDictionary</code>å’Œ<code>WeakValueDictionary</code>ç”¨æ¥è§£å†³è¯¥é—®é¢˜</p><ul><li><code>class weakref.WeakKeyDictionary([dict])</code><br>è¯¥å­—å…¸ä¸­çš„é”®æ˜¯å¼±å¼•ç”¨çš„ï¼Œå½“å¤–éƒ¨ä¸å­˜åœ¨å¯¹æŸé”®çš„å¼ºå¼•ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ é™¤å­—å…¸ä¸­æ­¤é”®å¯¹åº”çš„æ¡ç›®ï¼Œå¦å¤–<code>WeakKeyDictionary</code>å¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªé¢å¤–çš„æ–¹æ³•<code>keyrefs()</code>ï¼Œå…¶è¿”å›å…¨éƒ¨å¼±å¼•ç”¨çš„é”®çš„åˆ—è¡¨<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">d=weakref.WeakKeyDictionary()</span><br><span class="line">d[A()]=<span class="number">1</span></span><br><span class="line">print(<span class="built_in">list</span>(d.keys())) <span class="comment">#[] #å¼±å­—å…¸ä¸­ç©ºæ— ä¸€ç‰©ï¼ŒåŸå› åœ¨äº&quot;d[A()]=1&quot;ä¸­çš„é”®&quot;A()&quot;çš„å¼•ç”¨è®¡æ•°ä¸º0ï¼Œå®ƒéšå³è¢«åˆ é™¤</span></span><br><span class="line"></span><br><span class="line">a=A()</span><br><span class="line">d[a]=<span class="number">1</span> <span class="comment">#é”®&quot;a&quot;å­˜åœ¨å¤–éƒ¨å¼•ç”¨ï¼ša=A()ï¼Œå…¶å¼•ç”¨è®¡æ•°ä¸º1</span></span><br><span class="line">print(<span class="built_in">list</span>(d.keys())) <span class="comment">#[&lt;__main__.A object at 0x000001FA6AB16EB8&gt;]</span></span><br><span class="line">print(d[a]) <span class="comment">#1</span></span><br><span class="line"><span class="keyword">del</span> a <span class="comment">#delä½¿&quot;a&quot;çš„å¼•ç”¨è®¡æ•°å‡1ï¼Œå˜ä¸º0</span></span><br><span class="line">print(<span class="built_in">list</span>(d.keys())) <span class="comment">#[]</span></span><br><span class="line"><span class="comment">#print(d[a]) #NameError: name &#x27;a&#x27; is not defined</span></span><br></pre></td></tr></table></figure></li><li><code>class weakref.WeakValueDictionary([dict])</code><br>è¯¥å­—å…¸ä¸­é”®çš„å€¼æ˜¯å¼±å¼•ç”¨çš„ï¼Œå½“å¤–éƒ¨ä¸å­˜åœ¨å¯¹æŸé”®å€¼çš„å¼ºå¼•ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ é™¤æ­¤å­—å…¸ä¸­è¯¥é”®å€¼å¯¹åº”çš„æ¡ç›®ï¼Œå¦å¤–<code>WeakValueDictionary</code>å¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªé¢å¤–çš„æ–¹æ³•<code>valuerefs()</code>ï¼Œå…¶è¿”å›å…¨éƒ¨å¼±å¼•ç”¨çš„å€¼çš„åˆ—è¡¨</li></ul><p>é™¤äº†â€œå¼±å­—å…¸â€ï¼Œæ¨¡å—è¿˜æä¾›äº†â€œå¼±é›†åˆâ€<code>class weakref.WeakSet([elements])</code>ï¼Œå½“å¼±é›†åˆä¸­çš„æŸä¸ªå…ƒç´ çš„å¼•ç”¨è®¡æ•°é™ä½ä¸º0æ—¶ï¼Œå°†è‡ªåŠ¨ä»å¼±é›†åˆä¸­åˆ é™¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">s=weakref.WeakSet()</span><br><span class="line">a=A()</span><br><span class="line">b=A()</span><br><span class="line">s.add(a)</span><br><span class="line">s.add(b)</span><br><span class="line">print(<span class="built_in">list</span>(s))</span><br><span class="line"><span class="keyword">del</span> a</span><br><span class="line">print(<span class="built_in">list</span>(s))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">[&lt;__main__.A object at 0x0000019127A1D588&gt;, &lt;__main__.A object at 0x0000019127A1D160&gt;]</span></span><br><span class="line"><span class="string">[&lt;__main__.A object at 0x0000019127A1D588&gt;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="sxfwkz-3"><p>Pythonä¸­æ— æ³•ä¸ºç±»å£°æ˜ç§æœ‰ç±»å‹çš„å±æ€§ï¼Œå£°æ˜ç§æœ‰ç±»å‹çš„ç›®çš„æ˜¯é˜»æ­¢å­ç±»ç»§æ‰¿è¯¥å±æ€§ï¼Œå¹¶ä¸”åªèƒ½åœ¨ç±»å®šä¹‰ä¸­è®¿é—®ç§æœ‰å±æ€§ï¼Œåœ¨ç±»å¤–ä»»ä½•åœ°æ–¹éƒ½æ— æ³•ç›´æ¥é€šè¿‡å±æ€§åè®¿é—®å®ƒã€‚ä¸€ç§å˜é€šæ˜¯pythonå†…éƒ¨ä¼šå¯¹ç±»å®šä¹‰ä¸­æ‰€æœ‰ä»¥<code>__</code>åŒä¸‹åˆ’çº¿å¼€å¤´ä¸”ä¸è¶…è¿‡ä¸€ä¸ªä¸‹åˆ’çº¿ç»“å°¾ï¼ˆè¿™æ ·å‘½åçš„å±æ€§å°±è¢«è®¤ä¸ºæ˜¯â€œç§æœ‰å±æ€§â€ï¼‰çš„å±æ€§è¿›è¡Œåå­—è½¬æ¢ï¼Œå…·ä½“çš„ï¼Œåœ¨åŸå§‹å±æ€§åå‰åŠ ä¸Šâ€œ<code>_ç±»å</code>â€ï¼Œè­¬å¦‚ï¼šç±»<code>Foo</code>çš„â€œç§æœ‰å±æ€§â€<code>__spam</code>è¢«æ›¿æ¢ä¸º<code>_Foo__spam</code>ï¼Œä½¿å¾—å­ç±»æ— æ³•é€šè¿‡åŸå§‹å±æ€§åè®¿é—®å®ƒï¼ŒpythonæŠŠè¿™ç§æŠ€æœ¯å«åšâ€œname manglingâ€ï¼ˆå±æ€§åè½§å‹æœºåˆ¶ï¼‰ï¼Œç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__private()</span><br><span class="line">        self.public()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__private</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;A.__private()&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;A.public()&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params">A</span>):</span></span><br><span class="line">    <span class="comment"># def __init__(self): #æ­¤å¤„å†™ä¸å†™éƒ½ä¸€æ ·ï¼Œå› ä¸ºæ²¡æœ‰å®ç°__init__æ–¹æ³•æ—¶ï¼Œæœ¬å°±ä¼šè‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„__init__æ–¹æ³•</span></span><br><span class="line">    <span class="comment">#     super(B,self).__init__() #æˆ–è€…A.__init__(self)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__private</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;B.__private()&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;B.public()&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">a=A()</span><br><span class="line">b=B()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">A.__private()</span></span><br><span class="line"><span class="string">A.public()</span></span><br><span class="line"><span class="string">A.__private()</span></span><br><span class="line"><span class="string">B.public()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºå€’æ•°ç¬¬äºŒè¡Œä¸ºä»€ä¹ˆæ˜¯<code>A.__private()</code>è€Œä¸æ˜¯<code>B.__private()</code>ï¼ˆä¸Šè¿°ç¤ºä¾‹æ—¢å±•ç¤ºäº†pythonä¸­â€œç§æœ‰å±æ€§â€çš„å·¥ä½œæ–¹å¼ï¼Œä¹Ÿå±•ç¤ºå…¶æ„šè ¢ï¼Œä¸ºäº†çº æ­£ï¼Œåº”è¿™æ ·å®ç°<code>B</code>çš„åˆå§‹åŒ–å‡½æ•°ï¼š<code>self.__private();self.public()</code>ï¼Œè€Œä¸æ˜¯å·æ‡’ç›´æ¥è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–å‡½æ•°ï¼‰ï¼Œä¸æ€¥ï¼Œå…ˆæ¥çœ‹çœ‹å±æ€§åè½§å‹æœºåˆ¶æ˜¯å¦çœŸçš„å·¥ä½œäº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.__private()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">AttributeError                            Traceback (most recent call last)</span><br><span class="line">&lt;ipython-<span class="built_in">input</span>-<span class="number">2</span>-cc12b64d1d3b&gt; <span class="keyword">in</span> &lt;module&gt;()</span><br><span class="line">----&gt; 1 a.__private()</span><br><span class="line"></span><br><span class="line">AttributeError: <span class="string">&#x27;A&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;__private&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a._A__private()</span><br><span class="line">A.__private()</span><br></pre></td></tr></table></figure><p>å¯¹è±¡<code>a</code>ç¡®å®è®¿é—®ä¸åˆ°åŸå§‹çš„å±æ€§æ–¹æ³•<code>__private</code>äº†ï¼Œåå­—å·²ç»è½¬å˜ä¸º<code>_A__private</code>ï¼Œå®é™…ä¸Šè§£é‡Šå™¨åœ¨é‡åˆ°ç±»å®šä¹‰è¯­å¥æ—¶ï¼Œä¼šé¦–å…ˆä¿®æ”¹è¿™äº›â€œç§æœ‰â€å±æ€§çš„åå­—ï¼Œå³åœ¨å†…å­˜ä¸­çš„ç±»å®šä¹‰å¦‚ä¸‹ï¼ˆåœ¨ç±»å®šä¹‰å¤–åŠ¨æ€ç»‘å®šçš„åŒä¸‹åˆ’çº¿å±æ€§åä¸ä¼šè¢«è½§å‹ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._A__private() <span class="comment">#ä¿®æ”¹1</span></span><br><span class="line">        self.public()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_A__private</span>(<span class="params">self</span>):</span> <span class="comment">#ä¿®æ”¹2</span></span><br><span class="line">        print(<span class="string">&#x27;A.__private()&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;A.public()&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params">A</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_B__private</span>(<span class="params">self</span>):</span> <span class="comment">#ä¿®æ”¹3</span></span><br><span class="line">        print(<span class="string">&#x27;B.__private()&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;B.public()&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥å›ç­”ä¸Šè¿°é—®é¢˜äº†ï¼Œå½“å®ä¾‹åŒ–<code>B</code>ç±»æ—¶ï¼Œä¼šè°ƒç”¨çˆ¶ç±»<code>A</code>ç±»çš„åˆå§‹åŒ–å‡½æ•°ï¼Œå¹¶ä¼ å…¥<code>B</code>ç±»å®ä¾‹ï¼Œè®°ä½œ<code>b</code>ï¼Œäºæ˜¯åœ¨<code>__init__()</code>ä¸­å°†å…ˆåæ‰§è¡Œ<code>b._A__private()</code>å’Œ<code>b.public()</code>ï¼ŒçœŸç›¸å¤§ç™½</p><p>å¦å¤–ç»å¸¸é‡åˆ°ä»¥<code>_</code>å•ä¸‹åˆ’çº¿å¼€å¤´çš„å˜é‡åï¼ˆå®é™…ä¸Šæ˜¯ä»¥ä»»ä½•æ•°é‡ä¸‹åˆ’çº¿å¼€å¤´çš„å˜é‡ï¼Œä»…ä¹ æƒ¯ä¸Šä»¥å•ä¸‹åˆ’çº¿æ‰“å¤´ï¼‰ï¼Œå¦‚æœä½äºæ¨¡å—çº§åˆ«ï¼Œåœ¨<code>from module import *</code>æ—¶æ˜¯æ— æ³•å¯¼å…¥çš„ï¼ˆå¯ä»¥é¢„é˜²é”™è¯¯ï¼Œå› ä¸ºè¿™ç§æ–¹å¼å¯¼å…¥çš„å˜é‡å¾ˆå®¹æ˜“å¯¼è‡´â€œè¦†ç›–â€ï¼Œå³â€œå‘½åç©ºé—´æ±¡æŸ“â€ï¼‰ï¼Œå¦‚æœè¦è®¾ç½®<code>from module import *</code>æ‰€å…è®¸å¯¼å…¥çš„å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨<code>__all__</code>æŒ‡å®š</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="sxfwkz-4"><p><code>__new__()</code>æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œé€šç”¨çš„å®šä¹‰ä¸º<code>__new__(cls,*args,**kwargs)</code>ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°<code>cls</code>è¡¨ç¤ºè¦å®ä¾‹åŒ–çš„ç±»ï¼Œä½ æ€»æ˜¯éœ€è¦æ‰‹åŠ¨ä¼ é€’å®ƒï¼‰ï¼Œå…¶ä¸­<code>*args</code>å’Œ<code>**kwargs</code>æ¥æ”¶çš„å‚æ•°ä¸ä¼ é€’ç»™<code>__init__()</code>çš„å‚æ•°ç›¸åŒï¼Œæ³¨æ„<code>__new__()</code>æ˜¯å”¯ä¸€å¯ä»¥ç¼–å†™åœ¨åˆ›å»ºå®ä¾‹ä¹‹å‰æ‰§è¡Œçš„ä»£ç çš„åœ°æ–¹ï¼Œå…¶å¿…é¡»æœ‰è¿”å›å€¼ï¼Œè¿”å›çš„æ˜¯åˆ›å»ºçš„å®ä¾‹å¯¹è±¡ï¼Œä¸€èˆ¬è°ƒç”¨çˆ¶ç±»æˆ–<code>object</code>ç±»çš„<code>__new__()</code>æ–¹æ³•æ¥åˆ›å»ºï¼Œå¦‚æœè¿”å›å€¼ä¸æ˜¯å½“å‰ç±»çš„å®ä¾‹é‚£ä¹ˆ<code>__init__()</code>å‡½æ•°å°†ä¸ä¼šè¢«è°ƒç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls,*args,**kwargs</span>):</span> <span class="comment">#__new__å’Œ__init__æ–¹æ³•çš„å‚æ•°é™¤ç¬¬ä¸€ä¸ªå‚æ•°(clsæˆ–self)å¤–å¿…é¡»å®Œå…¨ä¸€è‡´</span></span><br><span class="line">        ret=<span class="built_in">super</span>(A,cls).__new__(cls)</span><br><span class="line">        print(<span class="string">f&#x27;Return of __new__(): <span class="subst">&#123;ret&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,*args,**kwargs</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;Init A <span class="subst">&#123;self&#125;</span> with <span class="subst">&#123;args&#125;</span> and <span class="subst">&#123;kwargs&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="keyword">return</span> A.__new__(A) <span class="comment">#äº‹å®ä¸Š__new__æ–¹æ³•å¯ä»¥ç”Ÿäº§éå½“å‰ç±»çš„å…¶ä»–ä»»æ„ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¿™è¡¨ç¤º__new__æ–¹æ³•æ‹¥æœ‰å†³å®šå®ä¾‹å¯¹è±¡æ‰€å±ç±»å‹çš„ç»å¯¹æƒåŠ›ï¼Œä½†æ­¤æ—¶__init__æ–¹æ³•åˆ™ä¸å†è¢«è‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Init B&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a=A(<span class="string">&#x27;Hello,&#x27;</span>,<span class="string">&#x27;muggledy&#x27;</span>)</span><br><span class="line">b=B()</span><br><span class="line">print(<span class="string">&#x27;-&#x27;</span>*<span class="number">10</span>)</span><br><span class="line">b.__init__()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">Return of __new__(): &lt;__main__.A object at 0x0000013B40CFB4A8&gt;</span></span><br><span class="line"><span class="string">Init A &lt;__main__.A object at 0x0000013B40CFB4A8&gt; with (&#x27;Hello,&#x27;, &#x27;muggledy&#x27;) and &#123;&#125;</span></span><br><span class="line"><span class="string">Return of __new__(): &lt;__main__.A object at 0x0000013B40CFB518&gt;</span></span><br><span class="line"><span class="string">----------</span></span><br><span class="line"><span class="string">Init A &lt;__main__.A object at 0x0000013B40CFB518&gt; with () and &#123;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>__new__</code>æ–¹æ³•å¯ç”¨äºå½“ä½ ç»§æ‰¿ä¸€äº›ä¸å¯å˜çš„ç±»å‹æ—¶ï¼ˆå¦‚<code>int</code>ã€<code>str</code>ã€<code>tuple</code>ï¼‰ï¼Œæä¾›ç»™ä½ ä¸€ä¸ªè‡ªå®šä¹‰è¿™äº›ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹çš„é€”å¾„ï¼Œè­¬å¦‚ä½ è¦ç»§æ‰¿<code>int</code>ç±»å‹å®ç°ä¸€ä¸ªæ°¸è¿œä¸ºæ­£æ•°çš„æ•´å‹ï¼Œç”±äºæ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œæ˜¾ç„¶ä½ æ— æ³•åœ¨å®ä¾‹åˆ›å»ºä¹‹åï¼ˆå¦‚<code>__init__()</code>ä¸­ï¼‰è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PositiveInteger</span>(<span class="params"><span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls,value</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>(PositiveInteger,cls).__new__(cls,<span class="built_in">abs</span>(value))</span><br><span class="line"></span><br><span class="line">i=PositiveInteger(-<span class="number">3</span>)</span><br><span class="line">print(i) <span class="comment">#3</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç”¨æ¥å®ç°â€œå•ä¾‹â€ï¼Œå…·ä½“åé¢å†è¯´</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="sxfwkz-5"><p>æ‰€è°“å…ƒç±»ï¼Œå°±æ˜¯åˆ›å»ºç±»å¯¹è±¡æœ¬èº«çš„ç±»ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºç±»å®ä¾‹çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡ç±»ååŠ æ‹¬å·ï¼ˆæ‹¬å·ä¸­æ˜¯åˆå§‹åŒ–å‚æ•°ï¼‰çš„æ–¹å¼ï¼ŒåˆçŸ¥é“â€œç±»çš„ç±»â€æ˜¯<code>type</code>ç±»å‹ï¼Œå¯æƒ³è€ŒçŸ¥ç±»å¯¹è±¡æ˜¯é€šè¿‡<code>type(...)</code>å½¢å¼åˆ›å»ºçš„ï¼Œç°ç»™å®šä¸€ä¸ªç±»å®šä¹‰ï¼Œè§£é‡Šå™¨ç©¶ç«Ÿåšäº†ä»€ä¹ˆå‘¢ï¼Ÿè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>è§£é‡Šå™¨æ‰«æå®Œè¿™ä¸€æ®µå†…å®¹åï¼Œå¯ä»¥å¾—åˆ°ç±»å<code>class_name</code>ã€ç»§æ‰¿çš„åŸºç±»<code>bases</code>ä»¥åŠç±»ä¸»ä½“<code>class_body</code>ä¸‰ä¸ªå†…å®¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class_name=<span class="string">&#x27;Foo&#x27;</span></span><br><span class="line">bases=(<span class="built_in">object</span>,)</span><br><span class="line">class_body= \</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;\</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">def func(self):</span></span><br><span class="line"><span class="string">    pass</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨å±€éƒ¨ç©ºé—´<code>class_dict={}</code>ä¸­æ‰§è¡Œç±»ä¸»ä½“ï¼š<code>exec(class_body,globals(),class_dict)</code>ï¼Œæœ€åä½¿ç”¨é»˜è®¤å…ƒç±»ä¹Ÿå°±æ˜¯<code>type</code>ç±»åˆ›å»ºç±»å¯¹è±¡ï¼š<code>Foo=type(class_name,bases,class_dict)</code></p><p>é™¤äº†ä½¿ç”¨é»˜è®¤çš„<code>type</code>ç±»åˆ›å»ºç±»å¯¹è±¡ï¼Œè¿˜å¯ä»¥ç»§æ‰¿<code>type</code>ç±»ï¼Œä¹Ÿå°±æ˜¯è‡ªå®šä¹‰å…ƒç±»ï¼Œé€šè¿‡é‡è½½<code>__new__()</code>æˆ–<code>__init__()</code>æ¥è¿›ä¸€æ­¥æ§åˆ¶ç”¨æˆ·è‡ªå®šä¹‰ç±»çš„å®šä¹‰å†…å®¹ï¼ˆå¦‚æœæ˜¯ä¿®æ”¹ç±»å®šä¹‰çš„è¯ï¼Œåº”è¯¥åœ¨<code>__new__()</code>ä¸­ç±»å¯¹è±¡åˆ›å»ºä¹‹å‰ä¿®æ”¹ï¼Œå¦‚æœæ˜¯ä¸€äº›æ£€æŸ¥é€»è¾‘å¦‚ç±»å±æ€§å€¼æ˜¯å¦åˆæ³•ç­‰ï¼Œåˆ™åœ¨ç±»å¯¹è±¡åˆ›å»ºåå†æ£€æŸ¥ä¹Ÿä¸è¿Ÿï¼Œå³æ”¾åœ¨<code>__init__()</code>ä¸­ï¼‰ï¼Œçœ‹ä¸ªç¤ºä¾‹ï¼Œå·²çŸ¥æœ‰ä¸€ä¸ª<code>factory</code>ç±»ï¼Œç°è¦æ±‚å…¶åªèƒ½æœ‰ä¸‰ä¸ªå±æ€§ï¼Œåç§°<code>name</code>ã€åœ°å€<code>location</code>ä»¥åŠä¸šåŠ¡<code>business</code>ï¼Œå…¶å®å°±æ˜¯æ·»åŠ ä¸€ä¸ªç±»å±æ€§<code>__slots__</code>ï¼ˆæ³¨æ„ç±»å¯¹è±¡åˆ›å»ºåï¼Œå†æ·»åŠ ç±»å±æ€§<code>__slots__</code>æ˜¯æ²¡æ•ˆæœçš„ï¼Œå¿…é¡»å†™åœ¨ç±»å®šä¹‰ä¸­ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMetaCls</span>(<span class="params"><span class="built_in">type</span></span>):</span> <span class="comment">#è‡ªå®šä¹‰å…ƒç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls,class_name,bases,class_dict</span>):</span></span><br><span class="line">        class_dict[<span class="string">&#x27;__slots__&#x27;</span>]=[<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;location&#x27;</span>,<span class="string">&#x27;business&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>.__new__(cls,class_name,bases,class_dict)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">factory</span>(<span class="params">metaclass=MyMetaCls</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name,location,business</span>):</span></span><br><span class="line">        self.name,self.location,self.business=name,location,business</span><br><span class="line">    </span><br><span class="line">f=factory(name=<span class="string">&#x27;ä¸­çŸ³åŒ–&#x27;</span>,location=<span class="string">&#x27;è¥¿åŒ—&#x27;</span>,business=<span class="string">&#x27;ä¸­å›½èƒ½æºä¾›ç»™&#x27;</span>)</span><br><span class="line">f.xxx=<span class="string">&#x27;xxx&#x27;</span> <span class="comment">#AttributeError: &#x27;factory&#x27; object has no attribute &#x27;xxx&#x27;</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šï¼Œè¦è®¾ç½®å…ƒç±»ï¼Œåªéœ€è¦åœ¨åŸºç±»å…ƒç»„ä¸­æä¾›<code>metaclass</code>å…³é”®å­—å‚æ•°ï¼Œæˆ–è€…åœ¨ç±»å®šä¹‰ä¸­æŒ‡å®š<code>__metaclass__</code>å±æ€§ã€‚å°½ç®¡ä½¿ç”¨å…ƒç±»å¯ä»¥æ˜¾è‘—æ”¹å˜ç”¨æˆ·å®šä¹‰çš„ç±»çš„è¡Œä¸ºå’Œè¯­ä¹‰ï¼Œä½†åœ¨ä½¿ç”¨å…ƒç±»æ—¶ï¼Œä¸åº”ä½¿ç±»çš„å·¥ä½œæ–¹å¼å’Œå…¶æ–‡æ¡£æè¿°ç›¸è·ç”šè¿œï¼Œè¿™ä¼šä½¿å¾—ç”¨æˆ·å¯¹ä»£ç æ„Ÿåˆ°å›°æƒ‘</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="å±æ€§è®¿é—®æ§åˆ¶">å±æ€§è®¿é—®æ§åˆ¶</h2><div class="tabs" id="sxfwkz"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#sxfwkz-1">é™æ€æ–¹æ³•ä¸ç±»æ–¹æ³•</button></li><li class="tab"><button type="button" data-href="#sxfwkz-2"><code>&#64;property</code>ç‰¹æ€§</button></li><li class="tab"><button type="button" data-href="#sxfwkz-3">æè¿°ç¬¦</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="sxfwkz-1"><p>åœ¨ç±»å®šä¹‰ä¸­ï¼Œæ‰€æœ‰æ–¹æ³•é»˜è®¤éƒ½æ˜¯åœ¨å®ä¾‹ä¸Šæ“ä½œçš„ï¼Œç‰¹ç‚¹æ˜¯æ€»æ˜¯å­˜åœ¨ä¸€ä¸ªåä¸º<code>self</code>ï¼ˆå½“ç„¶åç§°å¯ä»¥è‡ªå®šä¹‰ï¼‰çš„ä½ç½®å‚æ•°ï¼Œåœ¨é€šè¿‡å®ä¾‹è®¿é—®è¿™äº›æ–¹æ³•å±æ€§æ—¶ï¼Œè­¬å¦‚<code>obj.method</code>ï¼ˆ<code>obj</code>æ˜¯æŸä¸€ç±»å®ä¾‹ï¼Œ<code>method</code>æ˜¯ç±»ä¸­å®šä¹‰çš„æ™®é€šå®ä¾‹æ–¹æ³•ï¼‰ï¼Œpythonä¼šåˆ©ç”¨â€œç‰¹æ€§â€ï¼ˆç‰¹æ®Šå±æ€§ï¼‰æœºåˆ¶æ¥è¿›è¡Œè®¿é—®æ§åˆ¶ï¼Œäº‹å®ä¸Šï¼Œç”¨æˆ·å¾—åˆ°çš„ä¸æ˜¯åŸå§‹å‡½æ•°å¯¹è±¡<code>method</code>ï¼Œè€Œæ˜¯ä¼šå¾—åˆ°æ‰€è°“çš„â€œç»‘å®šæ–¹æ³•â€ï¼Œç»‘å®šæ–¹æ³•ç±»ä¼¼äºåå‡½æ•°ï¼ˆ<code>obj.method</code>è¿”å›çš„ç›¸å½“äºæ˜¯<code>partial(method,self=obj)</code>ï¼‰ï¼Œå…¶ä¸­<code>self</code>å‚æ•°å·²ç»å¡«å…¥ï¼Œä¿å­˜åœ¨ç»‘å®šæ–¹æ³•çš„æ‰§è¡Œç¯å¢ƒä¸­ï¼Œä½†æ˜¯å…¶ä»–å‚æ•°ä»éœ€åœ¨è°ƒç”¨è¯¥ï¼ˆç»‘å®šï¼‰æ–¹æ³•æ—¶æä¾›ï¼ˆå…¶å®ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç±»è°ƒç”¨å®ä¾‹æ–¹æ³•ï¼Œä¸è¿‡è¿™æ—¶å€™ä½ å°±éœ€è¦æ‰‹åŠ¨ä¼ å…¥å®ä¾‹å¯¹è±¡äº†ï¼Œå¦‚<code>cls.method(obj,...)</code>ï¼Œ<code>cls</code>ä¸º<code>obj</code>çš„æ‰€å±ç±»ï¼Œçœç•¥å·çœç•¥äº†æ–¹æ³•å¯èƒ½å­˜åœ¨çš„å…¶ä»–å‚æ•°ï¼‰ï¼Œè¿™ç§ç»‘å®šæ–¹æ³•æ˜¯ç”±åœ¨åå°æ‰§è¡Œçš„ç‰¹æ€§å‡½æ•°é™é»˜åˆ›å»ºçš„ï¼Œä½ è¿˜å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå…¶ä»–ä¸¤ç§ç‰¹æ€§å‡½æ•°åˆ†åˆ«ç”¨äºåˆ›å»ºé™æ€æ–¹æ³•å’Œç±»æ–¹æ³•ï¼Œé™æ€æ–¹æ³•æ˜¯ä¸€ç§æ™®é€šå‡½æ•°ï¼Œä½†æ˜¯ä½äºç±»å®šä¹‰çš„å‘½åç©ºé—´ä¸­ï¼Œè¦å®šä¹‰é™æ€æ–¹æ³•ï¼Œå¯ä½¿ç”¨<code>@staticmethod</code>è£…é¥°å™¨ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x,y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> x+y</span><br></pre></td></tr></table></figure><p>ä¸åŒäºå®ä¾‹æ–¹æ³•ï¼Œé™æ€æ–¹æ³•å±æ€§è®¿é—®è¿”å›çš„å°±æ˜¯åŸå§‹çš„å‡½æ•°å¯¹è±¡è€Œéç»‘å®šæ–¹æ³•ï¼Œä¸”æ—¢å¯ä»¥é€šè¿‡ç±»ä¹Ÿå¯ä»¥é€šè¿‡å®ä¾‹æ¥è°ƒç”¨é™æ€æ–¹æ³•ã€‚å¦‚æœåœ¨ç¼–å†™ç±»æ—¶éœ€è¦é‡‡ç”¨å¾ˆå¤šä¸åŒçš„æ–¹å¼æ¥åˆ›å»ºæ–°å®ä¾‹ï¼Œè€Œç±»ä¸­åªèƒ½ç”±ä¸€ä¸ª<code>__init__()</code>æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•ï¼Œæ›¿ä»£çš„åˆ›å»ºå‡½æ•°é€šå¸¸æŒ‰å¦‚ä¸‹å½¢å¼å®šä¹‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Date</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,year,month,day</span>):</span></span><br><span class="line">        self.year,self.month,self.day=year,month,day</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">now</span>():</span></span><br><span class="line">        t=time.localtime()</span><br><span class="line">        <span class="keyword">return</span> Date(t.tm_year,t.tm_mon,t.tm_mday)</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tomorrow</span>():</span></span><br><span class="line">        t=time.localtime(time.time()+<span class="number">86400</span>)</span><br><span class="line">        <span class="keyword">return</span> Date(t.tm_year,t.tm_mon,t.tm_mday)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.year&#125;</span>-<span class="subst">&#123;self.month&#125;</span>-<span class="subst">&#123;self.day&#125;</span>&#x27;</span></span><br><span class="line">        </span><br><span class="line">print(Date(<span class="number">1967</span>,<span class="number">4</span>,<span class="number">9</span>)) <span class="comment">#1967-4-9</span></span><br><span class="line">print(Date.now()) <span class="comment">#2021-5-18</span></span><br><span class="line">print(Date.tomorrow()) <span class="comment">#2021-5-19</span></span><br></pre></td></tr></table></figure><p>ç±»æ–¹æ³•æ˜¯å°†ç±»æœ¬èº«ä½œä¸ºå¯¹è±¡è¿›è¡Œæ“ä½œçš„æ–¹æ³•ï¼Œç±»æ–¹æ³•ä½¿ç”¨<code>@classmethod</code>è£…é¥°å™¨ï¼Œä¸å®ä¾‹æ–¹æ³•ä¸åŒåœ¨äºï¼Œç±»æ–¹æ³•å®šä¹‰çš„ç¬¬ä¸€ä¸ªå‚æ•°é€šå¸¸å‘½åä¸º<code>cls</code>ï¼Œä¸”å°†ç±»æœ¬èº«ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ é€’ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Times</span>:</span></span><br><span class="line">    factor=<span class="number">1</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mul</span>(<span class="params">cls,x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> cls.factor*x</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TwoTimes</span>(<span class="params">Times</span>):</span></span><br><span class="line">    factor=<span class="number">2</span></span><br><span class="line">    </span><br><span class="line">print(TwoTimes.mul(<span class="number">4</span>)) <span class="comment">#8</span></span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºå®ä¾‹æ–¹æ³•çš„å±æ€§è®¿é—®ï¼Œç±»æ–¹æ³•å±æ€§è®¿é—®åŒæ ·è¿”å›ç»‘å®šæ–¹æ³•ï¼Œå› æ­¤ä¸Šè¿°ç¤ºä¾‹ä¸­<code>TwoTimes.mul</code>è¿”å›çš„ç›¸å½“äº<code>partial(mul,cls=TwoTimes)</code>ï¼Œä¸”ç±»æ–¹æ³•ä¹Ÿèƒ½é€šè¿‡å®ä¾‹è°ƒç”¨ï¼Œè­¬å¦‚<code>t=TwoTimes();t.mul(4)</code>ï¼Œå…¶ä¸­<code>t.mul</code>è¿”å›çš„ç›¸å½“äº<code>partial(mul,cls=t.__class__)</code></p><p>åœ¨ä¹‹å‰çš„<code>Date</code>ç±»ç¤ºä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨é™æ€æ–¹æ³•å®ç°å¤šä¸ªåˆ›å»ºå‡½æ•°ï¼Œå‡è®¾æœ‰ä¸€ä¸ªå­ç±»<code>EuroDate</code>ç»§æ‰¿å®ƒä»¥è¾“å‡ºæ¬§æ´²æ—¥æœŸæ ¼å¼ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°ç»“æœä¸ç¬¦åˆé¢„æœŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EuroDate</span>(<span class="params">Date</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.day:02d&#125;</span>/<span class="subst">&#123;self.month:02d&#125;</span>/<span class="subst">&#123;self.year&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">print(EuroDate.now()) <span class="comment">#2021-5-18</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¹‹æ‰€ä»¥è¿˜æ˜¯æ—§æ ¼å¼ï¼Œè¿™æ˜¯å› ä¸º<code>EuroDate.now()</code>è¿”å›çš„æ˜¯ä¸€ä¸ª<code>Date</code>å¯¹è±¡ï¼Œåº”é‡‡ç”¨ç±»æ–¹æ³•å®ç°åˆ›å»ºå‡½æ•°æ¥é¿å…è¯¥é”™è¯¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Date</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,year,month,day</span>):</span></span><br><span class="line">        self.year,self.month,self.day=year,month,day</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">now</span>(<span class="params">cls</span>):</span></span><br><span class="line">        t=time.localtime()</span><br><span class="line">        <span class="keyword">return</span> cls(t.tm_year,t.tm_mon,t.tm_mday)</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tomorrow</span>(<span class="params">cls</span>):</span></span><br><span class="line">        t=time.localtime(time.time()+<span class="number">86400</span>)</span><br><span class="line">        <span class="keyword">return</span> cls(t.tm_year,t.tm_mon,t.tm_mday)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.year&#125;</span>-<span class="subst">&#123;self.month&#125;</span>-<span class="subst">&#123;self.day&#125;</span>&#x27;</span></span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EuroDate</span>(<span class="params">Date</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.day:02d&#125;</span>/<span class="subst">&#123;self.month:02d&#125;</span>/<span class="subst">&#123;self.year&#125;</span>&#x27;</span></span><br><span class="line">        </span><br><span class="line">print(EuroDate.now()) <span class="comment">#18/05/2021</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="sxfwkz-2"><p>é€šå¸¸ï¼Œè®¿é—®å®ä¾‹æˆ–ç±»å±æ€§æ—¶ï¼Œä¼šè¿”å›æ‰€å­˜å‚¨çš„ç›¸å…³å€¼ï¼Œç”±<code>@property</code>ç‰¹æ€§æ”¯æŒçš„å±æ€§ï¼Œå¯ä»¥åœ¨è®¿é—®æ—¶ç»è¿‡è®¡ç®—å¾—åˆ°è¿”å›å€¼ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,radius</span>):</span></span><br><span class="line">        self.radius=radius</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">area</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> math.pi*self.radius**<span class="number">2</span></span><br><span class="line">        </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">perimeter</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>*math.pi*self.radius</span><br><span class="line">        </span><br><span class="line">c=Circle(<span class="number">4</span>)</span><br><span class="line">print(<span class="string">f&#x27;åŠå¾„ï¼š<span class="subst">&#123;c.radius&#125;</span>ï¼Œå‘¨é•¿ï¼š<span class="subst">&#123;c.perimeter&#125;</span>ï¼Œé¢ç§¯ï¼š<span class="subst">&#123;c.area&#125;</span>&#x27;</span>) <span class="comment">#åŠå¾„ï¼š4ï¼Œå‘¨é•¿ï¼š25.132741228718345ï¼Œé¢ç§¯ï¼š50.26548245743669</span></span><br><span class="line"><span class="comment">#c.area=8 #AttributeError: can&#x27;t set attribute #å½“å‰areaâ€œå±æ€§â€ä»…ä»…æ˜¯åªè¯»çš„ï¼Œé™¤éè®¾ç½®setteræ–¹æ³•ï¼Œå…·ä½“è§ä¸‹</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œè®¡ç®—é¢ç§¯çš„<code>area()</code>å®ä¾‹æ–¹æ³•å’Œè®¡ç®—å‘¨é•¿çš„<code>perimeter()</code>å®ä¾‹æ–¹æ³•ï¼Œé€šè¿‡è£…é¥°å™¨<code>@property</code>ä¿®é¥°åï¼Œæ”¯æŒä»¥ç®€å•å±æ€§çš„å½¢å¼è®¿é—®ï¼ˆä¸éœ€è¦åŠ <code>()</code>è°ƒç”¨ï¼‰ï¼Œç”¨æˆ·å¾ˆéš¾å‘ç°æ­£åœ¨â€œè®¡ç®—â€ä¸€ä¸ªå±æ€§ï¼Œé™¤éåœ¨è¯•å›¾é‡æ–°å®šä¹‰è¯¥å±æ€§æ—¶ç”Ÿæˆäº†é”™è¯¯æ¶ˆæ¯ï¼ˆ<code>AttributeError</code>å¼‚å¸¸ï¼‰ï¼Œè¿™ç§ç‰¹æ€§ä½¿ç”¨æ–¹å¼éµå¾ªæ‰€è°“çš„ç»Ÿä¸€è®¿é—®åŸåˆ™ï¼Œä½ ä¸éœ€è¦è´¹åŠ›äº†è§£ä½•æ—¶æ·»åŠ é¢å¤–çš„<code>()</code>æ‰€å¸¦æ¥çš„ä¸å¿…è¦çš„æ··æ·†</p><p>äº‹å®ä¸Šï¼Œè¯¥ç‰¹æ€§è¿˜å¯ä»¥æ‹¦æˆªæ“ä½œï¼Œä»¥è®¾ç½®å’Œåˆ é™¤å±æ€§ï¼Œè¿™æ˜¯é€šè¿‡å‘ç‰¹æ€§é™„åŠ <code>setter</code>å’Œ<code>deleter</code>æ“ä½œæ¥å®ç°çš„ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name</span>):</span></span><br><span class="line">        self.name=name</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__score <span class="comment">#å°†å€¼å®é™…å­˜å‚¨åœ¨å…¶ä»–åç§°ä¸­ï¼Œé€šå¸¸æ˜¯åœ¨åŠ ä¸¤ä¸ªä¸‹åˆ’çº¿å‰ç¼€ï¼Œå³â€œç§æœ‰å±æ€§â€ä¸­ï¼Œä½†æ˜¯æ³¨æ„â€œç§æœ‰å±æ€§â€å…¶å®ä¹Ÿç›´æ¥æš´éœ²åœ¨å¤–ï¼Œè€Œä¸”æ˜“äºè¾¨è¯†ï¼Œä½ å¯ä»¥é€šè¿‡è®¿é—®å®ä¾‹çš„__dict__çœ‹åˆ°å®ƒï¼Œå¯ä»¥å®šä¹‰__slots__æ¥ç¦ç”¨__dict__ï¼Œä½†æ˜¯ä½ ä¾æ—§æ— æ³•é˜»æ­¢é€šè¿‡setattr(...)çš„æ–¹å¼è¿›è¡Œéæ³•èµ‹å€¼</span></span><br><span class="line">        </span><br><span class="line"><span class="meta">    @score.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self,score</span>):</span></span><br><span class="line">        <span class="keyword">if</span> score&gt;=<span class="number">0</span> <span class="keyword">and</span> score&lt;=<span class="number">100</span>:</span><br><span class="line">            self.__score=score</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0 ~ 100!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s=student(<span class="string">&#x27;zj&#x27;</span>)</span><br><span class="line">s.score=<span class="number">99</span> <span class="comment">#å¦‚æœè®¾ç½®çš„æ•°å€¼å¤§äº100ï¼Œå°†å¯¼è‡´é”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬åˆ©ç”¨ç‰¹æ€§è¿›è¡Œäº†ç›¸å…³çš„è®¿é—®æ§åˆ¶</span></span><br><span class="line">print(s.name,s.score) <span class="comment">#zj 99</span></span><br><span class="line"></span><br><span class="line">print(s.__dict__) <span class="comment">#&#123;&#x27;name&#x27;: &#x27;zj&#x27;, &#x27;_student__score&#x27;: 99&#125;</span></span><br><span class="line"></span><br><span class="line">s.__sex=<span class="string">&#x27;female&#x27;</span> <span class="comment">#åªæœ‰åœ¨ç±»å®šä¹‰ä¸­ç»‘å®šçš„ä»¥åŒä¸‹åˆ’çº¿æ‰“å¤´çš„å®ä¾‹å±æ€§è¢«è®¤ä¸ºæ˜¯â€œç§æœ‰å±æ€§â€å¹¶è¢«å€¾è½§ï¼Œåœ¨ç±»å®šä¹‰å¤–åŠ¨æ€ç»‘å®šçš„åˆ™ä¸ä¼šè¢«è®¤ä¸ºæ˜¯ç§æœ‰å±æ€§ï¼Œä¹Ÿä¸ä¼šè¢«å€¾è½§</span></span><br><span class="line">print(s.__dict__) <span class="comment">#&#123;&#x27;name&#x27;: &#x27;zj&#x27;, &#x27;_student__score&#x27;: 99, &#x27;__sex&#x27;: &#x27;female&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆä½¿ç”¨<code>@property</code>è£…é¥°å™¨å°†ç›¸å…³æ–¹æ³•<code>score()</code>è½¬å˜æˆäº†åªè¯»å±æ€§ï¼Œåé¢çš„<code>@score.setter</code>è£…é¥°å™¨å°†å…¶ä»–æ–¹æ³•ä¸<code>score</code>å±æ€§ä¸Šçš„è®¾ç½®æ“ä½œç›¸å…³è”ï¼Œè¿™ä¸ªâ€œå…¶ä»–æ–¹æ³•â€çš„åç§°åº”è¯¥ä¸åŸå§‹ç‰¹æ€§çš„åç§°å®Œå…¨åŒ¹é…</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="sxfwkz-3"><p>ä½¿ç”¨<code>@property</code>ç‰¹æ€§åï¼Œå¯¹å±æ€§çš„è®¿é—®å°†ç”±ä¸€ç³»åˆ—ç”¨æˆ·å®šä¹‰çš„getã€setå’Œdeleteå‡½æ•°æ§åˆ¶ï¼Œè¿™ç§å±æ€§æ§åˆ¶æ–¹å¼å¯ä»¥ç”±â€œæè¿°ç¬¦â€è¿›ä¸€æ­¥æ¨å¹¿ï¼Œæè¿°ç¬¦å°±æ˜¯ä¸€ä¸ªè¡¨ç¤ºå±æ€§å€¼çš„å¯¹è±¡ï¼Œå‡¡æ˜¯å®ç°<code>__get__()</code>ã€<code>__set__()</code>å’Œ<code>__delete__()</code>æ–¹æ³•çš„å°±æ˜¯æè¿°ç¬¦ï¼Œæ³¨æ„æè¿°ç¬¦åªèƒ½åœ¨ç±»çº§åˆ«ä¸Šè¿›è¡Œå®ä¾‹åŒ–ï¼Œå½“ä½ é€šè¿‡å®ä¾‹è®¿é—®ä¸€ä¸ªæè¿°ç¬¦å¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨æè¿°ç¬¦çš„<code>__get__()</code>ã€<code>__set__()</code>æˆ–<code>__delete__()</code>ï¼Œå¹¶æ€»æ˜¯ä¼ å…¥å®ä¾‹ä½œä¸ºå‚æ•°ä¹‹ä¸€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">movie</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,title,score,ratings</span>):</span></span><br><span class="line">        self.title=title</span><br><span class="line">        self.score=score</span><br><span class="line">        self.ratings=ratings</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @score.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self,newValue</span>):</span></span><br><span class="line">        <span class="keyword">if</span> newValue&lt;<span class="number">0</span> <span class="keyword">or</span> newValue&gt;<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;movie&#x27;s score can&#x27;t be negative or greater than 10&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self._score=newValue</span><br><span class="line">            </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ratings</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._ratings</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @ratings.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ratings</span>(<span class="params">self,newValue</span>):</span></span><br><span class="line">        <span class="keyword">if</span> newValue&lt;<span class="number">0</span> <span class="keyword">or</span> newValue&gt;<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;movie&#x27;s ratings can&#x27;t be negative or greater than 10&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self._ratings=newValue</span><br><span class="line">            </span><br><span class="line">m=movie(<span class="string">&#x27;åå¤©&#x27;</span>,<span class="number">7.5</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç¤ºä¾‹ä¸­å®šä¹‰äº†ä¸€ä¸ªé€šè¿‡<code>@property</code>è¿›è¡Œå±æ€§è®¿é—®æ§åˆ¶çš„ç”µå½±ç±»ï¼Œå¯ä»¥çœ‹åˆ°<code>score</code>å’Œ<code>ratings</code>ä¸¤ä¸ªå±æ€§æ‹¥æœ‰ç›¸åŒçš„è®¿é—®æ§åˆ¶ï¼Œä»è€Œå¯¼è‡´ä¸Šè¿°ä»£ç æœ‰è¾ƒé«˜çš„é‡å¤ç‡ï¼Œè€Œæè¿°ç¬¦çš„è®¿é—®æ§åˆ¶å¯ä»¥è¢«å¤šä¸ªå±æ€§é‡å¤åˆ©ç”¨ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä½ æ€»æ˜¯åº”è¯¥é€šè¿‡å®ä¾‹è€Œéç±»åè®¿é—®æè¿°ç¬¦ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> weakref <span class="keyword">import</span> WeakKeyDictionary</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">descriptor</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,default</span>):</span></span><br><span class="line">        self.default=default</span><br><span class="line">        self.data=WeakKeyDictionary() <span class="comment">#ç”±äºæè¿°ç¬¦æ˜¯å®šä¹‰åœ¨ç±»å±‚çº§çš„ï¼Œå› æ­¤å¯¹äºç±»çš„æ‰€æœ‰å®ä¾‹éƒ½æ˜¯å¯è®¿é—®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå­—å…¸ï¼Œå­˜å‚¨ç±»çš„æ‰€æœ‰å®ä¾‹åŠå…¶å±æ€§å€¼</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span>(<span class="params">self,instance,owner</span>):</span> <span class="comment">#åœ¨è®¿é—®movieå®ä¾‹mçš„scoreå±æ€§æ—¶ï¼Œä¼šè¢«è§£é‡Šå™¨è§£é‡Šä¸ºm.__class__.score.__get__(m,m.__class__)</span></span><br><span class="line">        <span class="comment">#print(owner) #&lt;class &#x27;__main__.movie&#x27;&gt;</span></span><br><span class="line">        <span class="keyword">if</span> instance==<span class="literal">None</span>: <span class="comment">#å¦‚æœé€šè¿‡ç±»è®¿é—®æè¿°ç¬¦ï¼Œä¼ å…¥çš„å®ä¾‹å°†ä¸ºNoneï¼Œæ­¤æ—¶è¿”å›æè¿°ç¬¦å¯¹è±¡æœ¬èº«ï¼Œè¯¥æ“ä½œæ˜¯é€šç”¨æ“ä½œï¼Œè¯¥è®¾ç½®å…è®¸æˆ‘ä»¬èƒ½å¤Ÿè·å–åˆ°åœ¨ç±»å±‚çº§å®šä¹‰çš„æè¿°ç¬¦å¯¹è±¡æœ¬èº«</span></span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> self.data.get(instance,self.default)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__set__</span>(<span class="params">self,instance,value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> value&lt;<span class="number">0</span> <span class="keyword">or</span> value&gt;<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;movie&#x27;s score or ratings can&#x27;t be negative or greater than 10&quot;</span>)</span><br><span class="line">        self.data[instance]=value</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">movie</span>:</span></span><br><span class="line">    score=descriptor(<span class="number">0</span>)</span><br><span class="line">    ratings=descriptor(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,title,score,ratings</span>):</span></span><br><span class="line">        self.title=title</span><br><span class="line">        self.score=score <span class="comment">#æ³¨æ„åƒä¸‡ä¸èƒ½é€šè¿‡ç±»åè®¿é—®æè¿°ç¬¦å¯¹è±¡ï¼Œè­¬å¦‚movie.score=scoreï¼Œè¿™å°†å¯¼è‡´ç±»çš„scoreå±æ€§ä»ä¸€ä¸ªæè¿°ç¬¦å¯¹è±¡è½¬å˜ä¸ºä¸€ä¸ªæ•°å€¼å¯¹è±¡ï¼Œå› ä¸ºè¿™ä¸ä¼šè§¦å‘è°ƒç”¨æè¿°ç¬¦çš„__set__()æ–¹æ³•ï¼Œä¸è¿‡print(movie.score)è¿˜æ˜¯ä¼šè§¦å‘è°ƒç”¨æè¿°ç¬¦çš„__get__()æ–¹æ³•çš„ï¼Œåªæ˜¯æ­¤æ—¶ä¼ å…¥__get__()çš„instanceå®ä¾‹å¯¹è±¡æ˜¯None</span></span><br><span class="line">        self.ratings=ratings</span><br><span class="line"></span><br><span class="line">m1=movie(<span class="string">&#x27;åå¤©&#x27;</span>,<span class="number">7.5</span>,<span class="number">3</span>)</span><br><span class="line">print(m1.score,m1.ratings) <span class="comment">#7.5 3</span></span><br><span class="line"><span class="comment">#m2=movie(&#x27;åå¤©&#x27;,7.5,-3) #ValueError: movie&#x27;s score or ratings can&#x27;t be negative or greater than 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#m1.score=-1 #ValueError: movie&#x27;s score or ratings can&#x27;t be negative or greater than 10</span></span><br><span class="line">movie.score.data[m1]=-<span class="number">1</span> <span class="comment">#åœ¨è¿™ç§åŸºäºâ€œå®ä¾‹-å±æ€§å€¼â€å­—å…¸å®ç°çš„æè¿°ç¬¦ä¸‹å…¶å®ä½ è¿˜æ˜¯å¯ä»¥ç»•è¿‡æè¿°ç¬¦çš„è®¿é—®æ§åˆ¶å®ç°éæ³•èµ‹å€¼</span></span><br><span class="line">print(m1.score) <span class="comment">#-1</span></span><br></pre></td></tr></table></figure><p>å½“è®¿é—®å®ä¾‹å±æ€§çš„æ—¶å€™ï¼Œ<code>obj.x</code>æ€»æ˜¯è°ƒç”¨<code>__getattribute__()</code>æ–¹æ³•ï¼ˆå› æ­¤ä½ ä¹Ÿå¯ä»¥é€šè¿‡é‡è½½<code>__getattributr__()</code>è¿›è¡Œæœ€ç®€å•çš„å±æ€§è®¿é—®æ§åˆ¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸è¦å¿˜è®°è°ƒç”¨çˆ¶ç±»çš„<code>__getattributr__()</code>æ–¹æ³•ä»¥é˜²å±æ€§æŸ¥æ‰¾å¤±è´¥ï¼Œæ‰€ä»¥ä¸å¤ªå»ºè®®è¿™ä¹ˆåšï¼‰ï¼Œå…¶è¡Œä¸ºæ˜¯ï¼Œ1ï¼‰æ£€æŸ¥ç±»ä¸­æ˜¯å¦æœ‰åŒåçš„æ•°æ®æè¿°ç¬¦å¯¹è±¡ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è‡ªåŠ¨å˜å½¢ä¸º<code>obj.__class__.__dict__['x'].__get__(obj,obj.__class__)</code>ï¼Œå¦åˆ™ï¼Œ2ï¼‰æ£€æŸ¥å®ä¾‹å­—å…¸ï¼Œå³åœ¨å®ä¾‹çš„<code>__dict__</code>ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°åˆ™è¿”å›ï¼Œå¦åˆ™ï¼Œ3ï¼‰æ£€æŸ¥ç±»å­—å…¸ï¼Œå³åœ¨<code>obj.__class__.__dict__</code>ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°åˆ™è¿”å›ï¼Œå¦‚æœæ˜¯åŒåçš„éæ•°æ®æè¿°ç¬¦ï¼Œåˆ™è¿˜ä¼šè‡ªåŠ¨å˜å½¢ï¼Œå¦åˆ™ï¼Œ4ï¼‰æŒ‰ç…§MROé¡ºåºä¾æ¬¡æ£€æŸ¥åŸºç±»å­—å…¸ï¼Œå¦‚æœè¿˜æ‰¾ä¸åˆ°ï¼Œåˆ™æ£€æŸ¥<code>obj</code>æ‰€åœ¨ç±»æ˜¯å¦å®šä¹‰äº†<code>__getattr__()</code>æ–¹æ³•ï¼Œæœ‰åˆ™è¿”å›<code>__getattr__()</code>çš„è°ƒç”¨ç»“æœï¼Œå¦åˆ™æŠ›å‡º<code>AttributeError</code></p><p>å½“è®¿é—®å®ä¾‹å±æ€§å¹¶è¿›è¡Œèµ‹å€¼çš„æ—¶å€™ï¼Œ<code>obj.x=value</code>æ€»æ˜¯è°ƒç”¨<code>__setattr__()</code>æ–¹æ³•ï¼Œå…¶è¡Œä¸ºæ˜¯ï¼Œ1ï¼‰å¦‚æœç±»ä¸­æœ‰åŒåçš„æ•°æ®æè¿°ç¬¦å¯¹è±¡ï¼Œåˆ™è‡ªåŠ¨å˜å½¢ä¸º<code>obj.__class__.__dict__['x'].__set__(obj,value)</code>ï¼Œå¦åˆ™ï¼Œ2ï¼‰åœ¨å®ä¾‹çš„å­—å…¸<code>__dict__</code>ä¸­æŸ¥æ‰¾ï¼Œæœ‰åˆ™ä¿®æ”¹ç›¸åº”çš„é”®å€¼ï¼Œæ²¡æœ‰åˆ™å°†å±æ€§<code>x</code>ç›´æ¥ç»‘å®šåœ¨å®ä¾‹ä¸Šï¼Œå³<code>__dict__.update({'x':value})</code>ï¼ˆ<code>del obj.x</code>è¯­å¥å°†è§¦å‘è°ƒç”¨<code>__delattr__()</code>æ–¹æ³•ï¼Œå’Œ<code>obj.x=value</code>è§¦å‘è°ƒç”¨<code>__setattr__()</code>ç±»ä¼¼ï¼Œåªä¸è¿‡å…¶é»˜è®¤è¡Œä¸ºæ˜¯åˆ é™¤<code>obj</code>çš„<code>__dict__</code>ä¸­å­˜å‚¨çš„é”®å€¼ï¼Œé™¤éè¯·æ±‚çš„å±æ€§æ­£å¥½æ˜¯ä¸€ä¸ªæè¿°ç¬¦å¯¹è±¡ï¼Œæ­¤æ—¶å°†ä¼šæ‰§è¡Œ<code>obj.__class__.__dict__['x'].__delete__(obj)</code>ï¼Œå¦‚æœå®ä¾‹å­—å…¸ä¸­æ²¡æœ‰è¯¥å±æ€§ï¼Œåˆ™æŠ›å‡º<code>AttributeError</code>ï¼‰</p><p>æ³¨ï¼šå®ç°äº†<code>__set__()</code>å’Œ<code>__get__()</code>æ–¹æ³•çš„æè¿°ç¬¦ç±»è¢«ç§°ä¸ºæ•°æ®æè¿°ç¬¦ï¼Œå¦‚æœåªå®ç°äº†<code>__get__()</code>æ–¹æ³•ï¼Œåˆ™ç§°ä¸ºéæ•°æ®æè¿°ç¬¦</p><p>ä¸Šé¢çš„æè¿°ç¬¦ç¤ºä¾‹ä¸­é‡‡ç”¨å­—å…¸å­˜å‚¨æ‰€æœ‰çš„å®ä¾‹å’Œå±æ€§å€¼ï¼Œä½†å¦‚æœå®ä¾‹æ˜¯ä¸å¯å“ˆå¸Œå¯¹è±¡å‘¢ï¼Œä¸ºæ­¤æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥å°†å±æ€§å€¼ç»‘å®šåˆ°å®ä¾‹ï¼ˆçš„<code>__dict__</code>ï¼‰ä¸Šé¢ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">descriptor</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,label,default</span>):</span></span><br><span class="line">        self.label=label</span><br><span class="line">        self.default=default</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span>(<span class="params">self,instance,owner</span>):</span></span><br><span class="line">        <span class="keyword">if</span> instance==<span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__.get(self.label,self.default)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__set__</span>(<span class="params">self,instance,value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> value&lt;<span class="number">0</span> <span class="keyword">or</span> value&gt;<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;movie&#x27;s score or ratings can&#x27;t be negative or greater than 10&quot;</span>)</span><br><span class="line">        instance.__dict__[self.label]=value</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">movie</span>:</span></span><br><span class="line">    score=descriptor(<span class="string">&#x27;score&#x27;</span>,<span class="number">0</span>) <span class="comment">#ä¸åŒåä¹Ÿè¡Œï¼Œä½†è¿™å°±é‡è¹ˆ@propertyçš„è¦†è¾™äº†ï¼Œè­¬å¦‚åç§°æ”¹ä¸º&#x27;_score&#x27;ï¼Œæ­¤æ—¶é€šè¿‡â€œobj.score=éæ³•å€¼â€è‡ªç„¶ä¼šå—åˆ°è®¿é—®æ§åˆ¶ï¼Œä½†æ˜¯â€œobj._score=éæ³•å€¼â€åˆ™ä¸å—ä¿æŠ¤</span></span><br><span class="line">    ratings=descriptor(<span class="string">&#x27;ratings&#x27;</span>,<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,title,score,ratings</span>):</span></span><br><span class="line">        self.title=title</span><br><span class="line">        self.score=score</span><br><span class="line">        self.ratings=ratings</span><br><span class="line"></span><br><span class="line">m1=movie(<span class="string">&#x27;åå¤©&#x27;</span>,<span class="number">7.5</span>,<span class="number">3</span>)</span><br><span class="line">print(m1.score,m1.ratings) <span class="comment">#7.5 3</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    m1.score=-<span class="number">10</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">    </span><br><span class="line">print(m1.__dict__) <span class="comment">#&#123;&#x27;title&#x27;: &#x27;åå¤©&#x27;, &#x27;score&#x27;: 7.5, &#x27;ratings&#x27;: 3&#125;</span></span><br><span class="line"></span><br><span class="line">m1.__dict__[<span class="string">&#x27;score&#x27;</span>]=-<span class="number">1000</span> <span class="comment">#åœ¨è¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥é€šè¿‡ç›´æ¥ä¿®æ”¹å®ä¾‹å­—å…¸æ¥ç»•è¿‡æè¿°ç¬¦çš„è®¿é—®æ§åˆ¶ï¼Œå”‰ï¼Œæœ‰å®Œç¾çš„è§£å†³æ–¹æ¡ˆå—</span></span><br><span class="line">print(m1.score) <span class="comment">#-1000</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°åœ¨ç±»å±‚çº§å®šä¹‰æè¿°ç¬¦çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨ä¼ å…¥å±æ€§åç§°å­—ç¬¦ä¸²ï¼Œ<code>score=descriptor('score',0)</code>ï¼Œè¿™ä¸å¤ªæ–¹ä¾¿ï¼Œä¸ºäº†éšè—è¯¥ç»†èŠ‚ï¼Œå¯ä»¥å€ŸåŠ©å…ƒç±»ï¼Œä½¿å¾—å®šä¹‰å˜å›<code>score=descriptor(0)</code>è¿™ç§ç®€æ´å½¢å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">descriptor</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,default,label=<span class="literal">None</span></span>):</span> <span class="comment">#æ­¤å¤„å‚æ•°å®šä¹‰è¦ç¨ç¨ä¿®æ”¹</span></span><br><span class="line">        self.label=label</span><br><span class="line">        self.default=default</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span>(<span class="params">self,instance,owner</span>):</span></span><br><span class="line">        <span class="keyword">if</span> instance==<span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__.get(self.label,self.default)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__set__</span>(<span class="params">self,instance,value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> value&lt;<span class="number">0</span> <span class="keyword">or</span> value&gt;<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;movie&#x27;s score or ratings can&#x27;t be negative or greater than 10&quot;</span>)</span><br><span class="line">        instance.__dict__[self.label]=value</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__delete__</span>(<span class="params">self,instance</span>):</span> <span class="comment">#__delete__()ä¸å¤ªå¸¸ç”¨ï¼Œä¸»è¦ç”¨æ¥ä½¿å®ä¾‹ï¼ˆæè¿°ç¬¦ï¼‰å±æ€§ä¸å¯åˆ é™¤ï¼Œä½†æ˜¯ä½ ä¸èƒ½åœ¨__del__()æ–¹æ³•ä¸­é€šè¿‡æŠ›å‡ºå¼‚å¸¸é˜»æ­¢å¯¹è±¡çš„åˆ é™¤</span></span><br><span class="line">        <span class="keyword">raise</span> AttributeError(<span class="string">&#x27;Can\&#x27;t delete this attribute!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">addLabelMeta</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls,name,bases,local_dict</span>):</span></span><br><span class="line">        <span class="keyword">for</span> k,v <span class="keyword">in</span> local_dict.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(v,descriptor):</span><br><span class="line">                v.label=k</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>(cls,cls).__new__(cls,name,bases,local_dict)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">movie</span>(<span class="params">metaclass=addLabelMeta</span>):</span></span><br><span class="line">    score=descriptor(<span class="number">0</span>)</span><br><span class="line">    ratings=descriptor(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,title,score,ratings</span>):</span></span><br><span class="line">        self.title=title</span><br><span class="line">        self.score=score</span><br><span class="line">        self.ratings=ratings</span><br><span class="line"></span><br><span class="line">m1=movie(<span class="string">&#x27;åå¤©&#x27;</span>,<span class="number">7.5</span>,<span class="number">3</span>)</span><br><span class="line">print(m1.score,m1.ratings) <span class="comment">#7.5 3</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    m1.score=-<span class="number">10</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">    </span><br><span class="line">print(m1.__dict__) <span class="comment">#&#123;&#x27;title&#x27;: &#x27;åå¤©&#x27;, &#x27;score&#x27;: 7.5, &#x27;ratings&#x27;: 3&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">del</span> m1.score</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">    </span><br><span class="line">print(m1.score) <span class="comment">#7.5</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div style="display:none"><h2 id="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</h2><div class="tabs" id="sjms"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#sjms-1">å•ä¾‹æ¨¡å¼</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="sjms-1"><p>æ‰€è°“å•ä¾‹ï¼Œå³ä¸€ä¸ªç±»æœ‰ä¸”åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæ— æ³•åˆ›å»ºç¬¬äºŒä¸ªå®ä¾‹ï¼Œä¸»è¦æœ‰ä¸‰ç§å®ç°å•ä¾‹çš„æ–¹å¼ï¼š</p><ul><li><p>é€šè¿‡<code>__new__()</code>æ§åˆ¶å®ä¾‹çš„åˆ›å»º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>:</span></span><br><span class="line">    __instance=<span class="literal">None</span> <span class="comment">#__instanceä¸éœ€è¦ä¸ºå¤–ç•ŒçŸ¥é“ï¼Œæ‰€ä»¥å¯ä»¥è®¾ä¸ºç§æœ‰å±æ€§</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls,*args,**kwds</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__instance:</span><br><span class="line">            cls.__instance=<span class="built_in">super</span>(Singleton,cls).__new__(cls,*args,**kwds)</span><br><span class="line">        <span class="keyword">return</span> cls.__instance</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mine</span>(<span class="params">Singleton</span>):</span> <span class="comment">#ä¸–é—´åªæœ‰ä¸€ä¸ªæˆ‘</span></span><br><span class="line">    <span class="comment">#def __new__(cls,*args,**kwargs): #å¦‚æœæœªå®šä¹‰__new__()ï¼Œåˆ™é»˜è®¤è°ƒç”¨çˆ¶ç±»çš„__new__()ï¼Œå¦‚æœå®šä¹‰äº†ï¼Œåˆ™éœ€æ‰‹åŠ¨è°ƒç”¨çˆ¶ç±»çš„__new__()ï¼Œæ‰€ä»¥ä¸€å®šè¦å†™æˆsuper()å½¢å¼ï¼Œç‰¹åˆ«æ˜¯mineè¿˜ç»§æ‰¿äº†å…¶ä»–ç±»ï¼ˆå¤šç»§æ‰¿ï¼‰çš„æƒ…å†µä¸‹ï¼Œå°±åªèƒ½ä¾é super()æœºåˆ¶</span></span><br><span class="line">    <span class="comment">#    ... #å…¶ä»–æ“ä½œ</span></span><br><span class="line">    <span class="comment">#    return super(mine,cls).__new__(cls,*args,**kwargs)</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name=<span class="string">&#x27;muggledy&#x27;</span></span>):</span></span><br><span class="line">        self.name=name</span><br><span class="line">        </span><br><span class="line">a=mine()</span><br><span class="line">b=mine(<span class="string">&#x27;dy&#x27;</span>)</span><br><span class="line">print(a <span class="keyword">is</span> b) <span class="comment">#True</span></span><br><span class="line">print(a.name) <span class="comment">#dy</span></span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ç±»è£…é¥°å™¨æ§åˆ¶å®ä¾‹çš„åˆ›å»ºï¼ˆæ¨èï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Singleton</span>(<span class="params">cls</span>):</span> <span class="comment">#ç±»è£…é¥°å™¨ï¼Œä¿®é¥°å¯¹è±¡æ˜¯ä¸€ä¸ªç±»</span></span><br><span class="line">    instances=&#123;&#125; <span class="comment"># å­˜å‚¨æ‰€æœ‰çš„â€œç±»-å•ä¾‹â€é”®å€¼å¯¹</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args,**kwds</span>):</span> <span class="comment">#æˆ–è®¸å‘½åä¸ºget_instanceæ›´æ¸…æ™°</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> instances:</span><br><span class="line">            instances[cls]=cls(*args,**kwds)</span><br><span class="line">        <span class="keyword">return</span> instances[cls]</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line">    </span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mine</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name=<span class="string">&#x27;muggledy&#x27;</span></span>):</span></span><br><span class="line">        self.name=name</span><br><span class="line">        </span><br><span class="line">a=mine()</span><br><span class="line">b=mine(<span class="string">&#x27;dy&#x27;</span>)</span><br><span class="line">print(a <span class="keyword">is</span> b) <span class="comment">#True</span></span><br></pre></td></tr></table></figure></li><li><p>é€šè¿‡å…ƒç±»çš„<code>__call__()</code>æ–¹æ³•æ§åˆ¶å®ä¾‹çš„åˆ›å»º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingletonMetaCls</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">cls,*args,**kwargs</span>):</span> <span class="comment">#ä¸¾ä¾‹è¯´ï¼ˆä¸‹é¢çš„æ³¨é‡Šä¹Ÿéƒ½æ˜¯ä»¥mineç±»ä¸ºä¾‹ï¼Œå³clså‚æ•°ä¸ºmineï¼‰ï¼Œmineç±»çš„åˆ›å»ºï¼šmine=SingletonMetaCls(...)ï¼Œå³mineç±»æœ¬èº«å°±æ˜¯SingletonMetaClså…ƒç±»çš„ä¸€ä¸ªå®ä¾‹è€Œå·²ï¼Œå› æ­¤å½“æˆ‘ä»¬åˆ›å»ºç±»mineçš„å®ä¾‹ï¼Œå³é€šè¿‡å°æ‹¬å·è°ƒç”¨mineç±»æ—¶ï¼ša=mine(...)ï¼Œä¼šè§¦å‘è°ƒç”¨SingletonMetaClsä¸­å®šä¹‰çš„__call__()æ–¹æ³•ï¼šSingletonMetaCls.__call__(mine,...)ï¼Œå…¶æ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„mineç±»å®ä¾‹ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨callæ–¹æ³•ä¸­æ‹¦æˆªæ–°å®ä¾‹çš„åˆ›å»ºï¼Œä½¿å…¶è¿”å›æ—§å®ä¾‹ï¼ˆå‡è®¾å·²å­˜åœ¨çš„è¯ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> cls._instance <span class="keyword">is</span> <span class="literal">None</span>: <span class="comment">#mineç±»çš„_instanceå±æ€§ç”¨äºå­˜å‚¨å”¯ä¸€çš„å®ä¾‹ï¼Œéœ€è¦è°ƒç”¨newå’Œinitæ–¹æ³•è¿›è¡Œåˆ›å»ºå’Œåˆå§‹åŒ–ï¼Œå¦‚æœå·²ç»å­˜åœ¨åˆ™åªéœ€è¦é‡æ–°åˆå§‹åŒ–initå³å¯</span></span><br><span class="line">            cls._instance=cls.__new__(cls,*args,**kwargs) <span class="comment">#æ­¤å¤„çš„_instanceå­˜å‚¨åœ¨ç±»mineçš„å­—å…¸__dict__ä¸­ï¼Œè¯¥è¯­å¥ä¹Ÿå¯ä»¥æ›¿æ¢æˆcls._instance=super(SingletonMetaCls,cls).__call__(*args,**kwargs)ï¼Œå³cls._instance=type.__call__(cls,*args,**kwargs)ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œtypeç±»çš„callæ–¹æ³•å†…éƒ¨å®ç°ä¹Ÿæ˜¯ï¼šo=cls.__new__(cls*args,**kwargs);return o.__init__(*args,**kwargs)</span></span><br><span class="line">        cls._instance.__init__(*args,**kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._instance</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>(<span class="params">metaclass=SingletonMetaCls</span>):</span></span><br><span class="line">    _instance=<span class="literal">None</span> <span class="comment">#è¯¥å€¼æ°¸è¿œä¹Ÿä¸ä¼šå˜ï¼Œä¹Ÿä¸èƒ½å˜</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mine</span>(<span class="params">Singleton</span>):</span> <span class="comment">#å¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šmetaclasså…³é”®å­—å‚æ•°æˆ–è€…__metaclass__ç±»å±æ€§ï¼Œåˆ™é»˜è®¤è®¾ç½®å½“å‰ç±»çš„å…ƒç±»ä¸ºç»§æ‰¿çš„ç¬¬ä¸€ä¸ªåŸºç±»çš„å…ƒç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name=<span class="string">&#x27;muggledy&#x27;</span></span>):</span></span><br><span class="line">        self.name=name</span><br><span class="line">    </span><br><span class="line">a=mine(<span class="string">&#x27;dy&#x27;</span>)</span><br><span class="line">b=mine(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">print(a <span class="keyword">is</span> b) <span class="comment">#True</span></span><br><span class="line">print(Singleton._instance)</span><br><span class="line">print(a.name) <span class="comment">#hello</span></span><br></pre></td></tr></table></figure></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></div><p>æœªå®Œå¾…ç»­â€¦</p><div class="tip fas fa-quote-left"><p>[1] <a href="https://pan.baidu.com/s/17r__wNMxIXTMWhglf3wyuw" rel="external nofollow noreferrer" title="å¯†ç ï¼š1y2r" target="_blank"><span style="color:red">Pythonå‚è€ƒæ‰‹å†Œ</span> ç¬¬4ç‰ˆ ä¿®è®¢ç‰ˆ [ç¾] å¤§å«Â·M.æ¯”å…¹åˆ©ï¼ˆDavid M.Beazleyï¼‰è‘—ï¼Œè°¢ä¿Šï¼Œæ¨è¶Šï¼Œé«˜ä¼Ÿ è¯‘</a><br>[2] <a href="https://segmentfault.com/a/1190000009157792" rel="external nofollow noreferrer" target="_blank">ç»‘å®šæ–¹æ³•ä¸éç»‘å®šæ–¹æ³•</a></p></div></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹</h></span></div><div class="post-copyright__type"><span class="post-copyright-info" id="post-copyright-url"><a href="https://muggledy.top/posts/22901/">https://muggledy.top/posts/22901/</a></span><span>&nbsp;&nbsp;</span><span class="cursorpointer" id="post-url-copyer" onclick="copy_post_url()"><i class="fas fa-paste copy-button"></i></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>Muggledy</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2021-05-01</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2021-05-05</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener external nofollow noreferrer" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener external nofollow noreferrer" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div><div class="post-copyright__note"><span class="post-copyright-info"><h>è½¬è½½æˆ–å€Ÿé‰´è¯·æ³¨æ˜åšå®¢æ¥æºå™¢ï¼</h></span></div></div><script>function copy_post_url(){event.stopPropagation();var e=document.getElementById("post-copyright-url");window.getSelection().selectAllChildren(e),document.execCommand("Copy")}</script><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/09/16/tdDuVfFBgy5bGpr.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-bookmark fa-fw"></i> <span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/176/" title="ä»‹ç»pythonç¨‹åºç»“æ„ä¸æ§åˆ¶æµï¼ŒåŒæ—¶ä¸ºäº†æ›´å¥½åœ°å®ç°æ¨¡å—åŒ–ï¼Œä¼šå°†å®ç°æŒ‡å®šåŠŸèƒ½çš„ç¨‹
åºå°è£…ä¸ºå‡½æ•°..."><img class="cover" src="https://i.loli.net/2021/09/16/CUqYkM2uKDbw69v.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-27</div><div class="title">PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹</div></div></a></div><div><a href="/posts/5311/" title="Pythonç¨‹åºä¸­ä¿å­˜çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯å›´ç»•å¯¹è±¡è¿™ä¸€æ¦‚å¿µæ¥æ„å»ºçš„ï¼Œå¯¹è±¡åŒ…æ‹¬ä¸€äº›åŸºæœ¬çš„
æ•°æ®ç±»å‹ï¼Œå¦‚æ•°å­—ã€å­—ç¬¦ä¸²ã€åˆ—è¡¨å’Œå­—å…¸ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç±»çš„å½¢å¼åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰çš„å¯¹è±¡..
."><img class="cover" src="https://cdn.jsdelivr.net/gh/celestezj/Mirror1ImageHosting/img/zjandxiong.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-24</div><div class="title">PythonåŸºç¡€ - ç±»å‹å’Œå¯¹è±¡</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.1/img/20210202152223.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/img/20210328224511.gif"' alt="avatar"><div class="author-info__name">Muggledy</div><div class="author-info__description">å­¤ç­é‡æ´‹</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">3</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/muggledy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/muggledy" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210209044239.jpg" rel="external nofollow noreferrer" target="_blank" title="WeChat"><i class="fab fa-weixin"></i></a><a class="social-icon" href="mailto:zgjsycfndy2015@163.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=3101266674&amp;site=qq&amp;menu=yes" rel="external nofollow noreferrer" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><a href="/note/"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></a><div class="announcement_content">æœ¬äººçš„æ›´æ–°æ˜¯ææ…¢çš„~</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB"><span class="toc-number">1.</span> <span class="toc-text">ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">2.</span> <span class="toc-text">å±æ€§è®¿é—®æ§åˆ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">è®¾è®¡æ¨¡å¼</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/35908/" title="Pytorchå…¥é—¨æ•™ç¨‹"><img src="https://i.loli.net/2021/09/16/LvWYXSJzkF53TB6.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/img/20210328224519.jpg"' alt="Pytorchå…¥é—¨æ•™ç¨‹"></a><div class="content"><a class="title" href="/posts/35908/" title="Pytorchå…¥é—¨æ•™ç¨‹">Pytorchå…¥é—¨æ•™ç¨‹</a><time datetime="2021-06-08T01:39:12.000Z" title="å‘è¡¨äº 2021-06-08 09:39:12">2021-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/22901/" title="PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹"><img src="https://i.loli.net/2021/09/16/tdDuVfFBgy5bGpr.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/img/20210328224519.jpg"' alt="PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹"></a><div class="content"><a class="title" href="/posts/22901/" title="PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹">PythonåŸºç¡€ - é¢å‘å¯¹è±¡ç¼–ç¨‹</a><time datetime="2021-05-01T13:05:41.000Z" title="å‘è¡¨äº 2021-05-01 21:05:41">2021-05-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/176/" title="PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹"><img src="https://i.loli.net/2021/09/16/CUqYkM2uKDbw69v.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/img/20210328224519.jpg"' alt="PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹"></a><div class="content"><a class="title" href="/posts/176/" title="PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹">PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹</a><time datetime="2021-04-27T03:45:30.000Z" title="å‘è¡¨äº 2021-04-27 11:45:30">2021-04-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5311/" title="PythonåŸºç¡€ - ç±»å‹å’Œå¯¹è±¡"><img src="https://cdn.jsdelivr.net/gh/celestezj/Mirror1ImageHosting/img/zjandxiong.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/img/20210328224519.jpg"' alt="PythonåŸºç¡€ - ç±»å‹å’Œå¯¹è±¡"></a><div class="content"><a class="title" href="/posts/5311/" title="PythonåŸºç¡€ - ç±»å‹å’Œå¯¹è±¡">PythonåŸºç¡€ - ç±»å‹å’Œå¯¹è±¡</a><time datetime="2021-04-24T12:55:45.000Z" title="å‘è¡¨äº 2021-04-24 20:55:45">2021-04-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/65257/" title="Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•"><img src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210328214628.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@latest/img/20210328224519.jpg"' alt="Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•"></a><div class="content"><a class="title" href="/posts/65257/" title="Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•">Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•</a><time datetime="2021-03-25T07:53:40.000Z" title="å‘è¡¨äº 2021-03-25 15:53:40">2021-03-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright"><span>&copy;2021</span><span class="onespace">&nbsp;</span><svg style="width:1.5em;height:1.5em" aria-hidden="true"><use xlink:href="#icon-butterfly1"></use></svg><span>By Muggledy</span></div><div class="footer_custom_text"><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/zh-cn/"><img src="https://img.shields.io/badge/Frame-Hexo-blue"></a>&nbsp;&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-brightgreen"></a>&nbsp;&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://pages.github.com/"><img src="https://img.shields.io/badge/Hosted-Github-red"></a>&nbsp;&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsdelivr-blueviolet"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v4.2/js/search/local-search.js"></script><div class="js-pjax"><script>document.getElementsByClassName("mermaid").length&&(window.mermaidJsLoad?mermaid.init():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(()=>{window.mermaidJsLoad=!0,mermaid.initialize({theme:"default"}),mermaid.init()}))</script><script>function loadValine(){function e(){new Valine(Object.assign({el:"#vcomment",appId:"b7x9hYzkDTy4reR4khezoDcf-gzGzoHsz",appKey:"ReeSRhiVzefUKIsJwSvUD6qV",placeholder:"å¿«æ¥è¯„è®ºå§(è¯·æ³¨æ„â€œæœ€æ–°è¯„è®ºâ€åªå…³è”äº†Gitalkè¯„è®ºç³»ç»Ÿå“¦)~",avatar:"monsterid",meta:"nick,mail,link".split(","),pageSize:"10",lang:"zh-CN",recordIP:!1,serverURLs:"",emojiCDN:"",emojiMaps:"",enableQQ:!0,path:window.location.pathname,requiredFields:["nick,mail"],visitor:!1,master:"5f452633ebd48518f8778c240d946335".split(","),friends:"a483c79213701a5644bec62de88f974d,34c64a0cb78287b2ae889cda5d9d2a91,574fbd33aa74a09d671f4608af20fd2b".split(",")},null))}"function"==typeof Valine?e():getScript("https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js").then(e)}{function loadOtherComment(){loadValine()}setTimeout(loadValine,0)}</script><script>function addGitalkSource(){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css",document.getElementsByTagName("head")[0].appendChild(e)}function loadGitalk(){function e(){new Gitalk(Object.assign({clientID:"05956758b57064d95a57",clientSecret:"3c4ddd74e671e3d79aac8417e708f69ff93b3e28",repo:"muggledy.github.io",owner:"muggledy",admin:["muggledy"],id:"3fad989e9b1adf5b0e4f07ef9f71a015",language:"zh-CN",perPage:10,distractionFreeMode:!1,pagerDirection:"last",createIssueManually:!1,updateCountCallback:commentCount},null)).render("gitalk-container")}"function"==typeof Gitalk?e():(addGitalkSource(),getScript("https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js").then(e))}function commentCount(e){let t=document.querySelector("#post-meta .gitalk-comment-count");t&&(t.innerHTML=e)}{function loadOtherComment(){loadGitalk()}loadGitalk()}</script></div><script>window.addEventListener("load",()=>{const e=()=>{fetch("https://api.github.com/repos/muggledy/muggledy.github.io/issues/comments?sort=updated&direction=desc&per_page=6&page=1",{headers:{Accept:"application/vnd.github.v3.html+json"}}).then(e=>e.json()).then(e=>{(e=>{let a="";Promise.all(e.map(e=>fetch(e.url).then(e=>e.json()).then(e=>"utterances-bot"===e.user.login?(a=e.body.match(/https?\:\/\/[^\" ]+/gi).slice(-1),a[0]):(a=e.body.match(/https?\:\/\/[^\" ]+/i),a[0])))).then(a=>{e=e.map((e,t)=>({...e,url:a[t]})),saveToLocal.set("github-newest-comments",JSON.stringify(e),5/1440),t(e)})})(e.map(e=>{return{avatar:e.user.avatar_url,content:(t=e.body_html,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[å›¾ç‰‡]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[é“¾æ¥]")).replace(/<pre><code>.*?<\/pre>/gi,"[ä»£ç ]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),nick:e.user.login,url:e.issue_url,date:e.updated_at,githubUrl:e.html_url};var t}))}).catch(e=>{document.querySelector("#card-newest-comments .aside-list").innerHTML="æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®ä»¥åŠç½‘ç»œæ˜¯å¦é€šç•…"})},t=e=>{let t="";if(e.length)for(let a=0;a<e.length;a++){t+="<div class='aside-list-item'>";{const n="src";t+=`<a href='${e[a].url}' class='thumbnail'><img ${n}='${e[a].avatar}' alt='${e[a].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[a].url}'>${e[a].content}</a>\n        <div class='name'><span>${e[a].nick} / </span><time datetime="${e[a].date}">${btf.diffDate(e[a].date,!0)}</time></div>\n        </div></div>`}else t+="æ²¡æœ‰è¯„è®º";let a=document.querySelector("#card-newest-comments .aside-list");a.innerHTML=t,window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(a)},a=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const a=saveToLocal.get("github-newest-comments");a?t(JSON.parse(a)):e()}};a(),document.addEventListener("pjax:complete",a)})</script><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/t_chart.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/funny_title/funny-title-js.js"></script><script async src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/font_animal/font_animal.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/cal_rs.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/visitors_map/vis_m.js"></script><script async src="https://at.alicdn.com/t/font_2494703_el3qb7r0dxv.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#web_bg","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:complete",(function(){void 0!==window.ifExe_addHighlightTool&&(window.ifExe_addHighlightTool=!0),void 0!==window.ifExe_clickFnOfTagHide&&(window.ifExe_clickFnOfTagHide=!0),void 0!==window.ifExe_addTableWrap&&(window.ifExe_addTableWrap=!0),void 0!==window.ifExe_addPhotoFigcaption&&(window.ifExe_addPhotoFigcaption=!0),void 0!==window.ifExe_jqLoadAndRun_jg&&(window.ifExe_jqLoadAndRun_jg=!0),void 0!==window.ifExe_jqLoadAndRun_fb&&(window.ifExe_jqLoadAndRun_fb=!0),window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:send",(function(){if("object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>function dogo(){var o,s="/posts/17177/,/posts/65257/,/posts/35908/,/posts/176/,/posts/22901/,/posts/5311/";for(s=s.split(",");s[o=Math.floor(Math.random()*s.length)]==getRelativeUrl(););pjax.loadUrl(s[o])}</script><div class="dyminimenu"><ul><li onclick="wll_menu(1)"><span>ğŸ“ æ·»åŠ miniä¾¿ç­¾</span></li><li onclick="wll_menu(2)"><span>ğŸ†‘ æ¸…ç©ºå½“å‰é¡µé¢</span></li></ul></div><script data-pjax>function history_calendar_injector_config(){var i=document.getElementsByClassName("sticky_layout")[0];console.log("å·²æŒ‚è½½history_calendar"),i.insertAdjacentHTML("afterbegin",'<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>é‚£å¹´ä»Šæ—¥</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>')}document.getElementsByClassName("sticky_layout")[0]&&"/"===location.pathname&&history_calendar_injector_config()</script><script data-pjax src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script></body><script>document.addEventListener("touchmove",(function(e){e.preventDefault()}),!1)</script><script async data-pjax>IsPC()&&btf.isJqueryLoad(image_preview_wrapper),btf.isJqueryLoad(dybubblefn)</script></html>