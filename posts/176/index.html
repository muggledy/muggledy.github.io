<!DOCTYPE html><html class="hide-aside" lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹ | Muggledy's Blog</title><meta name="robots" content="noindex"><meta name="author" content="Muggledy"><meta name="copyright" content="Muggledy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ğŸ“š æ–‡æ¡£ç›®å½• ğŸƒ ç±»å‹å’Œå¯¹è±¡ - ğŸˆ ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹ - ğŸ é¢å‘å¯¹è±¡ç¼–ç¨‹  ç¨‹åºç»“æ„ä¸æ‰§è¡Œ Pythonç¨‹åºç”±ä¸€äº›è¯­å¥åºåˆ—ç»„æˆï¼Œè¿™äº›è¯­å¥åŒ…æ‹¬å˜é‡èµ‹å€¼ã€å‡½æ•°å®šä¹‰ã€ç±»å’Œæ¨¡å—å¯¼å…¥ç­‰ï¼ŒåŠ è½½æºæ–‡ä»¶æ—¶ï¼Œè§£é‡Šå™¨å§‹ç»ˆé¡ºåºæ‰§è¡Œæ¯æ¡è¯­å¥ï¼Œç›´åˆ°å†æ— è¯­å¥å¯ä»¥æ‰§è¡Œï¼Œè¿™ç§æ‰§è¡Œæ¨¡å¼åŒæ ·é€‚ç”¨äºä½œä¸ºä¸»ç¨‹åºè¿è¡Œçš„æ–‡ä»¶å’Œé€šè¿‡importåŠ è½½çš„åº“æ–‡ä»¶ æ¡ä»¶è¯­å¥å¾ªç¯ä¸è¿­ä»£å¼‚å¸¸ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ–­è¨€æ¡ä»¶è¯­å¥å¯ç”±ifä»¥åŠå¯çœçš„elif"><meta property="og:type" content="article"><meta property="og:title" content="PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹"><meta property="og:url" content="https://muggledy.github.io/posts/176/index.html"><meta property="og:site_name" content="Muggledy&#39;s Blog"><meta property="og:description" content="ğŸ“š æ–‡æ¡£ç›®å½• ğŸƒ ç±»å‹å’Œå¯¹è±¡ - ğŸˆ ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹ - ğŸ é¢å‘å¯¹è±¡ç¼–ç¨‹  ç¨‹åºç»“æ„ä¸æ‰§è¡Œ Pythonç¨‹åºç”±ä¸€äº›è¯­å¥åºåˆ—ç»„æˆï¼Œè¿™äº›è¯­å¥åŒ…æ‹¬å˜é‡èµ‹å€¼ã€å‡½æ•°å®šä¹‰ã€ç±»å’Œæ¨¡å—å¯¼å…¥ç­‰ï¼ŒåŠ è½½æºæ–‡ä»¶æ—¶ï¼Œè§£é‡Šå™¨å§‹ç»ˆé¡ºåºæ‰§è¡Œæ¯æ¡è¯­å¥ï¼Œç›´åˆ°å†æ— è¯­å¥å¯ä»¥æ‰§è¡Œï¼Œè¿™ç§æ‰§è¡Œæ¨¡å¼åŒæ ·é€‚ç”¨äºä½œä¸ºä¸»ç¨‹åºè¿è¡Œçš„æ–‡ä»¶å’Œé€šè¿‡importåŠ è½½çš„åº“æ–‡ä»¶ æ¡ä»¶è¯­å¥å¾ªç¯ä¸è¿­ä»£å¼‚å¸¸ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ–­è¨€æ¡ä»¶è¯­å¥å¯ç”±ifä»¥åŠå¯çœçš„elif"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v2.1/compress/13.jpg"><meta property="article:published_time" content="2021-04-25T12:55:45.000Z"><meta property="article:modified_time" content="2021-05-24T07:30:13.858Z"><meta property="article:author" content="Muggledy"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v2.1/compress/13.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210207091812.png"><link rel="canonical" href="https://muggledy.github.io/posts/176/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.9/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç°¡"},noticeOutdate:{limitDay:500,position:"top",messagePrev:"è¿™ç¯‡æ–‡ç« å·²ç»å‘è¡¨äº†",messageNext:"å¤©äº†ï¼Œå…¶ä¸­æŸäº›å†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ã€‚"},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"å¤©",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:{limitCount:50,languages:{author:"ä½œè€…: Muggledy",link:"é“¾æ¥: ",source:"æ¥æº: Muggledy's Blog",info:"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},lightbox:"fancybox",Snackbar:void 0,source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isanchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!0,isToc:!0,postUpdate:"2021-05-24 15:30:13"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,n={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(n))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const a=saveToLocal.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"))})(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.9/css/mystyle.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/font_awesome/font-awesome-animation.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/button/buttons.min.css"><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.2/data/katong_font/katong-font.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.9/data/img_preview/article_img_preview.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v1.0/data/bubble/bubble.js"></script><script src="https://cdn.staticfile.org/moment.js/2.24.0/moment.js"></script><script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/is_pc/is-pc.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Muggledy's Blog" type="application/atom+xml"></head><div class="dyminibox"></div><body><div class="dy-show-cbg" id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.1/img/20210202152223.jpg" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210328224511.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">2</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">1</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-book"></i> <span>æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i> <span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-folder-open faa-tada"></i> <span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart card-announcement-animation"></i> <span>å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/note/"><i class="fa-fw fas fa-bullhorn"></i> <span>å…¬ç¤º</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>æ›´å¤š</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><i class="fa-fw fas fa-image faa-tada"></i> <span>å›¾å†Œ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="fa-fw fas fa-video faa-tada"></i> <span>ç”µå½±</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v2.1/compress/13.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Muggledy's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw faa-wrench animated"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-book"></i> <span>æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i> <span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-folder-open faa-tada"></i> <span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart card-announcement-animation"></i> <span>å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/note/"><i class="fa-fw fas fa-bullhorn"></i> <span>å…¬ç¤º</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>æ›´å¤š</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><i class="fa-fw fas fa-image faa-tada"></i> <span>å›¾å†Œ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="fa-fw fas fa-video faa-tada"></i> <span>ç”µå½±</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-04-25T12:55:45.000Z" title="å‘è¡¨äº 2021-04-25 20:55:45">2021-04-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-05-24T07:30:13.858Z" title="æ›´æ–°äº 2021-05-24 15:30:13">2021-05-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">14.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>55åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="PythonåŸºç¡€ - ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/posts/176/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/posts/176/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div class="note green icon flat"><i class="note-icon fas fa-rocket"></i><p>ğŸ“š æ–‡æ¡£ç›®å½•<br>ğŸƒ <a href="/posts/5311/"><span style="color:#3a96dd">ç±»å‹å’Œå¯¹è±¡</span></a> - ğŸˆ ç¨‹åºç»“æ„ä¸å‡½æ•°ç¼–ç¨‹ - ğŸ <a href="/posts/22901/"><span style="color:#3a96dd">é¢å‘å¯¹è±¡ç¼–ç¨‹</span></a></p></div><h2 id="ç¨‹åºç»“æ„ä¸æ‰§è¡Œ">ç¨‹åºç»“æ„ä¸æ‰§è¡Œ</h2><p>Pythonç¨‹åºç”±ä¸€äº›è¯­å¥åºåˆ—ç»„æˆï¼Œè¿™äº›è¯­å¥åŒ…æ‹¬å˜é‡èµ‹å€¼ã€å‡½æ•°å®šä¹‰ã€ç±»å’Œæ¨¡å—å¯¼å…¥ç­‰ï¼ŒåŠ è½½æºæ–‡ä»¶æ—¶ï¼Œè§£é‡Šå™¨å§‹ç»ˆé¡ºåºæ‰§è¡Œæ¯æ¡è¯­å¥ï¼Œç›´åˆ°å†æ— è¯­å¥å¯ä»¥æ‰§è¡Œï¼Œè¿™ç§æ‰§è¡Œæ¨¡å¼åŒæ ·é€‚ç”¨äºä½œä¸ºä¸»ç¨‹åºè¿è¡Œçš„æ–‡ä»¶å’Œé€šè¿‡<code>import</code>åŠ è½½çš„åº“æ–‡ä»¶</p><div class="tabs" id="py2-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#py2-1-1">æ¡ä»¶è¯­å¥</button></li><li class="tab"><button type="button" data-href="#py2-1-2">å¾ªç¯ä¸è¿­ä»£</button></li><li class="tab"><button type="button" data-href="#py2-1-3">å¼‚å¸¸</button></li><li class="tab"><button type="button" data-href="#py2-1-4">ä¸Šä¸‹æ–‡ç®¡ç†å™¨</button></li><li class="tab"><button type="button" data-href="#py2-1-5">æ–­è¨€</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="py2-1-1"><p>æ¡ä»¶è¯­å¥å¯ç”±<code>if</code>ä»¥åŠå¯çœçš„<code>elif</code>ã€<code>else</code>å­å¥æ„æˆ</p><p>åœ¨ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­å­˜åœ¨<code>switch</code>è¯­å¥ï¼Œè­¬å¦‚Cè¯­è¨€ä¸­å®ç°æˆç»©ç­‰çº§åˆ¤æ–­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> a;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Input your score:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">  <span class="keyword">switch</span>(a/<span class="number">10</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">9</span>: <span class="built_in">printf</span>(<span class="string">&quot;\nA&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">8</span>: <span class="built_in">printf</span>(<span class="string">&quot;\nB&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>: <span class="built_in">printf</span>(<span class="string">&quot;\nC&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="built_in">printf</span>(<span class="string">&quot;\nD&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Pythonä¸­æ²¡æœ‰<code>switch</code>å…³é”®å­—ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ›¿ä»£<a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.zzvips.com/article/117299.html">å®ç°</a>ï¼š</p><ol><li>åˆ©ç”¨å­—å…¸å®ç°ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">switch=&#123;</span><br><span class="line">    <span class="number">10</span>: <span class="string">&#x27;A&#x27;</span>, <span class="comment">#æ­¤å¤„éœ€é‡å¤å®šä¹‰å†…å®¹</span></span><br><span class="line">     <span class="number">9</span>: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">     <span class="number">8</span>: <span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">     <span class="number">7</span>: <span class="string">&#x27;C&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a=<span class="built_in">input</span>(<span class="string">&#x27;Input your score:&#x27;</span>)</span><br><span class="line">print(switch.get(<span class="built_in">int</span>(<span class="built_in">int</span>(a)/<span class="number">10</span>),<span class="string">&#x27;D&#x27;</span>))</span><br></pre></td></tr></table></figure></li><li>åˆ›å»ºä¸€ä¸ª<code>switch</code>ç±»æ¥å¤„ç†ç¨‹åºçš„æµè½¬ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">switch</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,value</span>):</span></span><br><span class="line">        self.value=value</span><br><span class="line">        self.fall=<span class="literal">False</span> <span class="comment">#å¦‚æœcaseåŒ¹é…ï¼Œä¸”æ²¡æœ‰breakï¼Œåˆ™ç½®ä¸ºTrueï¼Œè¡¨ç¤ºç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œä¸”ä¸è®ºä¸‹é¢çš„caseæ˜¯å¦åŒ¹é…</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">yield</span> self.match <span class="comment">#ç”±äºyieldå…³é”®å­—ï¼Œ__iter__æ–¹æ³•å˜æˆä¸€ä¸ªç”Ÿæˆå™¨æ–¹æ³•ï¼Œå½“è°ƒç”¨è¯¥æ–¹æ³•æ—¶å°†è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼Œè€Œç”Ÿæˆå™¨åˆæ˜¯è¿­ä»£å™¨ï¼Œå› æ­¤switchæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">match</span>(<span class="params">self,*args</span>):</span> <span class="comment">#argsåªå…è®¸æ¥æ”¶0æˆ–1ä¸ªå‚æ•°</span></span><br><span class="line">        <span class="keyword">if</span> self.fall <span class="keyword">or</span> <span class="keyword">not</span> args: <span class="comment">#å¦‚æœfallä¸ºTrueï¼Œåˆ™è¿”å›Trueè¡¨ç¤ºç»§ç»­æ‰§è¡Œå½“å‰çš„caseå­å¥ï¼Œæˆ–å½“å‰caseå­å¥æ²¡æœ‰åŒ¹é…å‚æ•°ï¼Œåˆ™è¡¨ç¤ºä¸ºdefaulté»˜è®¤åˆ†æ”¯ï¼ˆè¯·å°†defaultæ”¾åœ¨æœ€åä¸€è¡Œï¼Œä½†å¹¶æ— ä»£ç ä¸¥æ ¼æ£€æŸ¥ï¼Œæ­¤ä»£ç ä»…ä¸ºdemoå±•ç¤ºï¼‰</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">elif</span> args[<span class="number">0</span>]==self.value: <span class="comment">#åŒ¹é…æˆåŠŸ</span></span><br><span class="line">            self.fall=<span class="literal">True</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>: <span class="comment">#åŒ¹é…å¤±è´¥</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">score=<span class="number">96</span></span><br><span class="line"><span class="keyword">for</span> case <span class="keyword">in</span> switch(score//<span class="number">10</span>): <span class="comment">#è¿™ä¸ªforåªè¿­ä»£ä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">if</span> case(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">if</span> case(<span class="number">9</span>):</span><br><span class="line">        print(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> case(<span class="number">8</span>):</span><br><span class="line">        print(<span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> case(<span class="number">7</span>):</span><br><span class="line">        print(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> case(): <span class="comment">#defaultåˆ†æ”¯</span></span><br><span class="line">        print(<span class="string">&#x27;D&#x27;</span>)</span><br></pre></td></tr></table></figure></li></ol><p>ä¸è¿‡å®åœ¨æ²¡å¿…è¦ï¼Œç‰¹åˆ«æ˜¯ä¸Šè¿°ç¬¬äºŒç§æ–¹å¼ï¼Œè¿‡äºè¯ä¸è¾¾æ„ï¼Œè¿™ç§<code>for</code>å¾ªç¯çš„å†™æ³•å°±å¾ˆè¿·ï¼Œä½†æ˜¯å¥½åƒä¹Ÿæ‰¾ä¸åˆ°æ›´å¥½çš„å†™æ³•</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-1-2"><p>å¯ä»¥ä½¿ç”¨<code>while</code>ï¼ˆæ»¡è¶³æ¡ä»¶æ—¶ä¸æ–­å¾ªç¯ç›´è‡³æ¡ä»¶ä¸å†æ»¡è¶³ï¼‰æˆ–<code>for</code>ï¼ˆéå†å¯è¿­ä»£å¯¹è±¡ï¼‰å®ç°å¾ªç¯ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨<code>for</code>å¾ªç¯ï¼Œå¦‚æœæƒ³åœ¨è¿­ä»£è¿‡ç¨‹ä¸­åŒæ—¶è·å–ä¸‹æ ‡ç´¢å¼•ï¼Œå¯ä»¥å°†å¯è¿­ä»£å¯¹è±¡<code>iterable</code>æ›¿æ¢æˆ<code>enumerate(iterable)</code>ï¼Œå…¶ç­‰åŒäº<code>zip(range(len(iterable)),iterable)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">10</span></span><br><span class="line"><span class="keyword">while</span> (a&gt;<span class="number">0</span>): <span class="comment">#while expressionç­‰åŒäºwhile(expression)ï¼Œå³åŠ ä¸åŠ æ‹¬å·éƒ½ä¸€æ ·ï¼Œexpressionè¡¨è¾¾å¼æ‰€å¾—ä¹Ÿæ˜¯ä¸€ä¸ªpythonå¯¹è±¡å˜›ï¼Œè€Œ(obj)å°±å¹¶æœªå˜æˆä¸€ä¸ªå…ƒç»„å¯¹è±¡ï¼Œå®ƒä»æ˜¯objå¯¹è±¡æœ¬èº«ï¼Œæœ‰obj is (obj)æˆç«‹ï¼Œé™¤éå†™æˆ(obj,)ï¼Œè¿™æ‰å˜æˆäº†ä¸€ä¸ªé•¿åº¦ä¸º1çš„å…ƒç»„å¯¹è±¡ã€‚æ‹¬å·å¸¸ç”¨äºè¡¨è¾¾å¼ä¸­ï¼Œç”¨äºç•Œå®šä¸åŒè¿ç®—çš„ä¼˜å…ˆçº§åˆ«ï¼Œæœ€å†…å±‚çš„æ‹¬å·ä¸­çš„å­è¡¨è¾¾å¼æœ€å…ˆè¿ç®—ï¼Œè­¬å¦‚ï¼š((a+b)*c)-2</span></span><br><span class="line">    a-=<span class="number">1</span></span><br><span class="line">    print(a)</span><br><span class="line">print() <span class="comment">#è¾“å‡ºä¸€ä¸ªç©ºè¡Œ</span></span><br><span class="line"></span><br><span class="line">i=<span class="number">888</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    print(i)</span><br><span class="line">print(<span class="string">f&#x27;i:<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="comment">#æ³¨æ„è¾“å‡ºçš„æ˜¯i:9ï¼Œå› ä¸ºè¿­ä»£å˜é‡ï¼ˆiï¼‰çš„ä½œç”¨åŸŸå¹¶éforè¯­å¥ç§æœ‰ï¼Œå³å¦‚æœå‰é¢å·²ç»å®šä¹‰è¿‡ä¸€ä¸ªç›¸åŒåç§°çš„å˜é‡ï¼Œå®ƒçš„å€¼å°†è¢«æ”¹å†™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿­ä»£è¿‡ç¨‹ä¸­åŒæ—¶è·å–ä¸‹æ ‡ç´¢å¼•</span></span><br><span class="line">a=<span class="string">&#x27;muggledy&#x27;</span></span><br><span class="line"><span class="keyword">for</span> index,element <span class="keyword">in</span> <span class="built_in">enumerate</span>(a):</span><br><span class="line">    print(index,element)</span><br></pre></td></tr></table></figure><p>æ³¨ï¼ˆ<code>for-else</code>è¯­å¥ï¼‰ï¼š<code>else</code>è¯­å¥ä¼šåœ¨<code>for</code>å¾ªç¯ç»“æŸä¹‹åæ‰§è¡Œï¼Œé™¤éå¾ªç¯è¿‡ç¨‹ä¸­é‡åˆ°<code>break</code>ï¼ˆæˆ–è€…é‡åˆ°å…¶ä»–æ„å¤–å¦‚æŠ›å‡ºå¼‚å¸¸ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šæ‰§è¡Œåˆ°<code>else</code>è¯­å¥ï¼‰ï¼Œç‰¹åˆ«åœ°ï¼Œå¦‚æœå¾ªç¯æ ¹æœ¬å°±æ²¡æœ‰å¼€å§‹ï¼ˆå¯è¿­ä»£åºåˆ—é•¿åº¦ä¸º0æ—¶ï¼‰ï¼Œä¹Ÿä¼šæ‰§è¡Œ<code>else</code>è¯­å¥ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œ<code>else</code>è¯­å¥å¯ä»¥ç”¨äºç¼–å†™å¾ªç¯æ­£å¸¸ç»“æŸæ—¶çš„æŸäº›åç»­æ“ä½œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;demo1: forå¾ªç¯å…¨éƒ¨éå†ç»“æŸ&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> []:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;demo2: forå¾ªç¯å…¨éƒ¨éå†ç»“æŸ&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;demo3: forå¾ªç¯å…¨éƒ¨éå†ç»“æŸ&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">demo1: forå¾ªç¯å…¨éƒ¨éå†ç»“æŸ</span></span><br><span class="line"><span class="string">demo2: forå¾ªç¯å…¨éƒ¨éå†ç»“æŸ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-1-3"><p>å¼‚å¸¸ä¼šä¸­æ–­æ­£å¸¸çš„ç¨‹åºæ‰§è¡Œæµï¼Œå¯ä»¥ä½¿ç”¨<code>raise exception([value])</code>æ¥æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼ˆ<code>exception</code>æ˜¯å¼‚å¸¸ç±»å‹ï¼Œå†…ç½®å¼‚å¸¸ç±»å‹è¯·æŸ¥é˜…æ–‡çŒ®[1]-p70ï¼Œ<code>value</code>æ˜¯ä¸€ä¸ªä¸æŒ‡å®šå¼‚å¸¸ç›¸å…³çš„å¯é€‰å‚æ•°ï¼Œé€šå¸¸æ˜¯ä¸€æ¡è‡ªå®šä¹‰çš„é”™è¯¯æ¶ˆæ¯ï¼Œå¦‚æœ<code>raise</code>è¯­å¥ä¸å¸¦ä»»ä½•å‚æ•°ï¼Œåˆ™å°†ä¼šé‡å¤å¼•å‘æœ€è¿‘ä¸€æ¬¡å‡ºç°çš„å¼‚å¸¸ï¼Œå¦‚æœæœ€è¿‘æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œåˆ™æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸<code>RuntimeError: No active exception to reraise</code>ï¼‰ï¼Œä½¿ç”¨<code>try-except</code>ï¼ˆèƒ½å¤ŸåµŒå¥—ä½¿ç”¨ï¼‰å¯ä»¥æ•æ‰å¼‚å¸¸ï¼Œ<code>except</code>è¯­å¥ä¸­ç”¨äºç¼–å†™å¼‚å¸¸å¤„ç†ç¨‹åºï¼Œå…¶è¿˜æœ‰ä¸€ä¸ªå¯é€‰çš„ä¿®é¥°ç¬¦<code>as var</code>ï¼Œå¯ä»¥å°†æ•æ‰åˆ°çš„å¼‚å¸¸å®ä¾‹èµ‹ç»™å˜é‡<code>var</code>ï¼Œå¦å¤–å¯ä»¥åœ¨ä¸€ä¸ª<code>try</code>å—åè·Ÿéšå¤šä¸ª<code>except</code>å—ä»¥æ•æ‰å¤šç§ä¸åŒç±»å‹çš„å¼‚å¸¸ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ª<code>except</code>ä¸­åŒæ—¶æ•æ‰ï¼Œè¿™æ—¶ä½ å¯ä»¥åœ¨<code>except</code>è¯­å¥å—å†…ä½¿ç”¨<code>isinstance</code>è¿›è¡Œå¼‚å¸¸ç±»å‹åˆ¤æ–­ï¼Œç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¤ºä¾‹1</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span></span><br><span class="line"><span class="keyword">except</span>: <span class="comment">#ä¸å¸¦ä»»ä½•å¼‚å¸¸ç±»å‹æ—¶å°†æ•æ‰æ‰€æœ‰å¼‚å¸¸ï¼Œä¹Ÿå¯ä»¥æ•æ‰æŒ‡å®šç±»å‹å¼‚å¸¸ï¼šexcept RuntimeError:</span></span><br><span class="line">    print(<span class="string">&#x27;å‡ºç°å¼‚å¸¸ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹2</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;è¿è¡Œé”™è¯¯å•¦ï¼&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e: <span class="comment">#å°†å¼‚å¸¸å®ä¾‹èµ‹å€¼ç»™å˜é‡eï¼ˆExceptionæ˜¯æ‰€æœ‰éé€€å‡ºå¼‚å¸¸ç±»å‹çš„åŸºç±»ï¼Œè¿™æ ·ä½ å°±å¯ä»¥æ•æ‰ä»»æ„æ´¾ç”Ÿè‡ªExceptionçš„å¼‚å¸¸ç±»å‹ï¼‰</span></span><br><span class="line">    print(<span class="string">&#x27;å¼‚å¸¸:&#x27;</span>,e)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#ç¤ºä¾‹3ï¼ˆç¤ºä¾‹3å’Œç¤ºä¾‹4éƒ½æ˜¯ä¸å¯æ‰§è¡Œçš„ä¼ªä»£ç ï¼‰</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    do something may cause IOError, TypeError <span class="keyword">or</span> NameError...</span><br><span class="line"><span class="keyword">except</span> IOError <span class="keyword">as</span> e:</span><br><span class="line">    process IOError...</span><br><span class="line"><span class="keyword">except</span> TypeError <span class="keyword">as</span> e:</span><br><span class="line">    process TypeError...</span><br><span class="line"><span class="keyword">except</span> NameError <span class="keyword">as</span> e:</span><br><span class="line">    process NameError...</span><br><span class="line">    </span><br><span class="line"><span class="comment">#ç¤ºä¾‹4ï¼ˆç¤ºä¾‹3çš„å¦ä¸€ç§å†™æ³•ï¼‰</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    do something may cause IOError, TypeError <span class="keyword">or</span> NameError...</span><br><span class="line"><span class="keyword">except</span> (IOError,TypeError,NameError) <span class="keyword">as</span> e: <span class="comment">#æ³¨æ„æ‹¬å·ä¸å¯çœç•¥</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(e,IOError):</span><br><span class="line">        process IOError...</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(e,TypeError):</span><br><span class="line">        process TypeError...</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">isinstance</span>(e,NameError):</span><br><span class="line">        process NameError...</span><br></pre></td></tr></table></figure><p><code>try-except</code>æ”¯æŒ<code>else</code>å­å¥ï¼ˆå¯çœï¼‰ï¼Œä½†å¿…é¡»è·Ÿéšåœ¨æœ€åä¸€ä¸ª<code>except</code>å­å¥åï¼Œå¦‚æœ<code>try</code>å—ä¸­çš„å†…å®¹å¹¶æœªå¼•å‘å¼‚å¸¸ï¼Œå°±ä¼šæ‰§è¡Œ<code>else</code>å­å¥ä¸­çš„ä»£ç ï¼ˆé™¤é<code>try</code>å—ç›´æ¥<code>return</code>è¿”å›äº†ï¼‰ã€‚<code>try-except</code>è¿˜æ”¯æŒ<code>finally</code>å­å¥ï¼ˆå¯çœï¼‰ï¼Œå…¶å¿…é¡»å†™åœ¨æœ€æœ€åï¼Œæ— è®º<code>try</code>æ˜¯å¦å‡ºç°å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ<code>finally</code>å—ä¸­çš„å†…å®¹ï¼ˆå³ä½¿åœ¨<code>try</code>å—ã€<code>except</code>å—æˆ–<code>else</code>å—ä¸­é‡åˆ°<code>return</code>ï¼Œä¹Ÿä¼šæ‰§è¡Œ<code>finally</code>å—ï¼‰ï¼Œä¸”åœ¨<code>except</code>æˆ–<code>else</code>ä¹‹åæ‰§è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    f=<span class="built_in">open</span>(<span class="string">&#x27;foo.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> IOError <span class="keyword">as</span> e:</span><br><span class="line">    print(<span class="string">f&#x27;Fail to open!(<span class="subst">&#123;e&#125;</span>)&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;Open successfully!&#x27;</span>)</span><br><span class="line"><span class="keyword">finally</span>: <span class="comment">#å¦‚æœæ–‡ä»¶æ‰“å¼€ï¼ˆfå­˜åœ¨ï¼‰åˆ™å…³é—­ä¹‹ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åš</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#å°ç»“ï¼štry-exceptæ˜¯åŸºæœ¬çš„å¼‚å¸¸æ•è·æµç¨‹ï¼Œelseå’Œfinallyåˆ™éƒ½æ˜¯å¯é€‰çš„ï¼Œä¸€èˆ¬çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼šé¦–å…ˆæ‰§è¡Œtryä¸­è¯­å¥ï¼Œå¦‚æœæ²¡æœ‰å¼‚å¸¸ï¼Œåˆ™è·³è½¬åˆ°elseå—ï¼Œæœ€åæ˜¯finallyå—ï¼›å¦‚æœtryå—ä¸­å­˜åœ¨å¼‚å¸¸ï¼Œåˆ™ç”±exceptæ•è·å¼‚å¸¸ï¼Œæœ€åè¿›å…¥finallyå—</span></span><br></pre></td></tr></table></figure><p>å…³äºå¼‚å¸¸æ•æ‰ä¸­<code>return</code>è¿”å›å€¼çš„é—®é¢˜ï¼Œè¯•æƒ³ï¼Œå¦‚æœ<code>try</code>å—ä¸­å­˜åœ¨<code>return</code>è¯­å¥ï¼Œé€šå¸¸æˆ‘ä»¬è®¤ä¸ºå‡½æ•°é‡åˆ°<code>return</code>ä¼šç«‹å³è¿”å›ï¼Œç¡®å®å¦‚æ­¤å—ï¼Ÿå¦‚æœå­˜åœ¨<code>finally</code>å—ï¼Œé‚£ä¹ˆå…¶ä¸­çš„ä»£ç è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿå…·ä½“çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#try-except-finallyç»“æ„</span></span><br><span class="line"><span class="comment">#ç¤ºä¾‹1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> a+<span class="number">1</span> <span class="comment">#é¦–å…ˆè®¡ç®—è¡¨è¾¾å¼a+1çš„å€¼ç„¶åä¿å­˜ä¸‹æ¥ï¼Œæš‚ä¸returnï¼Œè½¬è€Œæ‰§è¡Œfinallyå—ï¼Œï¼ˆç”±äºfinallyä¸­æ²¡æœ‰é‡åˆ°returnï¼Œäºæ˜¯ï¼‰ç»“æŸåä¼šå›åˆ°æ­¤å¤„ï¼Œreturnä¹‹å‰ä¿å­˜çš„è¡¨è¾¾å¼å€¼</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> a-<span class="number">1</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        a+=<span class="number">4</span></span><br><span class="line">        print(<span class="string">f&#x27;a=<span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">print(f(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">a=5</span></span><br><span class="line"><span class="string">2</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹2</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> a/<span class="number">0</span> <span class="comment">#å‡ºç°é™¤0å¼‚å¸¸ï¼Œæ˜¾ç„¶æ­¤returnæ°¸è¿œä¹Ÿä¸ä¼šæ‰§è¡Œï¼Œç›´æ¥è¿›å…¥exceptå—</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> a-<span class="number">1</span> <span class="comment">#è®¡ç®—è¡¨è¾¾å¼a-1çš„å€¼ï¼Œç„¶åå…ˆä¿å­˜ä¸‹æ¥ï¼Œç»§ç»­æ‰§è¡Œfinallyä¸­çš„ä»£ç ï¼Œï¼ˆç”±äºfinallyä¸­æ²¡æœ‰é‡åˆ°returnï¼Œäºæ˜¯ï¼‰ç»“æŸåå›åˆ°æ­¤å¤„ï¼Œreturnä¹‹å‰ä¿å­˜çš„è¡¨è¾¾å¼å€¼</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        a+=<span class="number">4</span></span><br><span class="line">        print(<span class="string">f&#x27;a=<span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">print(f(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">a=5</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹3</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> a+<span class="number">1</span> <span class="comment">#é¦–å…ˆè®¡ç®—è¡¨è¾¾å¼a+1çš„å€¼ç„¶åä¿å­˜ä¸‹æ¥ï¼Œæš‚ä¸returnï¼Œè½¬è€Œæ‰§è¡Œfinallyå—</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> a-<span class="number">1</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        a+=<span class="number">4</span></span><br><span class="line">        print(<span class="string">f&#x27;a=<span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> a <span class="comment">#åœ¨finallyä¸­é‡åˆ°returnï¼Œé‚£å°±ä¸ç®¡äº†ï¼Œå‡½æ•°ç›´æ¥è¿”å›ï¼ŒOVER</span></span><br><span class="line">        </span><br><span class="line">print(f(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">a=5</span></span><br><span class="line"><span class="string">5</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#try-except-else-finallyç»“æ„</span></span><br><span class="line"><span class="comment">#ç¤ºä¾‹4</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> a+<span class="number">1</span> <span class="comment">#é¦–å…ˆè®¡ç®—è¡¨è¾¾å¼a+1çš„å€¼ç„¶åä¿å­˜ä¸‹æ¥ï¼Œæš‚ä¸returnï¼Œä½†å› ä¸ºreturnçš„å­˜åœ¨ï¼Œè™½ç„¶æ²¡æœ‰å¼‚å¸¸ä¹Ÿä¸ä¼šæ‰§è¡Œelseå—ï¼Œä½†æ˜¯finallyå¿…é¡»æ‰§è¡Œï¼Œï¼ˆç”±äºfinallyä¸­æ²¡æœ‰é‡åˆ°returnï¼Œäºæ˜¯ï¼‰ç»“æŸåä»å›åˆ°æ­¤å¤„ï¼Œreturnä¹‹å‰ä¿å­˜ä¸‹æ¥çš„a+1çš„å€¼ï¼ŒOVER</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> a-<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> a+<span class="number">2</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        a+=<span class="number">4</span></span><br><span class="line">        print(<span class="string">f&#x27;a=<span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">print(f(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">a=5</span></span><br><span class="line"><span class="string">2</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹5</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a+<span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> a-<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> a+<span class="number">2</span> <span class="comment">#tryä¸­æ²¡æœ‰å¼‚å¸¸å’Œreturnï¼Œäºæ˜¯æ‰§è¡Œelseå—ï¼Œé¦–å…ˆä¿å­˜ä¸‹è¡¨è¾¾å¼a+2çš„å€¼ï¼Œç„¶åè¿›å…¥finallyï¼Œï¼ˆç”±äºfinallyä¸­æ²¡æœ‰é‡åˆ°returnï¼Œäºæ˜¯ï¼‰ç»“æŸåä»å›åˆ°æ­¤å¤„ï¼Œreturnä¹‹å‰ä¿å­˜ä¸‹æ¥çš„å€¼ï¼ŒOVER</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        a+=<span class="number">4</span></span><br><span class="line">        print(<span class="string">f&#x27;a=<span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">print(f(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">a=5</span></span><br><span class="line"><span class="string">3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹6</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a+<span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> a-<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> a+<span class="number">2</span> <span class="comment">#tryä¸­æ²¡æœ‰å¼‚å¸¸å’Œreturnï¼Œäºæ˜¯è·³è½¬åˆ°elseå—ï¼Œï¼ˆç”±äºfinallyçš„å­˜åœ¨ï¼‰é¦–å…ˆä¿å­˜ä¸‹è¡¨è¾¾å¼a+2çš„å€¼ï¼Œç„¶åè¿›å…¥finally</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        a+=<span class="number">4</span></span><br><span class="line">        print(<span class="string">f&#x27;a=<span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> a <span class="comment">#finallyä¸­æœ‰returnï¼Œäºæ˜¯ä¸ä¼šå†å›åˆ°elseå—ä¸­çš„returnä½ç½®å¤„ï¼Œæ­¤æ—¶å‡½æ•°ç›´æ¥è¿”å›ï¼ŒOVER</span></span><br><span class="line">        </span><br><span class="line">print(f(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">a=5</span></span><br><span class="line"><span class="string">5</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¦è‡ªå®šä¹‰å¼‚å¸¸ç±»å‹ï¼Œéœ€ç»§æ‰¿<code>Exception</code>åŸºç±»ï¼Œå¼•å‘å¼‚å¸¸æ—¶ä¼ é€’çš„å‚æ•°å³æ˜¯<code>__init__()</code>æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥é‡è½½<code>__str__()</code>æ–¹æ³•ï¼Œä»¥è‡ªå®šä¹‰å¼‚å¸¸è¾“å‡ºçš„é”™è¯¯æ¶ˆæ¯ï¼Œç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myException</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,*args</span>):</span> <span class="comment">#å¯ä»¥æ¥æ”¶nä¸ªï¼ˆä»»æ„ä¸ªï¼‰é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        self.args=args</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;myException: <span class="subst">&#123;<span class="string">&#x27;,&#x27;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> i:<span class="built_in">str</span>(i),self.args))&#125;</span>&quot;</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> myException(<span class="string">&#x27;é”™è¯¯ä¿¡æ¯1&#x27;</span>,<span class="string">&#x27;é”™è¯¯ä¿¡æ¯2&#x27;</span>,<span class="number">8848</span>)</span><br><span class="line"><span class="keyword">except</span> myException <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-1-4"><p>æ­£ç¡®åœ°ç®¡ç†å„ç§èµ„æºï¼ˆå¦‚æ–‡ä»¶å¥æŸ„çš„è·å–ä¸å…³é—­ã€äº’æ–¥é”çš„è·å–ä¸é‡Šæ”¾å’Œæ•°æ®åº“çš„è¿æ¥ä¸æ–­å¼€ç­‰ï¼‰ï¼Œåœ¨æ¶‰åŠå¼‚å¸¸æ—¶é€šå¸¸éƒ½æ¯”è¾ƒæ£˜æ‰‹ï¼Œå¼‚å¸¸çš„å¼•å‘å¾ˆå¯èƒ½å¯¼è‡´æ§åˆ¶æµè·³è¿‡è´Ÿè´£é‡Šæ”¾æŸäº›å…³é”®èµ„æºçš„è¯­å¥ï¼Œ<code>with</code>è¯­å¥æ”¯æŒåœ¨ç”±ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡æ§åˆ¶çš„è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä¸€ç³»åˆ—è¯­å¥ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»¥ä¸‹æ˜¯ä¸å¯æ‰§è¡Œçš„ä¼ªä»£ç ï¼ˆæ­¤ç§å†™æ³•å¯ä»¥ç¡®ä¿æ–‡ä»¶èµ„æºè¢«å®‰å…¨é‡Šæ”¾ï¼‰</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;debuglog.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&#x27;Debugging\n&#x27;</span>)</span><br><span class="line">    ...</span><br><span class="line">    f.write(<span class="string">&#x27;Done\n&#x27;</span>)</span><br><span class="line"><span class="comment">#åœ¨æ§åˆ¶æµç¦»å¼€withè¯­å¥å—æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œæ–‡ä»¶å…³é—­çš„æ“ä½œï¼Œä¸è®ºwithè¯­å¥å—ä¸­æ˜¯å¦å¼•å‘å¼‚å¸¸</span></span><br></pre></td></tr></table></figure><p><code>with obj</code>è¯­å¥åœ¨æ§åˆ¶æµè¿›å…¥å’Œç¦»å¼€å…¶åçš„ç›¸å…³ä»£ç å—æ—¶ï¼Œå…è®¸ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼‰å¯¹è±¡<code>obj</code>ç®¡ç†æ‰€å‘ç”Ÿçš„çš„äº‹æƒ…ï¼Œæ‰§è¡Œ<code>with obj</code>è¯­å¥æ—¶ï¼Œå°†æ‰§è¡Œ<code>obj.__enter__()</code>æ¥æŒ‡ç¤ºè¿›å…¥ä¸€ä¸ªæ–°çš„ä¸Šä¸‹æ–‡ï¼Œå½“æ§åˆ¶æµç¦»å¼€è¯¥ä¸Šä¸‹æ–‡æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ<code>obj.__exit__(type,value,traceback)</code>ï¼Œå¦‚æœæ²¡æœ‰å¼•å‘å¼‚å¸¸ï¼Œ<code>__exit__()</code>æ–¹æ³•çš„ä¸‰ä¸ªå‚æ•°å‡è¢«è®¾ä¸º<code>None</code>ï¼Œå¦åˆ™ï¼Œå®ƒä»¬å°†åŒ…å«ä¸å¯¼è‡´æ§åˆ¶æµç¦»å¼€ä¸Šä¸‹æ–‡çš„å¼‚å¸¸ç›¸å…³çš„ç±»å‹ã€å€¼å’Œè·Ÿè¸ªä¿¡æ¯ï¼Œ<code>__exit__()</code>æ–¹æ³•è¿”å›<code>True</code>æˆ–<code>False</code>ï¼Œç”¨äºæŒ‡ç¤ºè¢«å¼•å‘çš„å¼‚å¸¸æ˜¯å¦å¾—åˆ°å¤„ç†ï¼Œå¦‚æœè¿”å›<code>False</code>ï¼Œå¼•å‘çš„ä»»ä½•å¼‚å¸¸éƒ½å°†è¢«ç»§ç»­å‘å¤–æŠ›å‡ºã€‚<code>with obj</code>è¯­å¥æ¥å—ä¸€ä¸ªå¯é€‰çš„<code>as var</code>ä¿®é¥°ç¬¦ï¼Œæ­¤æ—¶<code>obj.__enter__()</code>æ–¹æ³•çš„è¿”å›å€¼å°†è¢«èµ‹ç»™å˜é‡<code>var</code></p><p>è‡ªå®šä¹‰ä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„ä¼ªä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">contextor</span>:</span> <span class="comment">#ç±»å®ç°çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,*args,**kwargs</span>):</span></span><br><span class="line">        <span class="comment">#åˆå§‹åŒ–ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span></span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment">#å¯ä»¥æ˜¯è·å–èµ„æºç­‰æ“ä½œ</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> something <span class="comment">#è¿”å›å€¼å°†èµ‹ç»™withçš„asä»å¥æ‰€å®šä¹‰çš„å˜é‡var</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span>(<span class="params">self, <span class="built_in">type</span>, value, traceback</span>):</span></span><br><span class="line">        <span class="comment">#å¯ä»¥æ˜¯é‡Šæ”¾èµ„æºç­‰æ“ä½œ</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">or</span> <span class="literal">False</span> <span class="comment">#æ˜¯å¦å‘withå¤–æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> contextor(*args,**kwargs) <span class="keyword">as</span> var:</span><br><span class="line">    <span class="comment">#withè¯­å¥å—</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§å®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„æ–¹å¼ï¼Œå€ŸåŠ©<code>contextlib</code>æ¨¡å—çš„<code>contextmanager</code>è£…é¥°å™¨å®ç°ï¼Œä¼ªä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"></span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">contextor</span>(<span class="params">*args,**kwargs</span>):</span> <span class="comment">#å‡½æ•°ç‰ˆæœ¬çš„â€œä¸Šä¸‹æ–‡ç®¡ç†å™¨â€</span></span><br><span class="line">    <span class="comment">#è¯­å¥å—1</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">yield</span> expression</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="comment">#æ•æ‰withè¯­å¥å—å†…å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ï¼Œå¦‚æœä¸æ•æ‰ï¼Œå°†è¢«æŠ›ç»™withçš„å¤–å±‚ï¼Œè¿™ä¹Ÿæ„å‘³ç€è¯­å¥å—2ï¼ˆç­‰åŒäºä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„__exit__()æ–¹æ³•ä»£ç ï¼‰ä¸ä¼šæ‰§è¡Œï¼Œè¿™ä¸ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„ç²¾ç¥ç›¸è¿èƒŒï¼ˆå³ä¸è®ºwithè¯­å¥å—å†…æ˜¯å¦å¼•å‘å¼‚å¸¸ï¼Œ__exit__()æ–¹æ³•éƒ½ä¼šæ‰§è¡Œï¼‰ï¼Œå› æ­¤ä¸€èˆ¬éƒ½è¦åœ¨yieldä½ç½®æ•æ‰å¯èƒ½çš„å¼‚å¸¸</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="comment">#è¯­å¥å—2</span></span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> contextor(*args,**kwargs) <span class="keyword">as</span> var:</span><br><span class="line">    <span class="comment">#withè¯­å¥å—</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p><code>contextmanager</code>è£…é¥°å™¨çš„åŸç†å¾ˆç®€å•ï¼Œå…¶å®ç°ä¾èµ–äºä¸€ä¸ªåä¸º<code>_GeneratorContextManager</code>çš„ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šä¹‰äº†<code>__enter__()</code>å’Œ<code>__exit__()</code>æ–¹æ³•çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç±»å‹ï¼Œè€Œè¢«è£…é¥°çš„å‡½æ•°<code>contextor</code>æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼Œæ ¹æ®è£…é¥°å™¨åŸç†æœ‰<code>contextor=contextmanager(contextor)</code>ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªé—­åŒ…å‡½æ•°å¯¹è±¡ï¼Œå…¶åŒ…å«æœ‰ä¸€ä¸ªæŒ‡å‘çœŸå®<code>contextor</code>å‡½æ•°åœ°å€çš„å˜é‡ï¼Œå§‘ä¸”è®°ä½œ<code>func</code>ï¼Œå½“ä½ è°ƒç”¨<code>contextor(*args,**kwargs)</code>æ—¶å°†ä½¿ç”¨<code>args</code>ã€<code>kwargs</code>å’Œ<code>func</code>æ¥åˆå§‹åŒ–æ„é€ ä¸€ä¸ª<code>_GeneratorContextManager</code>ç±»å®ä¾‹ï¼Œå§‘ä¸”è®°ä½œ<code>c</code>ï¼Œå…·ä½“çš„ï¼Œåœ¨å…¶åˆå§‹åŒ–å‡½æ•°<code>__init__()</code>ä¸­ä¼šæ‰§è¡Œ<code>func(*args,**keargs)</code>å¾—åˆ°ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼Œå¹¶ä¿å­˜ä¸ºå®ä¾‹å±æ€§ï¼Œå§‘ä¸”è®°ä½œ<code>c.g</code>ï¼Œé…åˆ<code>with</code>ä½¿ç”¨æ—¶ï¼ˆ<code>with contextor(*args,**kwargs)</code>ï¼‰ï¼Œå°†è‡ªåŠ¨è°ƒç”¨<code>c</code>çš„<code>__enter__()</code>æ–¹æ³•ï¼Œè€Œ<code>__enter__()</code>çš„å®ç°å³æ˜¯æ‰§è¡Œ<code>return c.g.__next__()</code>ï¼Œæ¢å¥è¯è¯´ï¼Œä¸Šè¿°ç”Ÿæˆå™¨å‡½æ•°ä¸­<code>yield</code>ä¹‹å‰çš„è¯­å¥å—1å°†ä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„<code>__enter__()</code>æ–¹æ³•å®šä¹‰ï¼Œä¸”<code>yield</code>è¡¨è¾¾å¼å€¼å°†èµ‹ç»™å˜é‡<code>var</code>ï¼Œå½“ç¦»å¼€<code>with</code>è¯­å¥å—ï¼Œå°†è‡ªåŠ¨è°ƒç”¨<code>c</code>çš„<code>__exit__()</code>æ–¹æ³•ï¼Œè€Œ<code>__exit__()</code>çš„å®ç°å³æ˜¯å†ä¸€æ¬¡è°ƒç”¨<code>c.g.__next__()</code>ï¼Œæ¢å¥è¯è¯´ï¼Œ<code>yield</code>ä¹‹åçš„è¯­å¥å—2å°†ä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„<code>__exit__()</code>æ–¹æ³•å®šä¹‰ï¼Œå¦å¤–ï¼Œç”±äº<code>with</code>è¯­å¥å—å†…éƒ¨å¯èƒ½å¼•å‘å¼‚å¸¸ï¼Œå¼‚å¸¸å°†è¢«<code>c</code>çš„<code>__exit__()</code>æ–¹æ³•æ¥æ”¶ï¼Œé»˜è®¤ä¸‹<code>c.__exit__()</code>è¿”å›<code>False</code>ï¼Œå³å¼‚å¸¸å°†è¢«æŠ›ç»™<code>with</code>çš„å¤–å±‚ï¼Œå¦‚æœä½ ä¸æƒ³æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™éœ€è¦åœ¨ä¸Šè¿°ç”Ÿæˆå™¨å‡½æ•°çš„<code>yield</code>ä½ç½®å¤„æ•æ‰ï¼Œå› ä¸º<code>c.__exit__()</code>å†…éƒ¨ä¼šåœ¨å­˜åœ¨å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œè°ƒç”¨ç”Ÿæˆå™¨å¯¹è±¡çš„<code>throw()</code>æ–¹æ³•ï¼Œå…·ä½“çš„ï¼Œæ‰§è¡Œ<code>c.g.throw(type,value,traceback)</code>ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨<code>yield</code>ä½ç½®å¤„æŠ›å‡ºå‚æ•°æ‰€æŒ‡å¼‚å¸¸ï¼Œå¦‚æœä½ æ‰‹åŠ¨æ•æ‰äº†å¼‚å¸¸ï¼Œç¨‹åºä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œä¸€æ¬¡ç”Ÿæˆå™¨çš„<code>next()</code>æ–¹æ³•ï¼Œå³æ‰§è¡Œè¯­å¥å—2ï¼Œå¦åˆ™æ„å‘³ç€ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„<code>__exit__()</code>ä¸ä¼šè¢«è°ƒç”¨ï¼Œè¿™ä¸€ç‚¹åƒä¸‡æ³¨æ„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¤ºä¾‹1ï¼ˆæ¥è‡ªæ–‡çŒ®[1]-p73ï¼‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListTransaction</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,thelist</span>):</span></span><br><span class="line">        self.thelist=thelist</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.workingcopy=<span class="built_in">list</span>(self.thelist)</span><br><span class="line">        <span class="keyword">return</span> self.workingcopy</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span>(<span class="params">self,<span class="built_in">type</span>,value,tb</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            self.thelist[:]=self.workingcopy</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> <span class="comment">#è¿”å›Trueï¼Œé¿å…withè¯­å¥å—å†…çš„å¼‚å¸¸ç»§ç»­å‘ä¸ŠæŠ›ç»™å¤–å±‚</span></span><br><span class="line">        </span><br><span class="line">items=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">with</span> ListTransaction(items) <span class="keyword">as</span> working:</span><br><span class="line">    working.append(<span class="number">6</span>)</span><br><span class="line">    working.append(<span class="number">7</span>)</span><br><span class="line">    <span class="comment">#raise ValueError(&#x27;xxx&#x27;)</span></span><br><span class="line">print(items) <span class="comment">#[1, 2, 3, 6, 7]ï¼Œå¦‚æœä¸Šä¸€è¡Œæ³¨é‡Šå–æ¶ˆï¼Œåˆ™è¾“å‡º[1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹2</span></span><br><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ListTransaction</span>(<span class="params">thelist</span>):</span></span><br><span class="line">    workingcopy=<span class="built_in">list</span>(thelist)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">yield</span> workingcopy</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">    thelist[:]=workingcopy</span><br><span class="line">    </span><br><span class="line">items=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">with</span> ListTransaction(items) <span class="keyword">as</span> working:</span><br><span class="line">    working.append(<span class="number">6</span>)</span><br><span class="line">    working.append(<span class="number">7</span>)</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line">print(items)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">xxx</span></span><br><span class="line"><span class="string">[1, 2, 3, 6, 7]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹3</span></span><br><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ListTransaction</span>(<span class="params">thelist</span>):</span></span><br><span class="line">    workingcopy=<span class="built_in">list</span>(thelist)</span><br><span class="line">    <span class="keyword">yield</span> workingcopy <span class="comment">#å¯¹æ¯”ç¤ºä¾‹2ï¼Œå¦‚æœä¸åœ¨yieldä½ç½®å¤„æ•æ‰å¼‚å¸¸ï¼Œå½“withè¯­å¥å—ä¸­å¼•å‘å¼‚å¸¸æ—¶å€™ï¼Œyieldåé¢çš„ä»£ç å°†ä¸ä¼šè¢«æ‰§è¡Œï¼ˆè¯¥éƒ¨åˆ†ä»£ç æ˜¯ä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„__exit__()æ–¹æ³•å®šä¹‰ï¼‰</span></span><br><span class="line">    thelist[:]=workingcopy</span><br><span class="line">    </span><br><span class="line">items=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> ListTransaction(items) <span class="keyword">as</span> working:</span><br><span class="line">        working.append(<span class="number">6</span>)</span><br><span class="line">        working.append(<span class="number">7</span>)</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">print(items)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">xxx</span></span><br><span class="line"><span class="string">[1, 2, 3]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-1-5"><p>ä¸€èˆ¬æ ¼å¼ä¸º<code>assert expression[, msg]</code>ï¼Œå…¶ä¸­<code>expression</code>ä¸º<code>False</code>æ—¶ï¼Œå°†è§¦å‘<code>AssertionError</code>å¼‚å¸¸ï¼Œ<code>msg</code>æ˜¯å¯é€‰çš„è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ï¼Œæ³¨æ„<code>assert</code>ä¸åº”ç”¨äºå¿…é¡»æ‰§è¡Œä»¥ç¡®ä¿ç¨‹åºæ­£ç¡®çš„ä»£ç ï¼Œå› ä¸ºå¦‚æœpythonè¿è¡Œåœ¨æœ€ä¼˜æ¨¡å¼ï¼ˆé€šè¿‡å¯¹è§£é‡Šå™¨ä½¿ç”¨<code>-O</code>é€‰é¡¹è¿›å…¥è¯¥æ¨¡å¼ï¼‰ï¼Œæ–­è¨€è¯­å¥å°†ä¸ä¼šæ‰§è¡Œï¼Œé‚£ä¹ˆä½•æ—¶ä½¿ç”¨<code>assert</code>å‘¢ï¼Ÿ<code>assert</code>è¯­å¥ç”¨äºæ£€æŸ¥åº”è¯¥å§‹ç»ˆä¸ºçœŸçš„å†…å®¹</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="å‡½æ•°å¼ç¼–ç¨‹">å‡½æ•°å¼ç¼–ç¨‹</h2><div class="tabs" id="py2-2"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#py2-2-1">å‡½æ•°</button></li><li class="tab"><button type="button" data-href="#py2-2-2">è£…é¥°å™¨</button></li><li class="tab"><button type="button" data-href="#py2-2-3">åå‡½æ•°</button></li><li class="tab"><button type="button" data-href="#py2-2-4"><code>yield</code>è¡¨è¾¾å¼ä¸åç¨‹</button></li><li class="tab"><button type="button" data-href="#py2-2-5">ç”Ÿæˆå¼</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="py2-2-1"><p>å‡½æ•°å®šä¹‰ä½¿ç”¨<code>def</code>å…³é”®å­—ï¼ˆå¦å¤–å¯ä»¥ä½¿ç”¨<code>lambda</code>å…³é”®å­—åˆ›å»ºè¡¨è¾¾å¼å½¢å¼çš„åŒ¿åå‡½æ•°ï¼Œå½¢å¦‚<code>lambda *args, **kwargs : expression</code>ï¼‰ï¼Œé€šå¸¸å‡½æ•°çš„ç¬¬ä¸€æ¡è¯­å¥ä¼šä½¿ç”¨æ–‡æ¡£å­—ç¬¦ä¸²æ¥æè¿°å‡½æ•°çš„ç”¨é€”ï¼Œå¯ä»¥åœ¨æŸ¥çœ‹å‡½æ•°å¸®åŠ©æ—¶è·å–åˆ°è¯¥æ–‡æ¡£ï¼ˆ<code>help(func)</code>ï¼‰ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;This is a demo.</span></span><br><span class="line"><span class="string">       Author: muggledy</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">help</span>())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">Help on function f in module __main__:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">f()</span></span><br><span class="line"><span class="string">    This is a demo.</span></span><br><span class="line"><span class="string">    Author: muggledy</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°ä½œä¸ºå¯¹è±¡ä¹Ÿå…·æœ‰å±æ€§ï¼Œè­¬å¦‚ä¸Šè¿°æ–‡æ¡£å­—ç¬¦ä¸²å°±å­˜å‚¨äºå‡½æ•°å¯¹è±¡çš„<code>__doc__</code>å±æ€§ä¸­ï¼Œå‡½æ•°åå­˜å‚¨åœ¨<code>__name__</code>å±æ€§ä¸­ï¼Œäº‹å®ä¸Šï¼Œå¯ä»¥ç»™å‡½æ•°å¯¹è±¡ç»‘å®šä»»æ„å±æ€§ï¼Œè¿™äº›æ–°å¢å±æ€§ä¿å­˜åœ¨å‡½æ•°å¯¹è±¡çš„<code>__dict__</code>å±æ€§ä¸­ï¼Œè¦æŸ¥çœ‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œåˆ™ä½¿ç”¨<code>dir(obj)</code>å‡½æ•°ï¼Œæˆ–è€…é€šè¿‡<code>getattr(obj,attr)</code>è·å–å¯¹è±¡çš„å±æ€§ï¼ˆå¦<code>hasattr(obj,attr)</code>æ£€æŸ¥å¯¹è±¡æ˜¯å¦å…·æœ‰åä¸º<code>attr</code>çš„å±æ€§ï¼Œ<code>setattr(obj,attr,value)</code>ä¸ºå¯¹è±¡è®¾ç½®å±æ€§ï¼‰ï¼Œå‡½æ•°æ˜¯å¯è°ƒç”¨çš„ï¼ˆ<code>callable(func)</code>è¿”å›<code>True</code>ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span> <span class="keyword">pass</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a=A()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">setattr</span>(a,<span class="string">&#x27;can\&#x27;t be touched&#x27;</span>,<span class="string">&#x27;zj&#x27;</span>) <span class="comment">#setattr()ç›¸å½“é€†å¤©ï¼Œä½ å¯ä»¥é€šè¿‡è¯¥æ–¹æ³•ä¸ºå¯¹è±¡è®¾ç½®ä¸€äº›ä¸èƒ½å¤Ÿé€šè¿‡å±æ€§è®¿é—®ç¬¦.å·è®¿é—®çš„å±æ€§</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.__dict__</span><br><span class="line">&#123;<span class="string">&quot;can&#x27;t be touched&quot;</span>: <span class="string">&#x27;zj&#x27;</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.can<span class="string">&#x27;t be touched</span></span><br><span class="line"><span class="string">  File &quot;&lt;stdin&gt;&quot;, line 1</span></span><br><span class="line"><span class="string">    a.can&#x27;</span>t be touched</span><br><span class="line">                     ^</span><br><span class="line">SyntaxError: EOL <span class="keyword">while</span> scanning string literal</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">getattr</span>(a,<span class="string">&#x27;can\&#x27;t be touched&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;zj&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">hasattr</span>(a,<span class="string">&#x27;can\&#x27;t be touched&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure><p>è¦è°ƒç”¨å‡½æ•°ï¼Œåªè¦ä½¿ç”¨å‡½æ•°ååŠ ä¸Šç”¨åœ†æ‹¬å·æ‹¬èµ·æ¥çš„å‚æ•°å³å¯ï¼ˆå‡½æ•°åå’Œæ‹¬å·ä¹‹é—´å…è®¸æœ‰ç©ºæ ¼ï¼‰ï¼Œpythonä¸­å‡½æ•°ä¼ å‚çš„å½¢å¼ä¸»è¦æœ‰äº”ç§ï¼Œåˆ†åˆ«ä¸ºä½ç½®ä¼ é€’ã€å…³é”®å­—ä¼ é€’ã€é»˜è®¤ä¼ é€’ã€åŒ…è£¹ä¼ é€’å’Œè§£åŒ…è£¹ä¼ é€’ï¼ˆåä¸¤ç§åœ¨<a href="/posts/5311/">å‰ä¸€ç« </a>å·²ç»è¯´è¿‡äº†ï¼Œå°±ä¸é‡å¤äº†ï¼‰ï¼Œçœ‹ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä½ç½®ä¼ é€’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span>(<span class="params">x,y,z</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span>+<span class="subst">&#123;y&#125;</span>+<span class="subst">&#123;z&#125;</span>=<span class="subst">&#123;x+y+z&#125;</span>&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">f1(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="comment">#1+2+3=6 #å³ä¸å…·åä¼ é€’ï¼Œä»…å‡­ä½ç½®ä¸Šçš„ä¸€ä¸€å¯¹åº”</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å…³é”®å­—ä¼ é€’</span></span><br><span class="line">f1(<span class="number">4</span>,z=<span class="number">6</span>,y=<span class="number">5</span>) <span class="comment">#ç»™æ‰€ä¼ é€’çš„å‚æ•°å€¼å…·åçš„ä¸€ç§ä¼ é€’æ–¹å¼ï¼Œæ˜ç¡®å‘Šè¯‰æŸä¸€å‚æ•°å€¼æ˜¯äº¤ç”±å‡½æ•°çš„å“ªä¸€ä¸ªå‚æ•°å˜é‡æ¥æ”¶çš„ï¼Œå¦‚æ­¤æˆ‘ä»¬å°±ä¸éœ€è¦æŒ‰ç…§ä½ç½®å‚æ•°çš„å›ºå®šä½ç½®åºå·æ’åˆ—ï¼Œå¯ä»¥åœ¨å‡½æ•°å®šä¹‰ä¸­å®šä¹‰å‘½åå…³é”®å­—å‚æ•°æˆ–è€…å¯å˜å­—å…¸å‚æ•°ï¼Œè¿™ä¸¤ç§å‚æ•°éƒ½å¿…é¡»ä»¥é”®å€¼å¯¹å½¢å¼ä¼ é€’ï¼Œè§å</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é»˜è®¤ä¼ é€’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2</span>(<span class="params">x,y,z=<span class="number">6</span></span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span>+<span class="subst">&#123;y&#125;</span>+<span class="subst">&#123;z&#125;</span>=<span class="subst">&#123;x+y+z&#125;</span>&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">f2(<span class="number">2</span>,<span class="number">3</span>) <span class="comment">#é»˜è®¤å‚æ•°ä¼ é€’å³éšå¼ä¼ é€’ï¼Œå…·æœ‰é»˜è®¤å€¼çš„å‚æ•°åœ¨å‡½æ•°è°ƒç”¨æ—¶å¯ä»¥ä¸æ˜ç¡®ç»™å‡º</span></span><br></pre></td></tr></table></figure><p>è‹¥æŒ‰ç…§å‚æ•°ç±»å‹åˆ’åˆ†ï¼Œåˆ™å¯åˆ†ä¸ºä½ç½®å‚æ•°ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°å’Œå‘½åå…³é”®å­—å‚æ•°ï¼Œå…¶ä¸­é»˜è®¤å‚æ•°åˆåˆ†ä¸ºé»˜è®¤ä½ç½®å‚æ•°å’Œé»˜è®¤å…³é”®å­—å‚æ•°ï¼ˆä¸”åªæœ‰å‘½åå…³é”®å­—å‚æ•°å¯ä»¥æœ‰é»˜è®¤å€¼ï¼Œå…¶ä»–å…³é”®å­—å‚æ•°æ²¡æœ‰æˆ–è€…è¯´æ²¡æ³•è®¾ç½®é»˜è®¤å€¼ï¼‰ï¼Œå¯å˜ï¼ˆé•¿ï¼‰å‚æ•°åˆåˆ†ä¸ºå¯å˜å…ƒç»„å‚æ•°å’Œå¯å˜å…³é”®å­—å‚æ•°ï¼ˆæˆ–å¯å˜å­—å…¸å‚æ•°ï¼‰ï¼Œè¿™é‡Œåªå•è¯´ä¸€ä¸‹â€œå‘½åå…³é”®å­—å‚æ•°â€ï¼Œå‡½æ•°å‚æ•°å®šä¹‰ä¸­ä½äº<code>*</code>æˆ–<code>*args</code>ï¼ˆå¯å˜å…ƒç»„å‚æ•°ï¼‰ä¹‹åä»¥åŠå¯å˜å…³é”®å­—å‚æ•°ä¹‹å‰ï¼ˆå‡è®¾å­˜åœ¨çš„è¯ï¼‰çš„å°±æ˜¯å‘½åå…³é”®å­—å‚æ•°ï¼Œåœ¨è°ƒç”¨æ—¶å…¶å¿…é¡»å…·åä¼ é€’ï¼Œå‘½åå…³é”®å­—å‚æ•°å¯ä»¥æœ‰é»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f3</span>(<span class="params">x,*,y=<span class="number">1</span>,z</span>):</span> <span class="comment">#xä¸ºä½ç½®å‚æ•°ï¼Œyå’Œzæ˜¯å‘½åå…³é”®å­—å‚æ•°ï¼Œå‰è€…æœ‰é»˜è®¤å€¼</span></span><br><span class="line">    print(x,y,z)</span><br><span class="line"></span><br><span class="line">f3(<span class="number">1</span>,z=<span class="number">3</span>) <span class="comment">#å¦‚æœè°ƒç”¨f3(1,1,3)å°†æŠ¥é”™TypeError: f3() takes 1 positional argument but 3 were given</span></span><br></pre></td></tr></table></figure><p>ä¸åŒç±»å‹å‚æ•°çš„ç»„åˆä½¿ç”¨ï¼ˆå®šä¹‰å’Œè°ƒç”¨æ—¶æ³¨æ„é¡ºåºï¼ŒåŸºæœ¬åŸåˆ™æ˜¯ï¼Œä½ç½®å‚æ•°åœ¨å‰ï¼Œå…³é”®å­—å‚æ•°åœ¨åï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¤ºä¾‹1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a,b,c=<span class="number">3</span>,*args</span>):</span> <span class="comment">#ä½ç½®å‚æ•°+å¸¦é»˜è®¤å€¼çš„ä½ç½®å‚æ•°+å¯å˜å…ƒç»„å‚æ•°</span></span><br><span class="line">    print(a,b,c,*args)</span><br><span class="line">    </span><br><span class="line">f(<span class="number">1</span>,<span class="number">2</span>,c=<span class="number">3</span>) <span class="comment">#1 2 3</span></span><br><span class="line">f(a=<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="number">3</span>) <span class="comment">#1 2 3</span></span><br><span class="line"><span class="comment">#f(a=3,b=2,c=1,0) #SyntaxError: positional argument follows keyword argument</span></span><br><span class="line">f(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>) <span class="comment">#1 2 3 4 5 6 7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹2</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a,b,*,x,y,**kwargs</span>):</span> <span class="comment">#ä½ç½®å‚æ•°+å‘½åå…³é”®å­—å‚æ•°+å¯å˜å­—å…¸å‚æ•°</span></span><br><span class="line">    print(a,b,x,y,kwargs)</span><br><span class="line">    </span><br><span class="line">f(<span class="number">1</span>,<span class="number">2</span>,x=<span class="number">3</span>,y=<span class="number">4</span>,z=<span class="number">5</span>) <span class="comment">#1 2 3 4 &#123;&#x27;z&#x27;: 5&#125;</span></span><br><span class="line"><span class="comment">#f(1,2,x=3,z=4) #TypeError: f() missing 1 required keyword-only argument: &#x27;y&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹3</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a,b,c=<span class="number">3</span>,*args,x=<span class="number">4</span>,y,**kwargs</span>):</span> <span class="comment">#æœ€å…¨ç»„åˆï¼šä½ç½®å‚æ•°+å¸¦é»˜è®¤å€¼çš„ä½ç½®å‚æ•°+å¯å˜å…ƒç»„å‚æ•°+ï¼ˆå¸¦é»˜è®¤å€¼çš„ï¼Œå¯å¸¦å¯ä¸å¸¦ï¼‰å‘½åå…³é”®å­—å‚æ•°+å¯å˜å…³é”®å­—å‚æ•°</span></span><br><span class="line">    print(a,b,c,args,x,y,kwargs)</span><br><span class="line">    </span><br><span class="line">f(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,x=<span class="number">5</span>,y=<span class="number">6</span>,z=<span class="number">7</span>) <span class="comment">#1 2 4 (3,) 5 6 &#123;&#x27;z&#x27;: 7&#125;</span></span><br><span class="line">f(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,y=<span class="number">6</span>,z=<span class="number">7</span>) <span class="comment">#1 2 4 (3,) 4 6 &#123;&#x27;z&#x27;: 7&#125;</span></span><br><span class="line"><span class="comment">#f(b=2,a=1,3,4,y=6,x=5,z=7) #SyntaxError: positional argument follows keyword argument</span></span><br></pre></td></tr></table></figure><p>åœ¨ç¼–ç¨‹æ—¶ï¼Œå°½é‡é¿å…ä¼ é€’å¯å˜å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€å­—å…¸ç­‰ï¼‰ï¼Œå› ä¸ºåœ¨å‡½æ•°å†…éƒ¨å¯¹å¯å˜å¯¹è±¡çš„ä¿®æ”¹å°†åæ˜ åœ¨åŸå§‹å¯¹è±¡ä¸­ï¼Œè‹¥æ— æ³•é¿å…ï¼Œåˆ™åº”åœ¨å‡½æ•°ä¸­ä½¿ç”¨å¯å˜å¯¹è±¡çš„æ‹·è´ï¼Œå¦å¤–å‡½æ•°å¯ä»¥ä¸æ˜¾å¼å†™<code>return</code>è¯­å¥ï¼Œåœ¨è¿è¡Œç»“æŸæ—¶å€™ï¼Œä¼šé»˜è®¤è¿”å›<code>None</code></p><p>å…³äºå‡½æ•°çš„ä½œç”¨åŸŸé—®é¢˜ï¼ˆ<code>lambda</code>è¡¨è¾¾å¼éµå¾ªä¸å‡½æ•°ç›¸åŒçš„ä½œç”¨åŸŸè§„åˆ™ï¼‰ï¼Œpythonä¸­åªæœ‰å‡½æ•°ã€ç±»ã€æ¨¡å—ä¼šäº§ç”Ÿä½œç”¨åŸŸï¼ˆåœ¨ä½œç”¨åŸŸå†…å®šä¹‰çš„å˜é‡ä»…æ­¤ä½œç”¨åŸŸå¯è§ï¼Œä½†æ³¨æ„ä¸åŒçš„ä½œç”¨åŸŸå¯èƒ½æ˜¯åŒ…å«å…³ç³»ï¼Œå¦‚å…¨å±€ä½œç”¨åŸŸçš„èŒƒå›´åŒ…å«å±€éƒ¨ä½œç”¨åŸŸï¼Œå…¨å±€ä½œç”¨åŸŸå®šä¹‰çš„å˜é‡åœ¨å±€éƒ¨ä½œç”¨åŸŸä¹Ÿå¯è®¿é—®ï¼‰ï¼Œä»£ç å—ä¸ä¼šäº§ç”Ÿä½œç”¨åŸŸï¼ˆå¦‚<code>for</code>å¾ªç¯å˜é‡ä¼šä¿®æ”¹å¤–é¢çš„åŒåå˜é‡ï¼Œå…¶å®å°±æ˜¯å˜é‡è¦†å†™ï¼‰ï¼Œæ¯æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå°±ä¼šåˆ›å»ºæ–°çš„å±€éƒ¨å‘½åç©ºé—´ï¼ŒåŒ…å«å‡½æ•°å‚æ•°åç§°å’Œåœ¨å‡½æ•°ä½“å†…å®šä¹‰çš„å˜é‡åç§°ï¼Œåœ¨å‡½æ•°å†…è®¿é—®å˜é‡é¦–å…ˆä¼šåœ¨å±€éƒ¨ç©ºé—´ä¸­æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°å†å»å…¨å±€ç©ºé—´æŸ¥æ‰¾ï¼Œå…·ä½“çš„ï¼Œpythonä¸­æœ‰å››ç§ä½œç”¨åŸŸï¼šLocalï¼ˆå±€éƒ¨ä½œç”¨åŸŸï¼‰ã€Enclosingï¼ˆåµŒå¥—ä½œç”¨åŸŸï¼‰ã€Globalï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰ã€Built-inï¼ˆå†…ç½®ä½œç”¨åŸŸï¼‰ï¼Œä¸”å˜é‡çš„æŸ¥æ‰¾éµå¾ªâ€œLEGBâ€è§„åˆ™ï¼Œä»¥å†…å±‚åµŒå¥—å‡½æ•°ä¸ºä¾‹ï¼Œå…¶é¦–å…ˆæœç´¢è‡ªå·±çš„å±€éƒ¨å‘½åç©ºé—´ï¼Œæ²¡æœ‰ç»“æœå°†ç”±å†…è€Œå¤–åœ¨å¤–å±‚å‡½æ•°çš„å±€éƒ¨å‘½åç©ºé—´ä¸­ä¸€å±‚å±‚åœ°å¯»æ‰¾ï¼ˆå› ä¸ºå¯ä»¥å¤šå±‚å‡½æ•°åµŒå¥—ï¼‰ï¼Œä»æ— ç»“æœï¼Œæ‰ä¼šåˆ°å…¨å±€å‘½åç©ºé—´å’Œå†…ç½®å‘½åç©ºé—´æŸ¥æ‰¾ï¼Œå¦‚æœè¿˜æ²¡æœ‰ï¼Œåˆ™å¼•å‘<code>NameError</code>å¼‚å¸¸</p><p>å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨<code>global</code>å…³é”®å­—å°†ï¼ˆå±€éƒ¨ï¼‰å˜é‡åŠ¨æ€å£°æ˜ä¸ºå…¨å±€å˜é‡ï¼Œä½¿å…¶ä½äºå…¨å±€å‘½åç©ºé—´ï¼Œå½±å“å…¨å±€ä½œç”¨åŸŸï¼Œå¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">    <span class="keyword">global</span> x <span class="comment">#globalè¯­å¥å¯ä»¥æ”¾åœ¨å‡½æ•°å†…ä»»æ„è¡Œæˆ–é‡å¤ä½¿ç”¨</span></span><br><span class="line">    x=<span class="number">8</span> <span class="comment">#å¦‚æœå¤–å±‚å·²ç»å­˜åœ¨æ­¤å˜é‡ï¼Œåˆ™å‡½æ•°å†…éƒ¨çš„ä¿®æ”¹å°†ä½“ç°åœ¨å¤–å±‚ç©ºé—´</span></span><br><span class="line">    print(<span class="string">&#x27;å±€éƒ¨å‘½åç©ºé—´:&#x27;</span>,<span class="built_in">locals</span>()) <span class="comment">#ç©ºï¼Œæ­¤å‡½æ•°æœªåˆ›å»ºä»»ä½•å±€éƒ¨å˜é‡</span></span><br><span class="line">    print(<span class="string">&#x27;å…¨å±€å‘½åç©ºé—´:&#x27;</span>,<span class="built_in">globals</span>()) <span class="comment">#ä¸Šé¢åˆ›å»ºçš„å˜é‡xä½äºå…¨å±€å‘½åç©ºé—´</span></span><br><span class="line"></span><br><span class="line">f()</span><br><span class="line">print(x) <span class="comment">#8</span></span><br></pre></td></tr></table></figure><p>å¯¹äºåµŒå¥—å‡½æ•°ï¼Œå°½ç®¡å®ƒå¯ä»¥è®¿é—®åˆ°åµŒå¥—ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œä¸€æ—¦å°è¯•å¯¹å…¶æ‰§è¡Œå¦‚èµ‹å€¼ç­‰æ“ä½œï¼Œå®é™…ä¼šåœ¨åµŒå¥—å‡½æ•°çš„å±€éƒ¨å‘½åç©ºé—´ä¸­æ–°å»ºä¸€ä¸ªåŒåå˜é‡ï¼Œpython3æä¾›äº†<code>nonlocal</code>å…³é”®å­—ï¼Œè¯¥å£°æ˜ä¼šå°†åç§°åŠ¨æ€ç»‘å®šä¸ºå¤–å±‚å‡½æ•°ä¸­é¦–æ¬¡è®¿é—®åˆ°çš„åŒåå˜é‡ï¼ˆå¤šå±‚åµŒå¥—æ—¶ï¼Œå¯èƒ½å¤šä¸ªå¤–å±‚å‡½æ•°éƒ½å®šä¹‰äº†åŒä¸€å˜é‡ï¼Œå…·ä½“ç»‘å®šå“ªä¸ªå°±çœ‹è°æœ€é å†…æœ€å…ˆè¢«è®¿é—®åˆ°ï¼‰ï¼Œäºæ˜¯å¯ä»¥åœ¨åµŒå¥—å‡½æ•°ä¸­ä¿®æ”¹å¹¶ä½“ç°åœ¨å¤–å±‚ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">    i=<span class="number">4</span></span><br><span class="line">    j=<span class="number">7</span></span><br><span class="line">    k=<span class="number">13</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner1</span>():</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        j=<span class="number">70</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">inner2</span>():</span></span><br><span class="line">            <span class="keyword">nonlocal</span> i,j <span class="comment">#nonlocalé™å®šäºpython3ä¸”åµŒå¥—å‡½æ•°ä½¿ç”¨ï¼Œç”¨äºç»‘å®šè‡³å¤–å±‚å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œå½“å£°æ˜ä¸ºnonlocalå˜é‡æ—¶ï¼Œè¯¥å˜é‡å¿…é¡»èƒ½åœ¨åµŒå¥—ä½œç”¨åŸŸä¸­æŸ¥è·ï¼ˆè§__closure__å±æ€§ï¼‰ï¼Œå¦åˆ™æŠ¥é”™ï¼Œå…·ä½“çš„ï¼Œæ­¤å¤„iç»‘å®šä¸ºfä¸­çš„å˜é‡iï¼Œjç»‘å®šåœ¨inner1ä¸­çš„å˜é‡j</span></span><br><span class="line">            i=<span class="number">6</span></span><br><span class="line">            print(j) <span class="comment">#70</span></span><br><span class="line">            j=<span class="number">8</span></span><br><span class="line">            print(k) <span class="comment">#13</span></span><br><span class="line">        i=<span class="number">5</span></span><br><span class="line">        print(i) <span class="comment">#5</span></span><br><span class="line">        inner2()</span><br><span class="line">        print(i) <span class="comment">#6</span></span><br><span class="line">    inner1()</span><br><span class="line">    print(j) <span class="comment">#7</span></span><br><span class="line">    </span><br><span class="line">f()</span><br></pre></td></tr></table></figure><p>å˜é‡å¿…é¡»å…ˆèµ‹å€¼æˆ–å®šä¹‰æ‰èƒ½ä½¿ç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">i=<span class="number">3</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">    print(i) <span class="comment">#iå®é™…æ˜¯å±€éƒ¨å˜é‡ï¼Œæ‰“å°å‰éœ€å…ˆèµ‹å€¼</span></span><br><span class="line">    i+=<span class="number">3</span></span><br><span class="line">    print(i)</span><br><span class="line">    </span><br><span class="line">f()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">Traceback (most recent call last):</span></span><br><span class="line"><span class="string">  File &quot;C:\Users\muggledy\Desktop\ttt2.py&quot;, line 7, in &lt;module&gt;</span></span><br><span class="line"><span class="string">    f()</span></span><br><span class="line"><span class="string">  File &quot;C:\Users\muggledy\Desktop\ttt2.py&quot;, line 3, in f</span></span><br><span class="line"><span class="string">    print(i)</span></span><br><span class="line"><span class="string">UnboundLocalError: local variable &#x27;i&#x27; referenced before assignment</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°ä½œä¸ºç¬¬ä¸€ç±»å¯¹è±¡ï¼ˆæ‰€è°“ç¬¬ä¸€ç±»å¯¹è±¡çš„ç‰¹æ€§æ˜¯ï¼Œå¯¹è±¡å¯ä»¥èµ‹å€¼ç»™å˜é‡ã€å¯¹è±¡å¯ä»¥è¢«å½“åšå‚æ•°ä¼ é€’ã€å¯¹è±¡å¯ä»¥è¢«å½“åšå‡½æ•°çš„è¿”å›å€¼è¿”å›ã€å¯¹è±¡å¯ä»¥ä½œä¸ºå…ƒç´ è¢«æ·»åŠ åˆ°å®¹å™¨ç±»å‹ä¸­ï¼‰ï¼Œåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå‡½æ•°æ¥å—å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºè¾“å…¥å¹¶è°ƒç”¨å®ƒï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®šä¹‰äºæ–‡ä»¶foo.pyï¼Œç¤ºä¾‹æ¥è‡ªæ–‡çŒ®[1]-p79</span></span><br><span class="line">x=<span class="number">6</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callf</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="keyword">return</span> func()</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨äº†ä¸Šè¿°å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> foo</span><br><span class="line">x=<span class="number">8</span> <span class="comment">#å¦‚æœæ³¨é‡Šæ‰æ­¤å¥ï¼Œå°†æŠ¥é”™NameError: name &#x27;x&#x27; is not defined</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helloworld</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;Hello World. x is <span class="subst">&#123;x&#125;</span>&#x27;</span></span><br><span class="line">    </span><br><span class="line">print(foo.callf(helloworld)) <span class="comment">#Hello World. x is 8</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„<code>helloworld()</code>ä½¿ç”¨çš„<code>x</code>çš„å€¼æ˜¯åœ¨ä¸å®ƒç›¸åŒçš„ç¯å¢ƒä¸­å®šä¹‰çš„ï¼Œäº‹å®ä¸Šï¼Œè§£é‡Šå™¨ä¼šå°†å‡½æ•°åŠå…¶æ‰€åœ¨æ‰§è¡Œç¯å¢ƒæ•´ä¸ªæ‰“åŒ…åœ¨ä¸€èµ·ï¼Œå¾—åˆ°çš„å‡½æ•°å¯¹è±¡ç§°ä¸ºâ€œé—­åŒ…å‡½æ•°â€ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ‹¥æœ‰ä¸€ä¸ªæŒ‡å‘å®šä¹‰è¯¥å‡½æ•°çš„å…¨å±€å‘½åç©ºé—´çš„<code>__globals__</code>å±æ€§ï¼Œå¯¹äºåµŒå¥—å‡½æ•°ï¼Œé—­åŒ…åŒæ ·å°†æ•æ‰åµŒå¥—å‡½æ•°æ‰§è¡Œæ‰€éœ€çš„æ•´ä¸ªç¯å¢ƒï¼Œå› æ­¤é™¤äº†<code>__globals__</code>å±æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ªæŒ‡å‘å®šä¹‰è¯¥å‡½æ•°çš„åµŒå¥—ä½œç”¨åŸŸç©ºé—´çš„<code>__closure__</code>å±æ€§ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">greeting_conf</span>(<span class="params">prefix</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">greeting</span>(<span class="params">name</span>):</span></span><br><span class="line">        <span class="built_in">print</span> (prefix+<span class="string">&#x27; &#x27;</span>+name) <span class="comment">#greetingå‡½æ•°è®¿é—®äº†å¤–éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡prefixï¼Œäº‹å®ä¸Šåœ¨greeting_confè¿”å›åï¼Œå¯¹greeting_confå¯è§çš„å±€éƒ¨å‘½åç©ºé—´å·²ç»éšç€æ ˆå¸§çš„é”€æ¯è€Œé”€æ¯äº†ï¼Œå³locals()ä¸å¯å†è·å¾—ï¼Œä½†æ˜¯åµŒå¥—å‡½æ•°greetingä¼šä¿å­˜æ‰€éœ€çš„æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯è¯´greeting_confä¸­å®šä¹‰çš„éƒ¨åˆ†ï¼ˆä¸ºå†…å±‚å‡½æ•°æ‰€ä½¿ç”¨åˆ°çš„ï¼‰å±€éƒ¨å˜é‡ä¼šç»§ç»­å­˜åœ¨äºgreetingçš„__closure__å±æ€§ä¸­</span></span><br><span class="line">    <span class="keyword">return</span> greeting</span><br><span class="line">    </span><br><span class="line">mGreeting=greeting_conf(<span class="string">&#x27;Good Morning&#x27;</span>)</span><br><span class="line">aGreeting=greeting_conf(<span class="string">&#x27;Good Afternoon&#x27;</span>) <span class="comment">#ç»‘å®šäº†ä¸åŒ__closure__å±æ€§çš„é—­åŒ…å‡½æ•°aGreetingå’ŒmGreetingæ˜¯ä¸¤ä¸ªä¸åŒçš„å‡½æ•°å¯¹è±¡ï¼Œä¸¤è€…å…·æœ‰ä¸åŒçš„æ‰§è¡Œç¯å¢ƒï¼Œä½“ç°åœ¨ä¸¤è€…idçš„ä¸åŒ</span></span><br><span class="line">mGreeting(<span class="string">&#x27;dy&#x27;</span>)</span><br><span class="line">mGreeting(<span class="string">&#x27;zj&#x27;</span>)</span><br><span class="line">aGreeting(<span class="string">&#x27;dxd&#x27;</span>)</span><br><span class="line">aGreeting(<span class="string">&#x27;zj&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(mGreeting.__closure__,mGreeting.__closure__[<span class="number">0</span>].cell_contents)</span><br><span class="line">print(aGreeting.__closure__,aGreeting.__closure__[<span class="number">0</span>].cell_contents)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">Good Morning dy</span></span><br><span class="line"><span class="string">Good Morning zj</span></span><br><span class="line"><span class="string">Good Afternoon dxd</span></span><br><span class="line"><span class="string">Good Afternoon zj</span></span><br><span class="line"><span class="string">(&lt;cell at 0x000002A9B0E97288: str object at 0x000002A9B10DA170&gt;,) Good Morning</span></span><br><span class="line"><span class="string">(&lt;cell at 0x000002A9B10687C8: str object at 0x000002A9B10DA1B0&gt;,) Good Afternoon</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-2-2"><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¾ˆå¯èƒ½éœ€è¦å¯¹ä¸€äº›å·²æœ‰çš„å‡½æ•°è¿›è¡Œæ”¹è¿›ï¼Œå‡è®¾æœ‰ä¸€ä¸ªç”¨æˆ·æ³¨å†Œå‡½æ•°<code>register()</code>ï¼Œéœ€è¦æäº¤æ‰‹æœºå·ç ã€ç”¨æˆ·åå’Œæ³¨å†Œé‚®ç®±ä¿¡æ¯ï¼Œå…¶ä¸­æ‰‹æœºå·ç æ˜¯æ•°æ®åº“ä¸»é”®ï¼Œå…·æœ‰å”¯ä¸€æ€§ï¼Œæœ‰å¤©ä¸Šå¸è¦æ±‚ç”¨æˆ·åä¹Ÿå¿…é¡»å”¯ä¸€ï¼Œå‡ºäºæŸäº›åŸå› è¿˜ä¸èƒ½ç ´ååŸæœ‰ä»£ç ï¼Œæ€ä¹ˆåŠï¼Ÿä½¿ç”¨è£…é¥°å™¨å¯ä»¥è½»æ¾å®Œæˆè¿™ä¸€å·¥ä½œï¼Œåªéœ€è¦ç¼–å†™ä¸€ä¸ªæ£€æµ‹æ˜¯å¦å­˜åœ¨ç›¸åŒç”¨æˆ·åçš„è£…é¥°å™¨å‡½æ•°<code>if_unique_username()</code>ï¼Œç„¶ååœ¨åŸæœ‰çš„<code>register()</code>å‡½æ•°å®šä¹‰å‰æ·»åŠ ä¸€è¡Œè¯­å¥<code>@if_unique_username</code>å°±okäº†ï¼Œç­‰ä»·äºæ‰§è¡Œ<code>register=if_unique_username(register)</code>ï¼Œ<code>@</code>å°±æ˜¯ç®€åŒ–è¯¥æ“ä½œçš„è¯­æ³•ç³–ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">if_unique_username</span>(<span class="params">func</span>):</span> <span class="comment">#è£…é¥°å™¨å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">name,phone,email</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;DOC: æ£€æµ‹ç”¨æˆ·åå”¯ä¸€æ€§å‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;ç”¨æˆ·å§“åå”¯ä¸€æ€§æ£€æµ‹&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func(name,phone,email)</span><br><span class="line">    <span class="comment">#_.__doc__=func.__doc__ #å¦‚æœå€ŸåŠ©functoolsæ¨¡å—ï¼Œå¯ä»¥å°†æ­¤å¥æ›¿æ¢ä¸ºfunctools.update_wrapper(_,func)ï¼Œæ•ˆæœç­‰åŒäºä½¿ç”¨@functools.wraps(func)ä¿®é¥°_()å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> _</span><br><span class="line"></span><br><span class="line"><span class="meta">@if_unique_username </span><span class="comment">#è£…é¥°å™¨çš„å®ç°åŸç†ä¾æ®é—­åŒ…å‡½æ•°å¯ä»¥è®¿é—®å…¶æ‰§è¡Œç¯å¢ƒå˜é‡æˆ–è€…è¯´å¯ä»¥è®¿é—®å…¶åµŒå¥—ä½œç”¨åŸŸç©ºé—´å˜é‡ï¼Œè¿™ä¸ªåµŒå¥—ä½œç”¨åŸŸç©ºé—´æ˜¯ç»‘å®šåœ¨å‡½æ•°å¯¹è±¡ä¸Šçš„ï¼ˆ__closure__ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">name,phone,email</span>):</span> <span class="comment">#è¢«è£…é¥°å‡½æ•°</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;DOC: ç”¨æˆ·æ³¨å†Œå‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;ç”¨æˆ·(<span class="subst">&#123;name&#125;</span>,<span class="subst">&#123;phone&#125;</span>,<span class="subst">&#123;email&#125;</span>)æ³¨å†ŒæˆåŠŸ&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">register(<span class="string">&#x27;dy&#x27;</span>,<span class="string">&#x27;152618xxxxx&#x27;</span>,<span class="string">&#x27;31012xxxxx@qq.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">ç”¨æˆ·å§“åå”¯ä¸€æ€§æ£€æµ‹</span></span><br><span class="line"><span class="string">æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">ç”¨æˆ·(dy,152618xxxxx,31012xxxxx@qq.com)æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>æœ‰æ—¶å€™è¢«è£…é¥°å‡½æ•°å¸¦æœ‰å¤šç§ç±»å‹å‚æ•°ï¼Œè­¬å¦‚ä¸Šè¿°ç¤ºä¾‹ä¸­è£…é¥°å™¨<code>if_unique_username()</code>å†…å±‚å‡½æ•°ä¹Ÿéœ€è¦å®šä¹‰å’Œè¢«è£…é¥°å‡½æ•°<code>register</code>ä¸€æ¨¡ä¸€æ ·çš„å‚æ•°ï¼Œå…¶å®æ²¡å¿…è¦è¿™æ ·éº»çƒ¦ï¼Œå¯ä»¥ç”¨<code>(*args,**kwargs)</code>å‚æ•°ç»„åˆæ¥æ¥æ”¶ä»»æ„æ•°é‡çš„ä½ç½®æˆ–å…³é”®å­—å‚æ•°ï¼Œå› æ­¤å®ç°ä¸€ä¸ªé€šç”¨è£…é¥°å™¨å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>) </span><span class="comment">#æ›´ç®€æ˜“ä½¿ç”¨æˆ‘çš„æ”¹è¿›ç‰ˆ@wraps_fixï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args,**kwds</span>):</span> <span class="comment">#å³ä½¿æ²¡æœ‰å‚æ•°ä¹Ÿå¯ä»¥è¿™æ ·å†™</span></span><br><span class="line">        <span class="comment">#å…¶ä»–æ“ä½œ...</span></span><br><span class="line">        ret=func(*args,**kwds)</span><br><span class="line">        <span class="comment">#å…¶ä»–æ“ä½œ...</span></span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure><p>ç”±äºæ•°æ®é‡å¤ªå¤§ï¼Œä¸Šå¸å†³å®šå°†ç”¨æˆ·æ•°æ®åˆ†åœ°åŒºå­˜å‚¨åœ¨ä¸åŒçš„æ•°æ®åº“é‡Œï¼Œåœ¨ç™»é™†çš„æ—¶å€™æ ¹æ®ç”¨æˆ·çš„æ‰€åœ¨åœ°æ¥é€‰æ‹©ç›¸åº”çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿç»™è£…é¥°å™¨æŒ‡å®šä¸åŒçš„ï¼ˆåœ°åŒºï¼‰å‚æ•°ï¼Œæœ€ç»ˆæ•ˆæœå¤§æ¦‚æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@select_database(<span class="params">area=<span class="string">&#x27;æ±Ÿè‹&#x27;</span></span>) </span><span class="comment">#ç­‰åŒäºæ‰§è¡Œï¼šregister=select_database(area=&#x27;æ±Ÿè‹&#x27;)(register)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>():</span></span><br><span class="line">    <span class="comment">#ç”¨æˆ·æ³¨å†Œæ“ä½œ</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ä¾æ®è£…é¥°å™¨çš„åŸç†ï¼Œè¯¥åŠŸèƒ½å…¶å®ä¸éš¾å®ç°ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªä¸‰å±‚åµŒå¥—çš„è£…é¥°å™¨å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">select_database</span>(<span class="params">area</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_1</span>(<span class="params">func</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">_2</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;DOC: é€‰æ‹©åœ°åŒºæ•°æ®åº“å‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">            print(<span class="string">f&#x27;é€‰æ‹©<span class="subst">&#123;area&#125;</span>åœ°åŒºæ•°æ®åº“&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> func(*args,**kwargs)</span><br><span class="line">        <span class="comment">#_2.__doc__=func.__doc__ #å¦‚æœå€ŸåŠ©functoolsæ¨¡å—ï¼Œå¯ä»¥å°†æ­¤å¥æ›¿æ¢ä¸ºfunctools.update_wrapper(_2,func)ï¼Œæ•ˆæœç­‰åŒäºä½¿ç”¨@functools.wraps(func)ä¿®é¥°_2()å‡½æ•°</span></span><br><span class="line">        <span class="keyword">return</span> _2</span><br><span class="line">    <span class="keyword">return</span> _1</span><br><span class="line"></span><br><span class="line"><span class="meta">@select_database(<span class="params"><span class="string">&#x27;æ±Ÿè‹&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">name,phone,email</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;DOC: ç”¨æˆ·æ³¨å†Œå‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;ç”¨æˆ·(<span class="subst">&#123;name&#125;</span>,<span class="subst">&#123;phone&#125;</span>,<span class="subst">&#123;email&#125;</span>)æ³¨å†ŒæˆåŠŸ&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">register(<span class="string">&#x27;dy&#x27;</span>,<span class="string">&#x27;152618xxxxx&#x27;</span>,<span class="string">&#x27;31012xxxxx@qq.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">é€‰æ‹©æ±Ÿè‹åœ°åŒºæ•°æ®åº“</span></span><br><span class="line"><span class="string">æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">ç”¨æˆ·(dy,152618xxxxx,31012xxxxx@qq.com)æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å †ç Œå¤šä¸ªè£…é¥°å™¨ï¼ˆè£…é¥°å™¨é“¾ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@select_database(<span class="params"><span class="string">&#x27;æ±Ÿè‹&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@if_unique_username</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">name,phone,email</span>):</span> <span class="comment">#ç­‰åŒäºæ‰§è¡Œregister=select_database(&#x27;æ±Ÿè‹&#x27;)(if_unique_username(register))</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;DOC: ç”¨æˆ·æ³¨å†Œå‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;ç”¨æˆ·(<span class="subst">&#123;name&#125;</span>,<span class="subst">&#123;phone&#125;</span>,<span class="subst">&#123;email&#125;</span>)æ³¨å†ŒæˆåŠŸ&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">register(<span class="string">&#x27;dy&#x27;</span>,<span class="string">&#x27;152618xxxxx&#x27;</span>,<span class="string">&#x27;31012xxxxx@qq.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç°åœ¨æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå‡è®¾ä½ æŸ¥çœ‹ç»è¿‡ä¿®é¥°åçš„<code>register()</code>å‡½æ•°æ–‡æ¡£<code>register.__doc__</code>ï¼Œä¼šè¾“å‡º<code>DOC: é€‰æ‹©åœ°åŒºæ•°æ®åº“å‡½æ•°</code>ï¼Œè¿™ä¸ç¬¦åˆé¢„æœŸï¼Œä½†æ˜¯åŸå› ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå˜é‡åç§°<code>register</code>æœ€ç»ˆå·²å®é™…æŒ‡å‘<code>select_database()</code>ä¸­çš„å†…å±‚åµŒå¥—å‡½æ•°<code>_2()</code>ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆå®¹æ˜“ï¼Œåªè¦æ”¹ä¸€ä¸‹<code>_2()</code>çš„å‡½æ•°æ–‡æ¡£å°±å¥½äº†ï¼Œäºæ˜¯åœ¨<code>_2()</code>å‡½æ•°å®šä¹‰åå†™ä¸€å¥<code>_2.__doc__=func.__doc__</code>ã€åŒæ—¶åœ¨<code>if_unique_username()</code>ä¸­çš„å†…å±‚åµŒå¥—å‡½æ•°<code>_()</code>å®šä¹‰åå†™ä¸€å¥<code>_.__doc__=func.__doc__</code>å³å¯ï¼Œå½“ç„¶ä¸åªæ˜¯<code>__doc__</code>å±æ€§ï¼Œ<code>__name__</code>ç­‰å‡½æ•°å±æ€§ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œå¦å¤–ï¼Œä¸Šè¿°æ“ä½œè¿˜å¯ä»¥é€šè¿‡è£…é¥°å™¨æ¥å®ç°ä»¥ç®€åŒ–è°ƒç”¨ï¼ˆè§ä¸‹æˆ‘è‡ªå®šä¹‰çš„<code>wraps()</code>å‡½æ•°ï¼Œç„¶ååˆ†åˆ«åœ¨<code>_2()</code>å‡½æ•°å’Œ<code>_()</code>å‡½æ•°å®šä¹‰ä¸Šæ–¹å†™ä¸Šä¸€å¥<code>@wraps(func)</code>å³å¯ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wraps</span>(<span class="params">foo</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_1</span>(<span class="params">func</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">_2</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">            <span class="keyword">return</span> func(*args,**kwargs)</span><br><span class="line">        _2.__name__=foo.__name__ <span class="comment">#æ­¤å¤„åªä¿®æ”¹äº†__name__å’Œ__doc__å±æ€§ï¼Œä»…ä½œä¸ºdemoå±•ç¤º</span></span><br><span class="line">        _2.__doc__=foo.__doc__</span><br><span class="line">        <span class="keyword">return</span> _2</span><br><span class="line">    <span class="keyword">return</span> _1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>():</span> <span class="comment">#ä¿®é¥°åçš„wrapperå˜é‡åç§°å®é™…æŒ‡å‘wraps()ä¸­çš„å†…å±‚åµŒå¥—å‡½æ•°_2()ï¼Œäºæ˜¯åŸå§‹è¢«è£…é¥°å‡½æ•°fooå˜é‡åç§°ä¹Ÿæ˜¯æŒ‡å‘_2()å‡½æ•°ï¼Œå› æ­¤è¦å°†foo()çš„å‡½æ•°æ–‡æ¡£èµ‹ç»™_2.__doc__å³å¯</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator </span><span class="comment">#ç­‰åŒäºæ‰§è¡Œï¼šfoo=decorator(foo)=wraps(foo)(wrapper)ï¼Œäºæ˜¯fooå˜é‡åå®é™…æŒ‡å‘wraps()ä¸­çš„_2()å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;foo function&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;åŸå‡½æ•°&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">print(foo.__name__) <span class="comment">#foo</span></span><br><span class="line">print(foo.__doc__) <span class="comment">#foo function</span></span><br></pre></td></tr></table></figure><p>ä¸è¿‡æ ‡å‡†çš„è§£å†³æ–¹æ¡ˆè¿˜æ˜¯è°ƒç”¨<code>functools</code>æ¨¡å—çš„<code>@wraps</code>è£…é¥°å™¨ï¼Œç”¨æ³•åŒä¸Šï¼Œå®˜æ–¹å®ç°å¦‚ä¸‹ï¼ˆå€ŸåŠ©åå‡½æ•°ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">WRAPPER_ASSIGNMENTS = (<span class="string">&#x27;__module__&#x27;</span>, <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__qualname__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__annotations__&#x27;</span>)</span><br><span class="line">RAPPER_UPDATES = (<span class="string">&#x27;__dict__&#x27;</span>,)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_wrapper</span>(<span class="params">wrapper,</span></span></span><br><span class="line"><span class="function"><span class="params">                   wrapped,</span></span></span><br><span class="line"><span class="function"><span class="params">                   assigned = WRAPPER_ASSIGNMENTS,</span></span></span><br><span class="line"><span class="function"><span class="params">                   updated = WRAPPER_UPDATES</span>):</span></span><br><span class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> assigned:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            value = <span class="built_in">getattr</span>(wrapped, attr)</span><br><span class="line">        <span class="keyword">except</span> AttributeError:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(wrapper, attr, value)</span><br><span class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> updated:</span><br><span class="line">        <span class="built_in">getattr</span>(wrapper, attr).update(<span class="built_in">getattr</span>(wrapped, attr, &#123;&#125;))</span><br><span class="line">    wrapper.__wrapped__ = wrapped</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wraps</span>(<span class="params">wrapped,</span></span></span><br><span class="line"><span class="function"><span class="params">          assigned = WRAPPER_ASSIGNMENTS,</span></span></span><br><span class="line"><span class="function"><span class="params">          updated = WRAPPER_UPDATES</span>):</span></span><br><span class="line">    <span class="keyword">return</span> partial(update_wrapper, wrapped=wrapped,</span><br><span class="line">                   assigned=assigned, updated=updated)</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šè¿°æºç ï¼Œé™¤äº†ä½¿ç”¨<code>@wraps</code>ä¿®é¥°å¤–ï¼Œè¿˜æœ‰ä¸€ç§ç”¨æ³•ï¼ˆç›´æ¥è°ƒç”¨<code>update_wrapper()</code>å‡½æ•°ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> update_wrapper</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>():</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    update_wrapper(wrapper,func)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;foo function&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;åŸå‡½æ•°&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">print(foo.__name__) <span class="comment">#foo</span></span><br><span class="line">print(foo.__doc__) <span class="comment">#foo function</span></span><br></pre></td></tr></table></figure><p>å¦å¤–è¿˜å¯ä»¥é€šè¿‡<code>foo=foo.__wrapped__</code>æ–¹ä¾¿åœ°å°†è¢«è£…é¥°å‡½æ•°æ¢å¤ä¸ºåŸå‡½æ•°ï¼ˆå³â€œè§£é™¤è£…é¥°å™¨â€ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨<code>@functools.wraps</code>ï¼Œé‚£ä¹ˆ<code>__wrapped__</code>å±æ€§æ˜¯ä¸å¯è·å¾—çš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä»…ä»…é€‚ç”¨äºå•ä¸ªè£…é¥°å™¨çš„æƒ…å†µï¼Œå‡è®¾ä½ å †ç Œäº†å¤šä¸ªè£…é¥°å‡½æ•°ï¼Œé‚£ä¹ˆè®¿é—®<code>__wrapped__</code>å±æ€§è·å–åˆ°çš„å°±ä¸å†æ˜¯åŸå‡½æ•°äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator1</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper1</span>():</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper1 function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•1&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    <span class="keyword">return</span> wrapper1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator2</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper2</span>():</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper2 function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•2&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    <span class="keyword">return</span> wrapper2</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator2</span></span><br><span class="line"><span class="meta">@decorator1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;foo function&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;åŸå‡½æ•°&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">foo.__wrapped__() <span class="comment">#ç»“æœæŒ‡å‘decorator1()ä¸­çš„å†…å±‚å‡½æ•°wrapper1()ï¼Œè€Œéå¸Œæœ›çš„foo()ï¼ŒåŸå› ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œä¸Šé¢å¯¹foo()çš„ä¿®é¥°ï¼Œç­‰åŒäºæ‰§è¡Œäº†foo=decorator2(decorator1(foo))ï¼Œå…·ä½“çš„ï¼Œç¬¬ä¸€æ­¥æ‰§è¡Œtemp=decorator1(foo)æ—¶ï¼Œæ ¹æ®functools.wrapsåŸç†ï¼Œäºæ˜¯wrapper1.__wrapped__å±æ€§è¢«èµ‹å€¼ä¸ºfooï¼Œå³æŒ‡å‘foo()å‡½æ•°ï¼Œç¬¬äºŒæ­¥æ‰§è¡Œdecorator2(temp)æ—¶ï¼Œäºæ˜¯wrapper2.__wrapped__å±æ€§è¢«èµ‹å€¼ä¸ºtempï¼Œè€Œtempå˜é‡å®é™…æŒ‡å‘wrapper1()å‡½æ•°ï¼Œå¦ä¿®é¥°åçš„fooå˜é‡å®é™…æŒ‡å‘wrapper2()å‡½æ•°ï¼Œäºæ˜¯foo.__wrapped__è¿”å›çš„æ˜¯wrapper1()ï¼ˆé—­åŒ…ï¼‰å‡½æ•°ï¼Œä¸è¿‡è¿™æ—¶ä½ ä¹Ÿå‘ç°äº†ï¼Œè¦è·å–åˆ°åŸå‡½æ•°ï¼Œåªè¦å†è¿ˆå‡ºä¸€æ­¥ï¼Œå³è°ƒç”¨foo.__wrapped__.__wrapped__ï¼Œè¿”å›çš„å°±æ˜¯åŸå§‹çš„foo()å‡½æ•°äº†</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">åŠŸèƒ½æ‰©å±•1</span></span><br><span class="line"><span class="string">åŸå‡½æ•°</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¦æƒ³å®ç°å¤šè£…é¥°å™¨çš„è§£é™¤ï¼Œå¯ä»¥ç¨ç¨ä¿®æ”¹<code>update_wrapper()</code>å‡½æ•°æºç ï¼ˆåŸä½œè€…æ²¡æœ‰å‘ç°è¯¥é—®é¢˜å—ï¼Ÿï¼‰ï¼š</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def update_wrapper(wrapper,</span><br><span class="line">                   wrapped,</span><br><span class="line">                   assigned = WRAPPER_ASSIGNMENTS,</span><br><span class="line">                   updated = WRAPPER_UPDATES):</span><br><span class="line">    for attr in assigned:</span><br><span class="line">        try:</span><br><span class="line">            value = getattr(wrapped, attr)</span><br><span class="line">        except AttributeError:</span><br><span class="line">            pass</span><br><span class="line">        else:</span><br><span class="line">            setattr(wrapper, attr, value)</span><br><span class="line">    for attr in updated:</span><br><span class="line">        getattr(wrapper, attr).update(getattr(wrapped, attr, &#123;&#125;))</span><br><span class="line"><span class="deletion">-   wrapper.__wrapped__ = wrapped</span></span><br><span class="line"><span class="addition">+   if hasattr(wrapped, &#x27;__wrapped__&#x27;):</span></span><br><span class="line"><span class="addition">+       wrapper.__wrapped__ = getattr(wrapped, &#x27;__wrapped__&#x27;)</span></span><br><span class="line"><span class="addition">+   else:</span></span><br><span class="line"><span class="addition">+       wrapper.__wrapped__ = wrapped</span></span><br><span class="line">    return wrapper</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸æƒ³ä¿®æ”¹æºç ï¼Œå¯ä»¥è¿™æ ·æ”¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator1</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper1</span>():</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper1 function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•1&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    <span class="comment">###é¢å¤–æ·»åŠ çš„ä»£ç </span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(func,<span class="string">&#x27;__wrapped__&#x27;</span>):</span><br><span class="line">        wrapper1.__wrapped__=<span class="built_in">getattr</span>(func,<span class="string">&#x27;__wrapped__&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        wrapper1.__wrapped__=func</span><br><span class="line">    <span class="comment">###ä»¥å®ç°å¤šè£…é¥°å™¨çš„æ­£å¸¸è§£é™¤</span></span><br><span class="line">    <span class="keyword">return</span> wrapper1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator2</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper2</span>():</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper2 function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•2&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    <span class="comment">###é¢å¤–æ·»åŠ çš„ä»£ç </span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(func,<span class="string">&#x27;__wrapped__&#x27;</span>):</span><br><span class="line">        wrapper2.__wrapped__=<span class="built_in">getattr</span>(func,<span class="string">&#x27;__wrapped__&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        wrapper2.__wrapped__=func</span><br><span class="line">    <span class="comment">###ä»¥å®ç°å¤šè£…é¥°å™¨çš„æ­£å¸¸è§£é™¤</span></span><br><span class="line">    <span class="keyword">return</span> wrapper2</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator2</span></span><br><span class="line"><span class="meta">@decorator1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;foo function&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;åŸå‡½æ•°&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">foo.__wrapped__() <span class="comment">#åŸå‡½æ•°</span></span><br></pre></td></tr></table></figure><p>ä»£ç å¾ˆç®€å•ï¼Œç¼ºç‚¹æ˜¯ä»£ç é‡å¤ç¼–å†™ï¼Œæ­¤å¤„æˆ‘å†ç»™å‡ºä¸€ç§è§£å†³æ–¹æ¡ˆğŸ’¡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wraps_fix</span>(<span class="params">f1</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_1</span>(<span class="params">f2</span>):</span></span><br><span class="line"><span class="meta">        @wraps(<span class="params">f1</span>)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">_2</span>(<span class="params">*args,**kwds</span>):</span></span><br><span class="line">            <span class="keyword">return</span> f2(*args,**kwds)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(f1,<span class="string">&#x27;__wrapped__&#x27;</span>):</span><br><span class="line">            _2.__wrapped__=<span class="built_in">getattr</span>(f1,<span class="string">&#x27;__wrapped__&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _2.__wrapped__=f1</span><br><span class="line">        <span class="keyword">return</span> _2</span><br><span class="line">    <span class="keyword">return</span> _1</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator1</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps_fix(<span class="params">func</span>) </span><span class="comment">#å®Œç¾ï¼</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper1</span>():</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper1 function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•1&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    <span class="keyword">return</span> wrapper1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator2</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps_fix(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper2</span>():</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;wrapper2 function&#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;åŠŸèƒ½æ‰©å±•2&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func()</span><br><span class="line">    <span class="keyword">return</span> wrapper2</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator2</span></span><br><span class="line"><span class="meta">@decorator1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;foo function&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;åŸå‡½æ•°&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">foo.__wrapped__() <span class="comment">#åŸå‡½æ•°</span></span><br></pre></td></tr></table></figure><p>é™¤äº†ä½¿ç”¨ä¸‰å±‚åµŒå¥—å‡½æ•°å®ç°å¸¦å‚æ•°çš„è£…é¥°å™¨ï¼Œè¿˜å¯ä»¥å€ŸåŠ©åå‡½æ•°å®ç°ï¼Œä»ä»¥é€‰æ‹©åœ°åŒºæ•°æ®åº“æ³¨å†Œç”¨æˆ·ä¸ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps,partial</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">select_database2</span>(<span class="params">area,func=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> func <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> partial(select_database2,area)</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;é€‰æ‹©<span class="subst">&#123;area&#125;</span>åœ°åŒºæ•°æ®åº“&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> func(*args,**kwargs)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@select_database2(<span class="params"><span class="string">&#x27;æ±Ÿè‹&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">name,phone,email</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;DOC: ç”¨æˆ·æ³¨å†Œå‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;ç”¨æˆ·(<span class="subst">&#123;name&#125;</span>,<span class="subst">&#123;phone&#125;</span>,<span class="subst">&#123;email&#125;</span>)æ³¨å†ŒæˆåŠŸ&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">register(<span class="string">&#x27;dy&#x27;</span>,<span class="string">&#x27;152618xxxxx&#x27;</span>,<span class="string">&#x27;31012xxxxx@qq.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">é€‰æ‹©æ±Ÿè‹åœ°åŒºæ•°æ®åº“</span></span><br><span class="line"><span class="string">æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">ç”¨æˆ·(dy,152618xxxxx,31012xxxxx@qq.com)æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>ç½‘ä¸Šçœ‹åˆ°ä¸€ç§é€šè¿‡ç±»å®ç°å¸¦å‚è£…é¥°å™¨çš„æ–¹æ³•ï¼Œæ ¸å¿ƒæ˜¯å€ŸåŠ©äºç‰¹æ®Šå‡½æ•°<code>__call__()</code>ä½¿ç±»å®ä¾‹å˜å¾—å¯è°ƒç”¨ï¼Œæ­¤æ—¶ä¸Šè¿°æ¡ˆä¾‹å¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">select_database3</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,area</span>):</span></span><br><span class="line">        self.area=area</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self,func</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">            print(<span class="string">f&#x27;é€‰æ‹©<span class="subst">&#123;self.area&#125;</span>åœ°åŒºæ•°æ®åº“&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> func(*args,**kwargs)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@select_database3(<span class="params"><span class="string">&#x27;æ±Ÿè‹&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">name,phone,email</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;DOC: ç”¨æˆ·æ³¨å†Œå‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;ç”¨æˆ·(<span class="subst">&#123;name&#125;</span>,<span class="subst">&#123;phone&#125;</span>,<span class="subst">&#123;email&#125;</span>)æ³¨å†ŒæˆåŠŸ&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">register(<span class="string">&#x27;dy&#x27;</span>,<span class="string">&#x27;152618xxxxx&#x27;</span>,<span class="string">&#x27;31012xxxxx@qq.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">é€‰æ‹©æ±Ÿè‹åœ°åŒºæ•°æ®åº“</span></span><br><span class="line"><span class="string">æ‰‹æœºå·å”¯ä¸€æ€§æ£€æµ‹</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">ç”¨æˆ·(dy,152618xxxxx,31012xxxxx@qq.com)æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¸å¸¦å‚æ•°çš„é€šç”¨çš„åŸºäºç±»å®ç°çš„è£…é¥°å™¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> update_wrapper</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">decorator</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,func</span>):</span></span><br><span class="line">        self.func=func</span><br><span class="line">        update_wrapper(self,self.func)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self,*args,**kwargs</span>):</span></span><br><span class="line">        <span class="comment">#å…¶ä»–æ“ä½œ...</span></span><br><span class="line">        ret=self.func(*args,**kwargs)</span><br><span class="line">        <span class="comment">#å…¶ä»–æ“ä½œ...</span></span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure><p>æœ€åå†çœ‹å‡ ä¸ªè£…é¥°å™¨å®ç°çš„æ¡ˆä¾‹ï¼Œä¸€æ˜¯<code>@singledispatch</code>ï¼Œè¢«<code>@singledispatch</code>è£…é¥°çš„æ™®é€šå‡½æ•°ä¼šå˜ä¸ºæ³›å‡½æ•°ï¼Œå³æ ¹æ®ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹ä»¥ä¸åŒæ–¹å¼æ‰§è¡Œé‡è½½å‡½æ•°ï¼Œç§°ä¸ºå•åˆ†æ´¾ï¼ˆè€Œæ ¹æ®å¤šä¸ªå‚æ•°é€‰æ‹©æŒ‡å®šçš„å‡½æ•°ï¼Œç§°ä¸ºå¤šåˆ†æ´¾ï¼Œé¡¾åæ€ä¹‰<code>singledispatch</code>æ˜¯å•åˆ†æ´¾ï¼‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> singledispatch</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cattle</span>:</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;ç‰›&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;cattle&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fish</span>:</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;é±¼&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;fish&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@singledispatch</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">eat</span>(<span class="params">obj</span>):</span> <span class="comment">#(1) #eatæ˜¯æ³›å‡½æ•°ï¼Œä»»æ„ç±»å¯¹è±¡åªè¦æ²¡æœ‰â€œæ³¨å†Œâ€éƒ½å°†è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¯¹äºæ³¨å†Œäº†çš„è­¬å¦‚cattleå’Œfishç±»ï¼Œåˆ™è°ƒç”¨å¯¹åº”çš„é‡è½½å‡½æ•°</span></span><br><span class="line">    print(<span class="built_in">str</span>(obj)+<span class="string">&#x27; eats something&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@eat.register(<span class="params">cattle</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">obj</span>):</span> <span class="comment">#(2) #_æ˜¯ä¸€ä¸ªæ— æ„ä¹‰åå­—ï¼Œå½“ç„¶ä¹Ÿå¯å–åä¸ºcattle_eat</span></span><br><span class="line">    print(<span class="built_in">str</span>(obj)+<span class="string">&#x27; eats grass&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@eat.register(<span class="params">fish</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">obj</span>):</span> <span class="comment">#(3)</span></span><br><span class="line">    print(<span class="built_in">str</span>(obj)+<span class="string">&#x27; eats shrimp&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">eat(cattle()) <span class="comment">#cattle eats grass</span></span><br><span class="line">eat(fish()) <span class="comment">#fish eats shrimp</span></span><br><span class="line">eat(<span class="string">&#x27;muggledy&#x27;</span>) <span class="comment">#muggledy eats something</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åŠ¨ç‰©éƒ½éœ€è¦è¿›é£Ÿï¼Œä½†æ˜¯ä¸åŒå¯¹è±¡â€œåƒâ€çš„è¡Œä¸ºå´å„ä¸ç›¸åŒï¼Œç‰›åƒè‰ã€å°é±¼åƒè™¾ç±³ç­‰ç­‰ï¼Œå¦‚æœç”¨é¢å‘å¯¹è±¡ç»§æ‰¿æ–¹å¼å®ç°ï¼ŒåŸºç±»â€œåƒâ€çš„æ–¹æ³•å°±æ˜¯ä¸Šè¿°ä»£ç ä¸­çš„(1)ï¼Œç‰›ç»§æ‰¿åŸºç±»å¹¶é‡è½½â€œåƒâ€çš„æ–¹æ³•ï¼Œè§(2)ï¼ŒåŒç†ï¼Œå°é±¼çš„â€œåƒâ€è§(3)</span></span><br></pre></td></tr></table></figure><p>äºŒæ˜¯å¸¦è®°å¿†è£…ç½®çš„æ–æ³¢é‚£å¥‘æ•°é¡¹è®¡ç®—ï¼Œä¸Šä¸€ç« æˆ‘ä»¬è®¨è®ºè¿‡äº†ä½¿ç”¨é€’å½’è®¡ç®—æ–æ³¢é‚£å¥‘æ•°é¡¹çš„é—®é¢˜ï¼Œä»£ç å¾ˆå®¹æ˜“ç†è§£ï¼Œä½†æ˜¯æ€§èƒ½å´ååˆ†å·®ï¼Œè¦æ”¹è¿›å®ƒï¼Œä¸€ä¸ªåˆç†çš„æƒ³æ³•æ˜¯ä¸ºå…¶é…å¤‡â€œè®°å¿†è£…ç½®â€ï¼Œå¯¹äºè®¡ç®—è¿‡äº†çš„å€¼æˆ‘ä»¬ç›´æ¥ä»ä¸­è·å–ä»¥å…é‡å¤è®¡ç®—é€ æˆèµ„æºæµªè´¹ï¼Œåˆ©ç”¨è£…é¥°å™¨æˆ‘ä»¬ä¸éœ€è¦ç ´ååŸæœ‰ä»£ç ï¼Œååˆ†ä¼˜ç¾ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">memory</span>(<span class="params">func</span>):</span></span><br><span class="line">    m=&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">n</span>):</span></span><br><span class="line">        <span class="keyword">if</span> m.get(n) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            m[n]=func(n)</span><br><span class="line">        <span class="keyword">return</span> m[n]</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@memory</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Fibonacci</span>(<span class="params">n=<span class="number">6</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">2</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> Fibonacci(n-<span class="number">2</span>)+Fibonacci(n-<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">print(Fibonacci(<span class="number">35</span>))</span><br></pre></td></tr></table></figure><div class="hide-toggle"><div class="hide-button toggle-title"><i class="fas fa-caret-right fa-fw"></i><span><code>@lru_cache</code></span></div><div class="hide-content"><p>ç”±äºè®¡ç®—æœºå†…å­˜æœ‰é™ï¼Œè®°å¿†è£…ç½®çš„ç¼“å­˜å¤§å°ä¹Ÿåº”å—é™ï¼Œä½†æˆ‘ä»¬è¦åšçš„ä¸ä»…ä»…æ˜¯é™åˆ¶ç¼“å­˜å¤§å°ï¼Œè¿˜è¦åŸºäºLRUï¼ˆLeast Recently Usedï¼‰â€œæœ€è¿‘æœ€å°‘ä½¿ç”¨â€æ€æƒ³æ¥ç§»é™¤ç¼“å­˜ä¸­çš„è¿‡æ—¶æ•°æ®ï¼Œè¯¥ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®æœ€è¿‘è¢«è®¿é—®è¿‡ï¼Œåˆ™æœ‰ç†ç”±ç›¸ä¿¡å®ƒåœ¨å°†æ¥è¢«è®¿é—®çš„æ¦‚ç‡ä¹Ÿå¾ˆé«˜ï¼Œåä¹‹ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®æœ€è¿‘æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å¯ä»¥è®¤ä¸ºå®ƒåœ¨å°†æ¥è¢«è®¿é—®çš„æ¦‚ç‡ä¹Ÿå¾ˆä½ï¼Œå®ç°å®ƒçš„æœ€ä½³æ–¹å¼æ˜¯ä½¿ç”¨â€œåŸºäºLRUçš„æœ‰åºå­—å…¸â€æ¥å®ç°ï¼ˆæŒ‰ç…§è®¿é—®é¢‘ç‡é«˜ä½æŒ‰åºæ’åˆ—ï¼Œè¿™å°±éœ€è¦ä¸€ä¸ªçº¿æ€§è¡¨ï¼Œä½†æ˜¯çº¿æ€§è¡¨æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œè€ƒè™‘åˆ°å­—å…¸æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œå› æ­¤å¯ä»¥é€šè¿‡nextæŒ‡é’ˆå°†å­—å…¸ä¸­çš„å…ƒç´ ä¾æ¬¡ä¸²è”èµ·æ¥ï¼Œæ„æˆä¸€ä¸ªæœ‰åºå­—å…¸ï¼‰ï¼Œå®˜æ–¹æ–‡æ¡£<code>collections.OrderedDict</code>ä¸­åŸºäº<code>OrderedDict</code>å®ç°äº†è¿™æ ·ä¸€ä¸ªLRUå­—å…¸ï¼Œä»£ç ç®€æ´æ˜äº†ï¼ˆæœ€åç”¨ä¸‹è¿°<code>LRU</code>æ›¿æ¢æˆ‘ä¸Šé¢å†™çš„<code>memory</code>è£…é¥°å™¨å‡½æ•°ä¸­çš„å˜é‡<code>m</code>å³å¯ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRU</span>(<span class="params">OrderedDict</span>):</span></span><br><span class="line">    <span class="string">&#x27;Limit size, evicting the least recently looked-up key when full&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, maxsize=<span class="number">128</span>, *args, **kwds</span>):</span></span><br><span class="line">        self.maxsize = maxsize</span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwds)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        value = <span class="built_in">super</span>().__getitem__(key)</span><br><span class="line">        self.move_to_end(key)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setitem__</span>(<span class="params">self, key, value</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__setitem__(key, value)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self) &gt; self.maxsize:</span><br><span class="line">            oldest = <span class="built_in">next</span>(<span class="built_in">iter</span>(self))</span><br><span class="line">            <span class="keyword">del</span> self[oldest]</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¿›å…¥æ­£é¢˜ï¼Œçœ‹çœ‹<code>@lru_cache</code>çš„å…·ä½“ä½¿ç”¨ï¼Œé¦–å…ˆå¯¼å…¥ï¼š<code>from functools import lru_cache</code>ï¼Œç„¶åç”¨äºè£…é¥°ä½ å¸Œæœ›è¢«è£…é¥°çš„é€’å½’å‡½æ•°ï¼š<code>@lru_cache(maxsize=128, typed=False)</code>ï¼Œå¾…ç¼“å­˜æ¡ç›®æ˜¯è¢«è£…é¥°å‡½æ•°çš„è¾“å…¥ï¼ˆä½œä¸ºç¼“å­˜é¡¹çš„é”®ï¼‰å’Œè¾“å‡ºï¼ˆä½œä¸ºç¼“å­˜é¡¹çš„å€¼ï¼‰ï¼Œå¦‚æœ<code>maxsize</code>å‚æ•°è®¾ä¸º<code>None</code>ï¼Œé‚£ä¹ˆç¼“å­˜å¯ä»¥æ— é™åˆ¶å¢é•¿ï¼Œè€Œå½“<code>maxsize</code>æ˜¯2çš„æ¬¡å¹‚æ—¶ï¼ŒLRUåŠŸèƒ½è¡¨ç°æœ€ä½³ï¼Œå¦‚æœ<code>typed</code>å‚æ•°è®¾ä¸º<code>True</code>ï¼Œé‚£ä¹ˆåŒä¸€æ•°å€¼ä½†ç±»å‹ä¸åŒçš„å‡½æ•°å‚æ•°è°ƒç”¨å°†å¯¹åº”ä¸åŒçš„ç¼“å­˜é¡¹ï¼ˆé¡»çŸ¥ï¼Œå¯¹äºè¢«è£…é¥°å‡½æ•°ï¼Œç›¸åŒè¾“å…¥å¿…é¡»å…·æœ‰ç›¸åŒè¾“å‡ºï¼Œå‡è®¾è¾“å‡ºä¸å…·æœ‰ç¡®å®šæ€§ï¼Œè­¬å¦‚å—åˆ¶äºéšæœºæ€§å‡½æ•°ï¼Œåˆ™<code>@lru_cache</code>å¤±æ•ˆï¼Œæ— æ³•è¾¾åˆ°èŠ‚çœæ—¶é—´çš„æ•ˆæœï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</span><br><span class="line"></span><br><span class="line"><span class="meta">@lru_cache(<span class="params">maxsize=<span class="number">128</span>, typed=<span class="literal">False</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Fibonacci</span>(<span class="params">n=<span class="number">6</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">2</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> Fibonacci(n-<span class="number">2</span>)+Fibonacci(n-<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">print(Fibonacci(<span class="number">35</span>)) <span class="comment">#9227465</span></span><br></pre></td></tr></table></figure><p>è£…é¥°å™¨<code>@lru_cache</code>æä¾›äº†<code>cache_clear()</code>æ–¹æ³•ç”¨äºæ¸…é™¤ç¼“å­˜æˆ–ä½¿ç¼“å­˜æ— æ•ˆã€‚ä¸€èˆ¬è¯´æ¥ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨è£…é¥°å™¨ä¹‹åï¼Œå°†â€œä¸¢å¤±â€è¢«è£…é¥°å‡½æ•°ï¼Œè¢«è£…é¥°å‡½æ•°çš„åå­—æ€»æ˜¯æŒ‡å‘è£…é¥°å‡½æ•°ï¼Œä½†<code>@lru_cache</code>ç±»ä¼¼<code>@wraps</code>è¿˜æä¾›äº†<code>__wrapped__</code>å±æ€§ï¼ŒæŒ‡å‘åŸå§‹è¢«è£…é¥°å‡½æ•°</p></div></div>ä¸‰æ˜¯ä½¿ç”¨<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jianshu.com/p/30a8e723efdc">è£…é¥°å™¨ä¿®é¥°ç±»å¯¹è±¡</a>ï¼Œå˜ç›¸åœ°æ‰§è¡Œç»§æ‰¿ï¼Œå·²çŸ¥æœ‰ä¸€ä¸ªé™å®šäº†å®ä¾‹å±æ€§çš„ç±»ï¼Œè¦æ‰©å±•ä¸€ä¸ªé¢å¤–çš„å±æ€§ï¼Œä½†æ˜¯ä¸å…è®¸ç ´ååŸæœ‰ä»£ç ï¼Œæ˜¾ç„¶è§£å†³åŠæ³•æ˜¯ç»§æ‰¿è¿™ä¸ªç±»ï¼Œå¹¶ä½¿æ–°ç±»ä»£æ›¿æ—§ç±»ï¼Œè¯¥è¿‡ç¨‹å¯ä»¥é€šè¿‡è£…é¥°å™¨å®ç°ï¼Œæ¯”è¾ƒæ–°å¥‡ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addLength</span>(<span class="params">oldcls</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">NewClass</span>(<span class="params">oldcls</span>):</span></span><br><span class="line">        __slots__=[<span class="string">&#x27;_length&#x27;</span>]</span><br><span class="line">        </span><br><span class="line"><span class="meta">        @property</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">length</span>(<span class="params">self</span>):</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hasattr</span>(self, <span class="string">&#x27;__len__&#x27;</span>):</span><br><span class="line">                self._length = <span class="built_in">len</span>(self)</span><br><span class="line">            <span class="keyword">return</span> self._length</span><br><span class="line">        </span><br><span class="line"><span class="meta">        @length.setter</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">length</span>(<span class="params">self, value</span>):</span></span><br><span class="line">            self._length = value</span><br><span class="line">    <span class="keyword">return</span> NewClass <span class="comment">#è¿”å›ç»§æ‰¿è‡ªï¼ˆoldclsï¼‰æ—§ç±»Toolçš„æ–°ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@addLength</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span>:</span> <span class="comment">#Tool=addLength(Tool)ï¼Œå˜é‡åç§°ToolæŒ‡å‘ç»§æ‰¿Toolçš„æ–°ç±»NewClass</span></span><br><span class="line">    __slots__=[<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;height&#x27;</span>]</span><br><span class="line"></span><br><span class="line">t = Tool()</span><br><span class="line">t.width=<span class="number">8</span></span><br><span class="line">t.height=<span class="number">9</span></span><br><span class="line">t.length = <span class="number">10</span> <span class="comment">#æ–°å¢å±æ€§</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-2-3"><p>è¿˜æ˜¯ä»¥ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å‡½æ•°<code>register()</code>ä¸ºä¾‹ï¼Œè®¾å…¶æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç”¨æˆ·æ‰€å±å›½å®¶<code>country</code>å’Œå§“å<code>name</code>ï¼Œå¯¹äºæŸä¸€åœ°åŒºï¼Œç»å¤§éƒ¨åˆ†äººçš„å›½å®¶å±æ€§ç›¸åŒï¼Œé‚£ä¹ˆç†åº”ç»™<code>country</code>å‚æ•°è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œä»è€Œç®€åŒ–è°ƒç”¨ï¼Œå…·ä½“çš„ï¼Œå®šä¹‰ä¸€ä¸ªå‚æ•°é…ç½®å‡½æ•°<code>configure()</code>ï¼Œæ¥æ”¶åŸå‡½æ•°<code>register</code>åœ°å€å’Œè¦è®¾ç½®çš„å‚æ•°<code>country</code>å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªé—­åŒ…å‡½æ•°ï¼ˆç§°ä¸ºåŸå‡½æ•°çš„â€œåå‡½æ•°â€ï¼‰ï¼Œå½“è°ƒç”¨æ­¤é—­åŒ…å‡½æ•°æ—¶ï¼Œåªéœ€è¦å†ä¼ å…¥å‰©ä¸‹çš„<code>name</code>å‚æ•°ï¼Œé—­åŒ…å‡½æ•°å†…éƒ¨ä¼šæ ¹æ®ä¹‹å‰ä¿å­˜çš„<code>country</code>å‚æ•°å’Œåˆšä¼ å…¥çš„<code>name</code>å‚æ•°å»æ‰§è¡ŒåŸå‡½æ•°<code>register()</code>å®ç°ç”¨æˆ·æ³¨å†Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">country,name</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;[<span class="subst">&#123;country&#125;</span>]<span class="subst">&#123;name&#125;</span>ç”¨æˆ·æ³¨å†Œ&#x27;</span>)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">register(<span class="string">&#x27;ä¸­å›½&#x27;</span>,<span class="string">&#x27;muggle&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">configure</span>(<span class="params">func,country</span>):</span> <span class="comment">#pythonå†…ç½®çš„å®ç°ç›¸åŒåŠŸèƒ½çš„å‡½æ•°åç§°å«åšpartial</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">name</span>):</span></span><br><span class="line">        <span class="keyword">return</span> func(country,name)</span><br><span class="line">    <span class="keyword">return</span> _</span><br><span class="line">    </span><br><span class="line">register_china=configure(register,<span class="string">&#x27;ä¸­å›½&#x27;</span>)</span><br><span class="line">register_china(<span class="string">&#x27;msy&#x27;</span>)</span><br><span class="line">register_china(<span class="string">&#x27;xiaodong&#x27;</span>)</span><br><span class="line"></span><br><span class="line">register_japan=configure(register,<span class="string">&#x27;æ—¥æœ¬&#x27;</span>)</span><br><span class="line">register_japan(<span class="string">&#x27;è‰¹&#x27;</span>)</span><br><span class="line">register_japan(<span class="string">&#x27;SB&#x27;</span>)</span><br></pre></td></tr></table></figure><p>é€šç”¨çš„é…ç½®å‡½æ•°å½¢å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">configure</span>(<span class="params">func,*args1,**kwargs1</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">*args2,**kwargs2</span>):</span></span><br><span class="line">        <span class="keyword">return</span> func(*args1,*args2,**kwargs1,**kwargs2)</span><br><span class="line">    <span class="keyword">return</span> _</span><br></pre></td></tr></table></figure><p>æ‰€è°“åå‡½æ•°ï¼ˆæˆ–è€…ç¿»è¯‘æˆå±€éƒ¨åº”ç”¨ï¼‰ï¼Œå³æ˜¯å›ºå®šä½åŸå‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼ˆè®¾ä¸º<code>k</code>ä¸ªï¼‰ï¼Œä»¥å®ç°ç®€åŒ–è°ƒç”¨çš„ç›®çš„ï¼ˆè®¾åŸå‡½æ•°å…±æœ‰<code>n</code>ä¸ªå‚æ•°ï¼Œå±€éƒ¨åº”ç”¨å°†ä¸€ä¸ª<code>n</code>å…ƒå‡½æ•°è½¬æ¢æˆä¸€ä¸ª<code>n-k</code>å…ƒå‡½æ•°ï¼‰ï¼Œå¦æœ‰ä¸€ä¸ªæ¦‚å¿µå«åšâ€œæŸ¯é‡ŒåŒ–â€ï¼Œæ˜¯ä¸€ç§å°†æ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬å˜æˆæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—ä½™ä¸‹çš„å‚æ•°ä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯ï¼ˆæŸ¯é‡ŒåŒ–å°†ä¸€ä¸ª<code>n</code>å…ƒå‡½æ•°è½¬æ¢æˆ<code>n</code>ä¸ªä¸€å…ƒå‡½æ•°ï¼‰ï¼Œå¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œç›´æ¥çœ‹ç¤ºä¾‹ï¼Œä¸€ä¸ªå®ç°ä¸‰ä¸ªæ•°ç›¸åŠ çš„åŠ æ³•æ“ä½œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a,b,c</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a+b+c</span><br></pre></td></tr></table></figure><p>å…¶æŸ¯é‡ŒåŒ–ç‰ˆæœ¬ä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_f1</span>(<span class="params">b</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">_f2</span>(<span class="params">c</span>):</span></span><br><span class="line">            <span class="keyword">return</span> a+b+c</span><br><span class="line">        <span class="keyword">return</span> _f2</span><br><span class="line">    <span class="keyword">return</span> _f1</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>) <span class="comment">#6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŒ–ç®€å½¢å¼ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> b:<span class="keyword">lambda</span> c: a+b+c</span><br><span class="line"></span><br><span class="line"><span class="comment">#æˆ–è€…ï¼š</span></span><br><span class="line">add=<span class="keyword">lambda</span> a:<span class="keyword">lambda</span> b:<span class="keyword">lambda</span> c:a+b+c</span><br><span class="line">add(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>) <span class="comment">#6</span></span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ¯æ¬¡éƒ½èŠ±è¿™ä¹ˆå¤§çš„åŠŸå¤«ä¸ºä¸€ä¸ªå‡½æ•°ç‰¹åˆ«å®šåˆ¶å…¶æŸ¯é‡ŒåŒ–ç‰ˆæœ¬ï¼Œä¸ºæ­¤ï¼Œå®šä¹‰äº†ä¸€ä¸ªè½¬æ¢å‡½æ•°<code>curry()</code>ï¼Œèƒ½å¤Ÿæ¥æ”¶ä¸€ä¸ªå‡½æ•°å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæŸ¯é‡ŒåŒ–ç‰ˆæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è¿™æ˜¯ä¸€ä¸ªæ›´å…·é€šç”¨æ€§çš„curry()ï¼Œéšåä½ é™¤äº†å¯ä»¥è¿™æ ·è°ƒç”¨add(1)(2)(3)ï¼Œè¿˜å¯ä»¥add(1)(2,3)æˆ–add(1,2)(3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">curry</span>(<span class="params">func</span>):</span></span><br><span class="line">    argsnum=func.__code__.co_argcount</span><br><span class="line">    allargs=[]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">curried</span>(<span class="params">*args</span>):</span></span><br><span class="line">        <span class="keyword">nonlocal</span> allargs</span><br><span class="line">        allargs+=<span class="built_in">list</span>(args)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(allargs)&gt;=argsnum:</span><br><span class="line">            ret=func(*allargs[:argsnum])</span><br><span class="line">            allargs=[]</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> curried</span><br><span class="line">    <span class="keyword">return</span> curried</span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;è®¾è®¡æ€è·¯</span></span><br><span class="line"><span class="string">1.curryå®ç°å¯¹ä¸€ä¸ªå‡½æ•°çš„æŸ¯é‡ŒåŒ–ï¼Œå› æ­¤åªæ¥æ”¶ä¸€ä¸ªå‡½æ•°å‚æ•°funcï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°curriedï¼Œå…¶ä¸ºfuncçš„æŸ¯é‡ŒåŒ–ç‰ˆæœ¬</span></span><br><span class="line"><span class="string">2.æ¯æ¬¡curriedè¢«ä¼ é€’è¿›å‚æ•°å¹¶è°ƒç”¨ï¼Œcurriedéƒ½ä¼šæ£€æŸ¥æ˜¯å¦å·²æ¥æ”¶äº†è¶³å¤Ÿçš„å‚æ•°ï¼ˆä½¿ç”¨allargså­˜å‚¨ï¼‰ï¼Œå½“å…¶ä¸ªæ•°å¤§äºæˆ–ç­‰äºåŸå‡½æ•°å‚æ•°funcå®šä¹‰çš„å‚æ•°ä¸ªæ•°ï¼ˆç”±argsnumè®°å½•ï¼‰ï¼Œæ­¤æ—¶ç«‹å³è®¡ç®—æœ€ç»ˆç»“æœå¹¶è¿”å›ï¼Œå¦åˆ™ç»§ç»­è¿”å›curriedä»¥æ¥æ”¶æ›´å¤šå‚æ•°</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">curriedAdd=curry(add) <span class="comment">#curriedAddæ˜¯åŸå‡½æ•°addçš„æŸ¯é‡ŒåŒ–ç‰ˆæœ¬ï¼Œå¦‚æœéœ€è¦è¦†ç›–åŸå‡½æ•°ï¼Œå°±ç›´æ¥add=curry(add)ï¼Œè€Œè¿™æ­£å¥½å¯ä»¥ä½¿ç”¨è£…é¥°å™¨çš„è¯­æ³•ç³–@æ¥å®Œæˆï¼Œæ›´ä¼˜ç¾</span></span><br><span class="line">print(curriedAdd(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)) <span class="comment">#6</span></span><br><span class="line">print(curriedAdd(<span class="number">1</span>)(<span class="number">2</span>,<span class="number">3</span>)) <span class="comment">#6</span></span><br><span class="line">print(curriedAdd(<span class="number">1</span>,<span class="number">2</span>)(<span class="number">3</span>)) <span class="comment">#6</span></span><br><span class="line">print(curriedAdd(<span class="number">1</span>,<span class="number">2</span>)(<span class="number">3</span>,<span class="number">4</span>)) <span class="comment">#6</span></span><br><span class="line"><span class="comment">#curriedAdd(1,2,3)(4) #TypeError: &#x27;int&#x27; object is not callableï¼Œç”±äºcurriedAdd(1,2,3)å·²ç»è¿”å›äº†æ­£ç¡®ç»“æœ6ï¼Œæ•´æ•°æ˜¾ç„¶æ˜¯ä¸å¯è°ƒç”¨çš„ï¼Œå› æ­¤æŠ¥é”™ï¼Œå¯¹äºcurriedAdd(1,2)(3,4)ï¼ŒcurriedAdd(1,2)è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿˜èƒ½ç»§ç»­æ¥æ”¶å‚æ•°ï¼Œä½†æ˜¯åªéœ€è¦å†æ¥æ”¶ä¸€ä¸ªå°±èƒ½æ­£ç¡®è®¡ç®—ï¼Œå› æ­¤4è¢«å¿½ç•¥ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®å‚æ•°æ•°é‡ä¸ä¸€è‡´raiseæŠ¥é”™ï¼‰ï¼Œæœ€ç»ˆä»è¿”å›6</span></span><br></pre></td></tr></table></figure><p>é™¤äº†ä¸Šè¿°é€šç”¨çš„é…ç½®å‡½æ•°å®ç°ï¼Œæˆ‘åœ¨<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.python.org/dev/peps/pep-0309/">PEP</a>æ–‡æ¡£ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªåˆ©ç”¨<code>__call__()</code>å®ç°çš„ç±»ç‰ˆæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">partial</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">*args, **kw</span>):</span></span><br><span class="line">        self = args[<span class="number">0</span>] <span class="comment">#__init__()çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯selfå¯¹è±¡</span></span><br><span class="line">        self.fn, self.args, self.kw = (args[<span class="number">1</span>], args[<span class="number">2</span>:], kw) <span class="comment">#args[1]æ˜¯åŸå‡½æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯è¦é¢„å…ˆå›ºå®šçš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, *args, **kw</span>):</span></span><br><span class="line">        <span class="keyword">if</span> kw <span class="keyword">and</span> self.kw:</span><br><span class="line">            d = self.kw.copy()</span><br><span class="line">            d.update(kw)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            d = kw <span class="keyword">or</span> self.kw</span><br><span class="line">        <span class="keyword">return</span> self.fn(*(self.args + args), **d)</span><br></pre></td></tr></table></figure><p>æœ€åè¦è¯´çš„æ˜¯ï¼Œpythonä¸­å®ç°åå‡½æ•°çš„æ ‡å‡†æ–¹æ³•æ˜¯é€šè¿‡<code>from functools import partial</code>ï¼Œå¦å¤–ï¼Œé™¤äº†ä¸ºå‡½æ•°é¢„è®¾éƒ¨åˆ†å‚æ•°å€¼æ„æˆåå‡½æ•°ï¼Œå®é™…ä¸Šä»»ä½•å¯ä»¥é€šè¿‡<code>()</code>è°ƒç”¨çš„éƒ½å¯ä»¥è¿›è¡Œâ€œååº”ç”¨â€ï¼Œè­¬å¦‚ç±»ã€ç±»å®ä¾‹ã€ç±»/å®ä¾‹æ–¹æ³•éƒ½å¯ä»¥é€šè¿‡<code>()</code>è°ƒç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,m,n</span>):</span></span><br><span class="line">        self.m=m</span><br><span class="line">        self.n=n</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self,k,flag</span>):</span> <span class="comment"># kä¸ºä¹˜ç§¯ç³»æ•°ï¼Œflagè¡¨ç¤ºæ˜¯å¦è¾“å‡ºç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            print(<span class="string">&#x27;m*k:&#x27;</span>,self.m*k,<span class="string">&#x27;\nn*k:&#x27;</span>,self.n*k)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self,f1,f2</span>):</span> <span class="comment"># å¦‚æœä¸¤ä¸ªå‚æ•°éƒ½æ˜¯Trueï¼Œé‚£ä¹ˆè¾“å‡ºhello worldï¼Œå¦åˆ™è¾“å‡ºscrew it</span></span><br><span class="line">        <span class="keyword">if</span> f1 <span class="keyword">and</span> f2:</span><br><span class="line">            print(<span class="string">&#x27;hello,world!&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;screw it!&#x27;</span>)</span><br><span class="line">            </span><br><span class="line"><span class="comment">#1.ç±»Açš„å‚æ•°mæ—¢å®šä¸º3ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±é€šè¿‡åå‡½æ•°ä¸ºç±»Açš„æ„é€ å‡½æ•°å›ºå®šä½è¿™ä¸ªå‚æ•°mï¼Œå…¶å€¼ä¸º3</span></span><br><span class="line">A_m=partial(A,<span class="number">3</span>) <span class="comment"># ååº”ç”¨çš„ç±»A</span></span><br><span class="line">obj_1=A_m(<span class="number">4</span>)</span><br><span class="line">print(obj_1.m,obj_1.n) <span class="comment"># 3 4</span></span><br><span class="line">obj_2=A_m(<span class="number">5</span>)</span><br><span class="line">print(obj_2.m,obj_2.n) <span class="comment"># 3 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.å½“ç±»å®ç°äº†__call__æ–¹æ³•åï¼Œç±»å®ä¾‹å¯¹è±¡å°†å¯ä»¥åƒå‡½æ•°ä¸€æ ·è¢«()è°ƒç”¨ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¸ºå…¶å›ºå®šä½flagå‚æ•°ä¸ºTrue</span></span><br><span class="line">obj=A(<span class="number">7</span>,<span class="number">8</span>)</span><br><span class="line">obj_true=partial(obj,flag=<span class="literal">True</span>)</span><br><span class="line">obj_true(<span class="number">2</span>) <span class="comment"># m*k: 14 \nn*k: 16</span></span><br><span class="line">obj_true(<span class="number">3</span>) <span class="comment"># m*k: 21 \nn*k: 24</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å®ä¾‹æ–¹æ³•ï¼Œæœ¬è´¨å°±æ˜¯å‡½æ•°å¯¹è±¡ï¼Œæˆ‘ä»¬å°†helloæ–¹æ³•çš„f2å‚æ•°ç½®ä¸ºTrueï¼Œæ˜¯å¦è¾“å‡ºé—®å€™è¯­åªéœ€è¦f1å‚æ•°</span></span><br><span class="line">obj_hello=partial(obj.hello,f2=<span class="literal">True</span>) <span class="comment">#äº‹å®ä¸Šï¼Œå®ä¾‹å±æ€§æ–¹æ³•è®¿é—®è¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªå›ºå®šäº†selfå‚æ•°çš„ååº”ç”¨</span></span><br><span class="line">obj_hello(<span class="literal">True</span>) <span class="comment"># hello,world!</span></span><br><span class="line">obj_hello(<span class="literal">False</span>) <span class="comment"># screw it!</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-2-4"><p>åœ¨å‡½æ•°å†…ï¼Œ<code>yield</code>è¯­å¥è¿˜å¯ä»¥ç”¨ä½œå‡ºç°åœ¨èµ‹å€¼è¿ç®—å³è¾¹çš„è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">receiver</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Ready to receive&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n=(<span class="keyword">yield</span>)</span><br><span class="line">        print(<span class="string">f&#x27;Got <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä»¥è¿™ç§æ–¹å¼ä½¿ç”¨<code>yield</code>è¯­å¥çš„å‡½æ•°ç§°ä¸ºâ€œåç¨‹â€ï¼ˆåç¨‹åæ˜ äº†ç¨‹åºé€»è¾‘çš„ä¸€ç§éœ€æ±‚ï¼šå¯é‡å…¥ï¼ˆå­ç¨‹åº/å‡½æ•°çš„ï¼‰èƒ½åŠ›ã€‚åç¨‹èƒ½ä¿ç•™ä¸Šä¸€æ¬¡è°ƒç”¨æ—¶çš„çŠ¶æ€ï¼Œæ¯æ¬¡é‡å…¥æ—¶ï¼Œå°±ç›¸å½“äºè¿›å…¥ä¸Šä¸€æ¬¡è°ƒç”¨çš„çŠ¶æ€ï¼‰ï¼Œå®ƒçš„æ‰§è¡Œæ˜¯ä¸ºäº†å“åº”å‘é€ç»™å®ƒçš„å€¼ï¼Œå…¶è¡Œä¸ºä¹Ÿç±»ä¼¼äºç”Ÿæˆå™¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>r=receiver() <span class="comment">#æ­¤æ—¶å‡½æ•°å°šæœªæ‰§è¡Œ</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.__next__() <span class="comment">#é¦–æ¬¡è°ƒç”¨next()æ–¹æ³•ä»¥å‘å‰æ‰§è¡Œåˆ°ç¬¬ä¸€æ¡yieldè¯­å¥å¤„å¹¶æš‚åœ</span></span><br><span class="line">Ready to receive</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.send(<span class="number">1</span>) <span class="comment">#å‘é€å€¼åˆ°yieldå¤„ï¼Œä¸”å‘é€çš„å€¼å°†è¢«ç›´æ¥èµ‹ç»™yieldèµ‹å€¼å·å·¦è¾¹çš„å˜é‡ï¼Œç„¶åç»§ç»­å‘å‰ç›´è‡³å†æ¬¡é‡åˆ°yieldå¹¶æš‚åœ</span></span><br><span class="line">Got <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(r.send(<span class="string">&#x27;Hello&#x27;</span>))</span><br><span class="line">Got Hello</span><br><span class="line"><span class="literal">None</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç¤ºä¾‹ä¸­åœ¨æ‰§è¡Œå‘é€å‰éœ€è¦å…ˆè°ƒç”¨ä¸€æ¬¡<code>next()</code>æ–¹æ³•ï¼Œä¸å¤ªæ–¹ä¾¿ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨ä»¥è‡ªåŠ¨è°ƒç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">coroutine</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">        g=func(*args,**kwargs)</span><br><span class="line">        <span class="built_in">next</span>(g) <span class="comment">#next()è¿”å›ç¬¬ä¸€ä¸ªé‡åˆ°çš„yieldè¯­å¥ä¸­çš„è¡¨è¾¾å¼å€¼ï¼ˆyield [expression]ï¼‰ï¼Œå‡è®¾expressionç¼ºçœï¼Œåˆ™è¿”å›None</span></span><br><span class="line">        <span class="keyword">return</span> g</span><br><span class="line">    <span class="keyword">return</span> _</span><br><span class="line">    </span><br><span class="line"><span class="meta">@coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">receiver</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Ready to receive&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n=(<span class="keyword">yield</span>)</span><br><span class="line">        print(<span class="string">f&#x27;Got <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">r=receiver()</span><br><span class="line">r.send(<span class="number">1</span>)</span><br><span class="line">r.send(<span class="string">&#x27;Hello&#x27;</span>)</span><br></pre></td></tr></table></figure><p>åç¨‹çš„è¿è¡Œä¸€èˆ¬æ˜¯æ— é™æœŸçš„ï¼Œé™¤éå®ƒè¢«æ˜¾å¼å…³é—­ï¼ˆè°ƒç”¨<code>close()</code>æ–¹æ³•ï¼‰æˆ–è€…è‡ªå·±é€€å‡ºï¼Œå…³é—­åå¦‚æœç»§ç»­ç»™åç¨‹å‘é€å€¼ï¼Œå°†ä¼šå¼•å‘<code>StopIteration</code>å¼‚å¸¸ï¼Œæ­£å¦‚ä¹‹å‰åœ¨å…³äºç”Ÿæˆå™¨çš„å†…å®¹ä¸­æ‰€è®²ï¼Œ<code>close()</code>æ“ä½œå°†ä¼šåœ¨åç¨‹å†…éƒ¨<code>yield</code>ä½ç½®å¤„å¼•å‘<code>GenaratorExit</code>å¼‚å¸¸ï¼Œä½ å¯ä»¥é€‰æ‹©æ•æ‰å®ƒã€‚å¦å¤–è°ƒç”¨<code>throw(exctype[,value[,tb]])</code>æ–¹æ³•ä¹Ÿä¼šåœ¨åç¨‹å†…éƒ¨<code>yield</code>ä½ç½®å¤„å¼•å‘å¼‚å¸¸ï¼Œå¼‚å¸¸çš„ç±»å‹ã€å€¼å’Œè·Ÿè¸ªå¯¹è±¡åˆ†åˆ«ç”±<code>exctype</code>ã€<code>value</code>å’Œ<code>tb</code>å‚æ•°æŒ‡å®š</p><p>å¦‚æœèµ‹å€¼å·å³è¾¹çš„<code>yield</code>è¯­å¥æœ¬èº«å«æœ‰è¡¨è¾¾å¼ï¼ˆä¸åŒäºä¸Šé¢çš„<code>var=yield</code>ï¼Œè€Œæ˜¯<code>var=yield expression</code>çš„å½¢å¼ï¼‰ï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„å€¼å°†ä½œä¸º<code>send()</code>æ–¹æ³•çš„è¿”å›å€¼ï¼Œæ­¤æ—¶åç¨‹å¯ä»¥ä½¿ç”¨<code>yield</code>è¯­å¥åŒæ—¶æ¥æ”¶å’Œå‘å‡ºè¿”å›å€¼ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">@coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consumer</span>():</span></span><br><span class="line">    r = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="keyword">yield</span> r</span><br><span class="line">        print(<span class="string">&#x27;[CONSUMER] Consuming %s...&#x27;</span> % n)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        r = <span class="string">&#x27;200 OK&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">producer</span>(<span class="params">c</span>):</span></span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; <span class="number">5</span>:</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">        print(<span class="string">&#x27;[PRODUCER] Producing %s...&#x27;</span> % n)</span><br><span class="line">        r = c.send(n) <span class="comment">#å°†ç”Ÿäº§å€¼å‘é€ç»™æ¶ˆè´¹è€…ï¼Œå¹¶æ¥æ”¶æ¶ˆè´¹è€…çš„åé¦ˆ</span></span><br><span class="line">        print(<span class="string">&#x27;[PRODUCER] Consumer return: %s&#x27;</span> % r)</span><br><span class="line">    c.close() <span class="comment">#ç”Ÿäº§ç»“æŸåå…³é—­æ¶ˆè´¹è€…ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨å¤–é¢å…³é—­</span></span><br><span class="line">    </span><br><span class="line">c = consumer()</span><br><span class="line">producer(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;OUTPUT</span></span><br><span class="line"><span class="string">[PRODUCER] Producing 1...</span></span><br><span class="line"><span class="string">[CONSUMER] Consuming 1...</span></span><br><span class="line"><span class="string">[PRODUCER] Consumer return: 200 OK</span></span><br><span class="line"><span class="string">[PRODUCER] Producing 2...</span></span><br><span class="line"><span class="string">[CONSUMER] Consuming 2...</span></span><br><span class="line"><span class="string">[PRODUCER] Consumer return: 200 OK</span></span><br><span class="line"><span class="string">[PRODUCER] Producing 3...</span></span><br><span class="line"><span class="string">[CONSUMER] Consuming 3...</span></span><br><span class="line"><span class="string">[PRODUCER] Consumer return: 200 OK</span></span><br><span class="line"><span class="string">[PRODUCER] Producing 4...</span></span><br><span class="line"><span class="string">[CONSUMER] Consuming 4...</span></span><br><span class="line"><span class="string">[PRODUCER] Consumer return: 200 OK</span></span><br><span class="line"><span class="string">[PRODUCER] Producing 5...</span></span><br><span class="line"><span class="string">[CONSUMER] Consuming 5...</span></span><br><span class="line"><span class="string">[PRODUCER] Consumer return: 200 OK</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ€å¼€å§‹çš„<code>next()</code>è°ƒç”¨åªä¼šæ‰§è¡Œåˆ°èµ‹å€¼å·å³è¾¹çš„<code>(yield [expression])</code>å¤„ï¼ˆä¸”ç›´åˆ°æ‰§è¡Œ<code>send()</code>æ—¶æ‰ä¼šå®Œæˆèµ‹å€¼ï¼‰ï¼Œå¹¶è¿”å›<code>yield</code>ä¸­çš„è¡¨è¾¾å¼<code>expression</code>å€¼ï¼Œåœ¨æ¥ä¸‹æ¥çš„<code>send()</code>è°ƒç”¨ä¸­ï¼Œåç¨‹å°†ä»æš‚åœå¤„ç»§èµ·ï¼Œç›´åˆ°å†æ¬¡é‡åˆ°<code>(yield [expression])</code>æš‚åœï¼Œå¹¶å°†æ­¤æ—¶è®¡ç®—å¾—åˆ°çš„<code>expression</code>ä½œä¸º<code>send()</code>æ–¹æ³•çš„è¿”å›å€¼</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="py2-2-5"><ul><li><p>åˆ—è¡¨ç”Ÿæˆå¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret=[x * x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(_)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">list</span>&#x27;&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>é›†åˆç”Ÿæˆå¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret=&#123;x * x <span class="keyword">for</span> x <span class="keyword">in</span> [-<span class="number">5</span>,-<span class="number">3</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret</span><br><span class="line">&#123;<span class="number">25</span>, <span class="number">9</span>, <span class="number">1</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(_)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">set</span>&#x27;&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>å­—å…¸ç”Ÿæˆå¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret=&#123;x:x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret</span><br><span class="line">&#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">1</span>: <span class="number">1</span>, <span class="number">2</span>: <span class="number">2</span>, <span class="number">3</span>: <span class="number">3</span>, <span class="number">4</span>: <span class="number">4</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(_)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">dict</span>&#x27;&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ç”Ÿæˆå™¨è¡¨è¾¾å¼</p><p>å’Œåˆ—è¡¨ç”Ÿæˆå¼å‡ ä¹ä¸€æ ·ï¼Œåªä¸è¿‡å°†ä¸­æ‹¬å·<code>[]</code>æ›¿æ¢æˆ<code>()</code>å³å¯ï¼Œè¿”å›çš„æ˜¯ç”Ÿæˆå™¨å¯¹è±¡</p></li></ul><p>æ³¨1ï¼Œä»¥ä¸Šæ‰€æœ‰çš„ç”Ÿæˆå¼éƒ½æ”¯æŒå¤šé‡<code>for</code>å¾ªç¯ï¼Œå¦‚ï¼š<code>[(i,j,k) for i in range(4) for j in range(3) for k in range(2)]</code>ï¼ˆæ³¨æ„<code>for</code>å¾ªç¯çš„é¡ºåºæ˜¯ä»å·¦è‡³å³çš„ï¼Œå³å·¦è¾¹<code>for</code>å¾ªç¯çš„è¿­ä»£å˜é‡å¯ä»¥å‡ºç°åœ¨å³è¾¹<code>for</code>å¾ªç¯ä¸­ä½†æ˜¯åä¹‹ä¸å¯ä»¥ï¼‰ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret=((x,y) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(x))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret</span><br><span class="line">&lt;generator <span class="built_in">object</span> &lt;genexpr&gt; at <span class="number">0x0000024BBAABBF10</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(_)</span><br><span class="line">[(<span class="number">1</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">1</span>), (<span class="number">3</span>, <span class="number">0</span>), (<span class="number">3</span>, <span class="number">1</span>), (<span class="number">3</span>, <span class="number">2</span>), (<span class="number">4</span>, <span class="number">0</span>), (<span class="number">4</span>, <span class="number">1</span>), (<span class="number">4</span>, <span class="number">2</span>), (<span class="number">4</span>, <span class="number">3</span>)]</span><br></pre></td></tr></table></figure><p>æ³¨2ï¼Œä»¥ä¸Šæ‰€æœ‰çš„ç”Ÿæˆå¼éƒ½å¯ä»¥æ­é…<code>if</code>æ¡ä»¶åˆ¤æ–­ï¼ˆæ²¡æœ‰<code>else</code>ï¼‰ï¼Œä»¥åˆ—è¡¨ç”Ÿæˆå¼ä¸ºä¾‹ï¼š<code>[expression for i in iterable if condition]</code>ï¼ˆæ¡ä»¶åˆ¤æ–­çš„ä½œç”¨åŒ<code>filter()</code>å‡½æ•°ï¼Œç”¨äºè¿‡æ»¤åºåˆ—ä¸­çš„éƒ¨åˆ†å…ƒç´ ï¼‰ï¼Œç”±äº<code>expression</code>æœ¬èº«ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œå› æ­¤è¿˜å¯ä»¥å†™æˆï¼š<code>[expression1 if condition else expression2 for i in iterable]</code>ï¼Œç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>) <span class="keyword">if</span> i%<span class="number">3</span>==<span class="number">0</span>] <span class="comment">#ä»0-9çš„åºåˆ—ä¸­ç­›é€‰å‡º3çš„æ•´æ•°å€</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[(<span class="number">1</span> <span class="keyword">if</span> i%<span class="number">3</span>==<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)] <span class="comment">#å¦‚æœæ˜¯3çš„æ•´æ•°å€ï¼Œåˆ™ç½®ä¸º1å¦åˆ™ç½®ä¸º0</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">&#x27;3+&#x27;</span> <span class="keyword">if</span> i&gt;<span class="number">3</span> <span class="keyword">else</span> <span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>) <span class="keyword">if</span> i%<span class="number">3</span>==<span class="number">0</span>] <span class="comment">#ä»0-9çš„åºåˆ—ä¸­ç­›é€‰å‡º3çš„æ•´æ•°å€ï¼Œä¸”æ˜¯å­—ç¬¦ä¸²å½¢å¼ï¼Œè¿›ä¸€æ­¥ï¼Œå¦‚æœå¤§äº6ï¼Œåˆ™ç½®ä¸º&#x27;3+&#x27;</span></span><br><span class="line">[<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;3+&#x27;</span>, <span class="string">&#x27;3+&#x27;</span>]</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="tip fas fa-quote-left"><p>[1] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://pan.baidu.com/s/17r__wNMxIXTMWhglf3wyuw" title="å¯†ç ï¼š1y2r"><span style="color:red">Pythonå‚è€ƒæ‰‹å†Œ</span></a> ç¬¬4ç‰ˆ ä¿®è®¢ç‰ˆ [ç¾] å¤§å«Â·M.æ¯”å…¹åˆ©ï¼ˆDavid M.Beazleyï¼‰è‘—ï¼Œè°¢ä¿Šï¼Œæ¨è¶Šï¼Œé«˜ä¼Ÿ è¯‘</p></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">Muggledy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="https://muggledy.github.io/posts/176/">https://muggledy.github.io/posts/176/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://muggledy.github.io" target="_blank">Muggledy's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v2.1/compress/13.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting@v0.1/img/20210202152223.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210328224511.gif"' alt="avatar"><div class="author-info__name">Muggledy</div><div class="author-info__description">å­¤ç­é‡æ´‹</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">2</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">1</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/muggledy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/muggledy" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210209044239.jpg" rel="external nofollow noreferrer" target="_blank" title="WeChat"><i class="fab fa-weixin"></i></a><a class="social-icon" href="mailto:zgjsycfndy2015@163.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=3101266674&amp;site=qq&amp;menu=yes" rel="external nofollow noreferrer" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><a href="/note/"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></a><div class="announcement_content">æœ¬äººçš„æ›´æ–°æ˜¯ææ…¢çš„~</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E7%BB%93%E6%9E%84%E4%B8%8E%E6%89%A7%E8%A1%8C"><span class="toc-number">1.</span> <span class="toc-text">ç¨‹åºç»“æ„ä¸æ‰§è¡Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">å‡½æ•°å¼ç¼–ç¨‹</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/65257/" title="Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•"><img src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210328214628.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210328224519.jpg"' alt="Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•"></a><div class="content"><a class="title" href="/posts/65257/" title="Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•">Butterflyé­”æ”¹éƒ¨åˆ†è®°å½•</a><time datetime="2021-03-24T16:00:00.000Z" title="å‘è¡¨äº 2021-03-25 00:00:00">2021-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/17177/" title="Hexoåšå®¢ç®€æ˜“é…ç½®"><img src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210217121829.jpg" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/img/20210328224519.jpg"' alt="Hexoåšå®¢ç®€æ˜“é…ç½®"></a><div class="content"><a class="title" href="/posts/17177/" title="Hexoåšå®¢ç®€æ˜“é…ç½®">Hexoåšå®¢ç®€æ˜“é…ç½®</a><time datetime="2021-02-05T16:00:00.000Z" title="å‘è¡¨äº 2021-02-06 00:00:00">2021-02-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By Muggledy</div><div class="footer_custom_text"><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/zh-cn/"><img src="https://img.shields.io/badge/Frame-Hexo-blue"></a>&nbsp;&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-brightgreen"></a>&nbsp;&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://pages.github.com/"><img src="https://img.shields.io/badge/Hosted-Github-red"></a>&nbsp;&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsdelivr-blueviolet"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/utils.js"></script><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v2.0/js/main.js"></script><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/search/local-search.js"></script><div class="js-pjax"><script>document.getElementsByClassName("mermaid").length&&(window.mermaidJsLoad?mermaid.init():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(()=>{window.mermaidJsLoad=!0,mermaid.initialize({theme:"default"}),mermaid.init()}))</script><script>function loadValine(){function e(){new Valine(Object.assign({el:"#vcomment",appId:"b7x9hYzkDTy4reR4khezoDcf-gzGzoHsz",appKey:"ReeSRhiVzefUKIsJwSvUD6qV",placeholder:"å¿«æ¥è¯„è®ºå§(è¯·æ³¨æ„â€œæœ€æ–°è¯„è®ºâ€åªå…³è”äº†Gitalkè¯„è®ºç³»ç»Ÿå“¦)~",avatar:"monsterid",meta:"nick,mail,link".split(","),pageSize:"10",lang:"zh-CN",recordIP:!1,serverURLs:"",emojiCDN:"",emojiMaps:"",enableQQ:!0,path:window.location.pathname,requiredFields:["nick,mail"],visitor:!1,master:"5f452633ebd48518f8778c240d946335".split(","),friends:"a483c79213701a5644bec62de88f974d,34c64a0cb78287b2ae889cda5d9d2a91,574fbd33aa74a09d671f4608af20fd2b".split(",")},null))}"function"==typeof Valine?e():getScript("https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js").then(e)}{function loadOtherComment(){loadValine()}setTimeout(loadValine,0)}</script><script>function addGitalkSource(){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css",document.getElementsByTagName("head")[0].appendChild(e)}function loadGitalk(){function e(){new Gitalk(Object.assign({clientID:"05956758b57064d95a57",clientSecret:"3c4ddd74e671e3d79aac8417e708f69ff93b3e28",repo:"muggledy.github.io",owner:"muggledy",admin:["muggledy"],id:"aba8c7be9ca946afe9e9845aee09c4bd",language:"zh-CN",perPage:10,distractionFreeMode:!1,pagerDirection:"last",createIssueManually:!1,updateCountCallback:commentCount},null)).render("gitalk-container")}"function"==typeof Gitalk?e():(addGitalkSource(),getScript("https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js").then(e))}function commentCount(e){let t=document.querySelector("#post-meta .gitalk-comment-count");t&&(t.innerHTML=e)}{function loadOtherComment(){loadGitalk()}loadGitalk()}</script></div><script>window.addEventListener("load",()=>{const e=()=>{fetch("https://api.github.com/repos/muggledy/muggledy.github.io/issues/comments?sort=updated&direction=desc&per_page=6&page=1",{headers:{Accept:"application/vnd.github.v3.html+json"}}).then(e=>e.json()).then(e=>{(e=>{let a="";Promise.all(e.map(e=>fetch(e.url).then(e=>e.json()).then(e=>"utterances-bot"===e.user.login?(a=e.body.match(/https?\:\/\/[^\" ]+/gi).slice(-1),a[0]):(a=e.body.match(/https?\:\/\/[^\" ]+/i),a[0])))).then(a=>{e=e.map((e,t)=>({...e,url:a[t]})),saveToLocal.set("github-newest-comments",JSON.stringify(e),5/1440),t(e)})})(e.map(e=>{return{avatar:e.user.avatar_url,content:(t=e.body_html,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[å›¾ç‰‡]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[é“¾æ¥]")).replace(/<pre><code>.*?<\/pre>/gi,"[ä»£ç ]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),nick:e.user.login,url:e.issue_url,date:e.updated_at,githubUrl:e.html_url};var t}))}).catch(e=>{document.querySelector("#card-newest-comments .aside-list").innerHTML="æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"})},t=e=>{let t="";if(e.length)for(let a=0;a<e.length;a++){t+="<div class='aside-list-item'>";{const n="src";t+=`<a href='${e[a].url}' class='thumbnail'><img ${n}='${e[a].avatar}' alt='${e[a].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[a].url}'>${e[a].content}</a>\n        <div class='name'><span>${e[a].nick} / </span><time datetime="${e[a].date}">${btf.diffDate(e[a].date,!0)}</time></div>\n        </div></div>`}else t+="æ²¡æœ‰è¯„è®º";let a=document.querySelector("#card-newest-comments .aside-list");a.innerHTML=t,window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(a)},a=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const a=saveToLocal.get("github-newest-comments");a?t(JSON.parse(a)):e()}};a(),document.addEventListener("pjax:complete",a)})</script><script src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/t_chart.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/funny_title/funny-title-js.js"></script><script async src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/font_animal/font_animal.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/muggledy/muggledy.github.io@v1.2/js/cal_rs.js"></script><script src="https://cdn.jsdelivr.net/gh/celestezj/ImageHosting/data/visitors_map/vis_m.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#web_bg","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:complete",(function(){void 0!==window.ifExe_addHighlightTool&&(window.ifExe_addHighlightTool=!0),void 0!==window.ifExe_clickFnOfTagHide&&(window.ifExe_clickFnOfTagHide=!0),window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:send",(function(){if("object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div class="dyminimenu"><ul><li onclick="wll_menu(1)"><span>ğŸ“ æ·»åŠ miniä¾¿ç­¾</span></li><li onclick="wll_menu(2)"><span>ğŸ†‘ æ¸…ç©ºå½“å‰é¡µé¢</span></li></ul></div><script data-pjax>function history_calendar_injector_config(){var i=document.getElementsByClassName("sticky_layout")[0];console.log("å·²æŒ‚è½½history_calendar"),i.insertAdjacentHTML("afterbegin",'<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>é‚£å¹´ä»Šæ—¥</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>')}document.getElementsByClassName("sticky_layout")[0]&&"/"===location.pathname&&history_calendar_injector_config()</script><script data-pjax src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script></body><script async data-pjax>IsPC()&&btf.isJqueryLoad(image_preview_wrapper),btf.isJqueryLoad(dybubblefn)</script></html>