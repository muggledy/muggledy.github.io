"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,a,c=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(c.push(r.value),!t||c.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,n,r,a,c,o){try{var s=e[c](o),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,a)}function _asyncToGenerator(s){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=s.apply(e,o);function a(e){asyncGeneratorStep(r,t,n,a,c,"next",e)}function c(e){asyncGeneratorStep(r,t,n,a,c,"throw",e)}a(void 0)})}}var CACHE_NAME="MuggledyBlogCacheHelper",cachelist=["/404.html"],blog_default_version="1.0.20";self.cons={s:function(e){console.log("%c[SUCCESS]%c ".concat(e),"color:white;background:green;","")},w:function(e){console.log("%c[WARNING]%c ".concat(e),"color:brown;background:yellow;","")},i:function(e){console.log("%c[INFO]%c ".concat(e),"color:white;background:blue;","")},e:function(e){console.log("%c[ERROR]%c ".concat(e),"color:white;background:red;","")},d:function(e){console.log("%c[DEBUG]%c ".concat(e),"color:white;background:black;","")}},self.db={read:function(n,e){return new Promise(function(t,e){caches.open(CACHE_NAME).then(function(e){e.match(new Request("https://LOCALCACHE/".concat(encodeURIComponent(n)))).then(function(e){e||t(null),e.text().then(function(e){return t(e)})}).catch(function(){t(null)})})})},write:function(n,r){return new Promise(function(t,e){caches.open(CACHE_NAME).then(function(e){e.put(new Request("https://LOCALCACHE/".concat(encodeURIComponent(n))),new Response(r)),t()}).catch(function(){e()})})}};var generate_uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})};self.addEventListener("activate",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:self.clients.claim();case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),self.addEventListener("install",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:self.skipWaiting(),t.waitUntil(caches.open(CACHE_NAME).then(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,db.read("uuid");case 2:if(e.sent){e.next=5;break}return e.next=5,db.write("uuid",generate_uuid());case 5:return e.abrupt("return",t.addAll(cachelist));case 6:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());var handleerr=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Response("<h1>MuggledyBlogCacheHelper Error</h1>\n    <b>".concat(n,"</b>"),{headers:{"content-type":"text/html; charset=utf-8"}}));case 1:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),cdn={gh:{statically:{url:"https://cdn.statically.io/gh"},jsdelivr:{url:"https://cdn.jsdelivr.net/gh"},githack:{url:"https://rawcdn.githack.com"}},combine:{jsdelivr:{url:"https://cdn.jsdelivr.net/combine"}},unpkg_version:{unpkg:{url:"https://unpkg.com"},jsdelivr:{url:"https://cdn.jsdelivr.net/npm"},eleme:{url:"https://npm.elemecdn.com"},jjz:{url:"https://jsd.onmicrosoft.cn/npm"},sourceg:{url:"https://npm.sourcegcdn.com"},cloudflare:{url:"https://cdnjs.cloudflare.com/ajax/libs"},bootcss:{url:"https://cdn.bootcss.com"}},npm:{eleme:{url:"https://npm.elemecdn.com"},jsdelivr:{url:"https://cdn.jsdelivr.net/npm"},jjz:{url:"https://jsd.onmicrosoft.cn/npm"},jjz_unpkg:{url:"https://npkg.onmicrosoft.cn"},sourceg:{url:"https://npm.sourcegcdn.com"},GNT:{url:"https://cdn.bilicdn.tk/npm"}}},handle=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(o){var s,t,i,n,r,u,a,c,p,l,f,h,m,g,d,b,v,x;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=set_blog_config,e.next=3,db.read("blog_version");case 3:if(e.t1=e.sent,e.t1){e.next=6;break}e.t1=blog_default_version;case 6:return e.t2=e.t1,(0,e.t0)(e.t2),e.next=10,o.clone();case 10:return e.sent,s=o.url,t=new URL(s),e.next=15,db.read("uuid");case 15:if(e.sent,i=t.href.substr(t.origin.length),n=s.split("/")[2],i.match(/\/sw\.js/g))return e.abrupt("return",fetch(o));e.next=20;break;case 20:return r=function(e){return t.searchParams.get(e)},u=[],l=p=c=a=null,e.t4=JSON,e.next=29,db.read("msg");case 29:if(e.t5=e.sent,e.t3=e.t4.parse.call(e.t4,e.t5),e.t3){e.next=33;break}e.t3=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,db.write("msg","[]");case 2:return e.abrupt("return","[]");case 3:case"end":return e.stop()}},e)}))();case 33:if(f=e.t3,h=s.split("?")[0],m=new Request(h),g=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.open(CACHE_NAME);case 2:return n=e.sent,e.next=5,n.delete(t);case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),"true"==r("nosw"))return e.abrupt("return",fetch(o));e.next=39;break;case 39:if("true"==r("delete"))return g(m),f.push({name:"文件已删除",time:new Date,info:"已删除".concat(h)}),e.next=44,db.write("msg",JSON.stringify(f));e.next=45;break;case 44:return e.abrupt("return",new Response(JSON.stringify({ok:1})));case 45:if("true"==r("forceupdate"))return f.push({name:"文件已强制更新",time:new Date,info:"已更新".concat(h)}),e.next=49,db.write("msg",JSON.stringify(f));e.next=52;break;case 49:return e.next=51,fetch(o).then(function(t){return caches.open(CACHE_NAME).then(function(e){return g(m),e.put(o,t.clone()),t})});case 51:return e.abrupt("return",new Response(JSON.stringify({ok:1})));case 52:e.t6=regeneratorRuntime.keys(cdn);case 53:if((e.t7=e.t6()).done){e.next=104;break}d=e.t7.value,e.t8=regeneratorRuntime.keys(cdn[d]);case 56:if((e.t9=e.t8()).done){e.next=102;break}if(b=e.t9.value,n!=cdn[d][b].url.split("https://")[1].split("/")[0]||!s.match(cdn[d][b].url)){e.next=100;break}u=[],e.t10=regeneratorRuntime.keys(cdn[d]);case 61:if((e.t11=e.t10()).done){e.next=95;break}if(v=e.t11.value,a=s.replace(cdn[d][b].url,cdn[d][v].url),"gh"!==d){e.next=68;break}a.match("https://cdn.jsdelivr.net/gh")&&!s.match("https://cdn.jsdelivr.net/gh")?null===(c=a.split("https://")[1].split("/"))[3].match("@")&&(a=a.replace("".concat(c[2],"/").concat(c[3],"/"),"".concat(c[2],"/").concat(c[3],"@"))):a.match("https://cdn.statically.io/gh")&&s.match("https://cdn.jsdelivr.net/gh")?a=null!==(p=a.split("https://")[1].split("/"))[3].match("@")?a.replace("".concat(p[2],"/").concat(p[3],"/"),"".concat(p[2],"/").concat(p[3].split("@").join("/"),"/")):a.replace("".concat(p[2],"/").concat(p[3],"/"),"".concat(p[2],"/").concat(p[3],"/master/")):a.match("https://rawcdn.githack.com")&&!s.match("https://rawcdn.githack.com")&&(p=a.split("https://")[1].split("/"),s.match("https://cdn.jsdelivr.net/gh")&&(a=null!==p[2].match("@")?a.replace("".concat(p[1],"/").concat(p[2],"/"),"".concat(p[1],"/").concat(p[2].split("@").join("/"),"/")):a.replace("".concat(p[1],"/").concat(p[2],"/"),"".concat(p[1],"/").concat(p[2],"/master/"))),!p[p.length-1].endsWith(".min.js")&&!p[p.length-1].endsWith(".min.css")||"celestezj"===p[1]&&/\b(swiper.min.css|swiper.min.js|swiper_init.min.js|APlayer.min.js|APlayer.min.css|all.min.css|font-awesome-animation.min.css|buttons.min.css|Valine.min.js|activate-power-mode.min.js)\b/.test(p[p.length-1])||(a=a.replace(/(.*).min.(js|css)/,"$1.$2"))),e.next=92;break;case 68:if("unpkg_version"!==d){e.next=92;break}if(!a.match("https://cdnjs.cloudflare.com/ajax/libs")||s.match("https://cdnjs.cloudflare.com/ajax/libs")||s.match("https://cdn.bootcss.com")){e.next=80;break}if((p=a.split("https://")[1].split("/"))[3].startsWith("@")&&(a=a.replace("".concat(p[3],"/"),""),p=a.split("https://")[1].split("/")),null===p[3].match("@")){e.next=77;break}a=(l=a.replace("".concat(p[2],"/").concat(p[3],"/").concat("typed.js"===p[3].split("@")[0]?"lib":"dist","/"),"".concat(p[2],"/").concat(p[3].split("@").join("/"),"/")))===a?a.replace("".concat(p[2],"/").concat(p[3],"/"),"".concat(p[2],"/").concat(p[3].split("@").join("/"),"/")):l,e.next=78;break;case 77:return e.abrupt("continue",61);case 78:e.next=92;break;case 80:if(!a.match("https://cdn.bootcss.com")||s.match("https://cdnjs.cloudflare.com/ajax/libs")||s.match("https://cdn.bootcss.com")){e.next=91;break}if((p=a.split("https://")[1].split("/"))[1].startsWith("@")&&(a=a.replace("".concat(p[1],"/"),""),p=a.split("https://")[1].split("/")),null===p[1].match("@")){e.next=88;break}a=(l=a.replace("".concat(p[0],"/").concat(p[1],"/").concat("typed.js"===p[1].split("@")[0]?"lib":"dist","/"),"".concat(p[0],"/").concat(p[1].split("@").join("/"),"/")))===a?a.replace("".concat(p[0],"/").concat(p[1],"/"),"".concat(p[0],"/").concat(p[1].split("@").join("/"),"/")):l,e.next=89;break;case 88:return e.abrupt("continue",61);case 89:e.next=92;break;case 91:a.match("https://cdnjs.cloudflare.com/ajax/libs")||a.match("https://cdn.bootcss.com")||!s.match("https://cdnjs.cloudflare.com/ajax/libs")&&!s.match("https://cdn.bootcss.com")||(c=a.split("https://")[1].split("/"),a=a.match("https://cdn.jsdelivr.net/npm")||a.match("https://jsd.onmicrosoft.cn/npm")?a.replace("".concat(c[2],"/").concat(c[3],"/"),"".concat(c[2].toLowerCase(),"@").concat(c[3],"/").concat("typed.js"===c[2]?"lib":"dist","/")):a.replace("".concat(c[1],"/").concat(c[2],"/"),"".concat(c[1].toLowerCase(),"@").concat(c[2],"/").concat("typed.js"===c[1]?"lib":"dist","/")));case 92:u.push(a),e.next=61;break;case 95:return e.next=97,privconf.read("cache");case 97:if(e.sent){e.next=99;break}return e.abrupt("return",lfetch(u,s));case 99:return e.abrupt("return",caches.match(o).then(function(e){return e||lfetch(u,s).then(function(t){return caches.open(CACHE_NAME).then(function(e){return e.put(o,t.clone()),t})})}));case 100:e.next=56;break;case 102:e.next=53;break;case 104:e.t12=regeneratorRuntime.keys(blog.origin);case 105:if((e.t13=e.t12()).done){e.next=113;break}if(x=e.t13.value,n.split(":")[0]!=blog.origin[x].split(":")[0]){e.next=111;break}if("object"===_typeof(x=function(){if(blog.local)return{v:fetch(o)};for(var e in setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,set_newest_blogver();case 2:case"end":return e.stop()}},e)})),3e4),u=[],blog.plus)u.push("https://".concat(blog.plus[e])+fullpath(i));for(var t in blog.npmmirror)u.push(blog.npmmirror[t]+fullpath(i));var c=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Response,e.next=3,t.arrayBuffer();case 3:return e.t1=e.sent,e.t2={headers:{"Content-Type":"text/html;charset=utf-8"},status:t.status,statusText:t.statusText},e.abrupt("return",new e.t0(e.t1,e.t2));case 6:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}();return{v:new Promise(function(a,e){setTimeout(function(){caches.match(o).then(function(e){e?(cons.s("Cache Hited! | Origin:".concat(s)),setTimeout(function(){a(e)},200),setTimeout(function(){lfetch(u,s).then(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",caches.open(CACHE_NAME).then(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.delete(o),cons.s("Cache Updated! | Origin:".concat(s)),fullpath(i).match(/\.html$/g))return e.next=5,c(r);e.next=10;break;case 5:n=e.sent,t.put(o,n.clone()),a(n),e.next=12;break;case 10:t.put(o,r.clone()),a(r);case 12:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())},0)):(cons.w("Cache Missed! | Origin:".concat(s)),setTimeout(function(){lfetch(u,s).then(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",caches.open(CACHE_NAME).then(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(fullpath(i).match(/\.html$/g))return e.next=3,c(r);e.next=8;break;case 3:n=e.sent,t.put(o,n.clone()),a(n),e.next=10;break;case 8:t.put(o,r.clone()),a(r);case 10:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){a(caches.match(new Request("/404.html")))})},0),setTimeout(function(){a(caches.match(new Request("/404.html")))},5e3))})},0)})}}()))return e.abrupt("return",x.v);e.next=111;break;case 111:e.next=105;break;case 113:return e.abrupt("return",fetch(o));case 114:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),lfetch=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function e(t,o){var s,i,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return cons.i("LFetch Handled! | Mirrors Count:".concat(t.length," | Origin: ").concat(o)),console.log(t),s=(new Date).getTime(),e.next=5,db.read("uuid");case 5:return e.sent,e.next=8,privconf.read("mirror");case 8:if(e.sent){e.next=10;break}return e.abrupt("return",fetch(o));case 10:return Promise.any||(Promise.any=function(e){return new Promise(function(t,n){var r=(e=Array.isArray(e)?e:[]).length,a=[];if(0===r)return n(new AggregateError("All promises were rejected"));e.forEach(function(e){e.then(function(e){t(e)},function(e){r--,a.push(e),0===r&&n(new AggregateError(a))})})})}),i=new AbortController,r=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Response,e.next=3,t.arrayBuffer();case 3:return e.t1=e.sent,e.t2={status:t.status,headers:t.headers},e.abrupt("return",new e.t0(e.t1,e.t2));case 6:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),n=Promise.any(t.map(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(c){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function e(n,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch(c,{signal:i.signal}).then(r).then(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:200==(t=r.clone()).status?(setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=db,e.next=4,_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t1=JSON,e.next=4,db.read("HIT_HOT");case 4:if(e.t2=e.sent,e.t0=e.t1.parse.call(e.t1,e.t2),e.t0){e.next=8;break}e.t0={site:{},static:{}};case 8:return e.abrupt("return",e.t0);case 11:return e.prev=11,e.t3=e.catch(0),e.abrupt("return",{site:{},static:{}});case 14:case"end":return e.stop()}},e,null,[[0,11]])}))();case 2:return t=e.sent,n=c.split("/")[2],t[n]=t[n]?t[n]+1:1,-1<blog.plus.indexOf(n)?t.site[n]=t.site[n]?t.site[n]+1:1:t.static[n]=t.static[n]?t.static[n]+1:1,e.abrupt("return",JSON.stringify(t));case 7:case"end":return e.stop()}},e)}))();case 4:return e.t1=e.sent,e.t0.write.call(e.t0,"HIT_HOT",e.t1),e.t2=db,e.next=9,_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t1=JSON,e.next=4,db.read("HIT_HOT_SIZE");case 4:if(e.t2=e.sent,e.t0=e.t1.parse.call(e.t1,e.t2),e.t0){e.next=8;break}e.t0={site:{},static:{}};case 8:return e.abrupt("return",e.t0);case 11:return e.prev=11,e.t3=e.catch(0),e.abrupt("return",{site:{},static:{}});case 14:case"end":return e.stop()}},e,null,[[0,11]])}))();case 2:return t=e.sent,n=c.split("/")[2],t[n]=t[n]?t[n]+Number(r.headers.get("Content-Length")):Number(r.headers.get("Content-Length")),-1<blog.plus.indexOf(n)?t.site[n]=t.site[n]?t.site[n]+Number(r.headers.get("Content-Length")):Number(r.headers.get("Content-Length")):t.static[n]=t.static[n]?t.static[n]+Number(r.headers.get("Content-Length")):Number(r.headers.get("Content-Length")),e.abrupt("return",JSON.stringify(t));case 7:case"end":return e.stop()}},e)}))();case 9:e.t3=e.sent,e.t2.write.call(e.t2,"HIT_HOT_SIZE",e.t3),e.next=15;break;case 13:e.prev=13,e.t4=e.catch(0);case 15:case"end":return e.stop()}},e,null,[[0,13]])})),0),i.abort(),cons.s("LFetch Success! | Time: ".concat((new Date).getTime()-s,"ms | Origin: ").concat(o," ")),n(t)):a(null);case 2:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){String(e).match("The user aborted a request")||String(e).match("Failed to fetch")||(String(e).match("been blocked by CORS policy")?cons.e("LFetch Blocked by CORS policy! | Origin: ".concat(o)):cons.e("LFetch Error! | Origin: ".concat(o," | Resean: ").concat(e))),a(null)});case 1:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())).then(function(e){return e}).catch(function(){return null}),e.abrupt("return",n);case 15:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),privconf={read:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=JSON,e.next=4,db.read("priv_config");case 4:if(e.t1=e.sent,e.t1){e.next=7;break}e.t1="{}";case 7:return e.t2=e.t1,n=e.t0.parse.call(e.t0,e.t2),e.abrupt("return","boolean"==typeof n[t]?n[t]:"globalcompute"!=t);case 12:return e.prev=12,e.t3=e.catch(0),e.abrupt("return",!0);case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(e){return t.apply(this,arguments)}}(),change:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,db.read("priv_config");case 3:if(e.t1=e.sent,e.t1){e.next=6;break}e.t1="{}";case 6:return e.t2=e.t1,"boolean"!=typeof(n=e.t0.parse.call(e.t0,e.t2))[t]&&(n[t]=!0),n[t]=!n[t],e.next=12,db.write("priv_config",JSON.stringify(n));case 12:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()},fullpath=function(e){return(e=e.split("?")[0].split("#")[0]).match(/\/$/)&&(e+="index"),e.match(/\.[a-zA-Z]+$/)||(e+=".html"),e},set_blog_config=function(e){self.packagename="muggledy-blog-html",self.blogversion=e,self.blog={local:0,origin:["muggledy.top","muggledy.github.io","localhost:4000","127.0.0.1:4000"],plus:["vercel.muggledy.top"],npmmirror:["https://unpkg.com/".concat(packagename,"@").concat(blogversion),"https://npm.elemecdn.com/".concat(packagename,"@").concat(blogversion),"https://cdn.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://cdn-jsd.pigax.cn/npm/".concat(packagename,"@").concat(blogversion),"https://fastly.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://testingcf.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://originfastly.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://gcore.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://quantil.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion)]}},set_newest_blogver=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return self.packagename="muggledy-blog-html",t=["https://registry.npmmirror.com/".concat(packagename,"/latest"),"https://registry.npmjs.org/".concat(packagename,"/latest"),"https://mirrors.cloud.tencent.com/npm/".concat(packagename,"/latest")],e.abrupt("return",lfetch(t,t[0]).then(function(e){return e.json()}).then(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.version){e.next=2;break}throw"No Version Found!";case 2:return e.t0=choose_the_newest_version,e.t1=t.version,e.next=6,db.read("blog_version");case 6:if(e.t2=e.sent,e.t2){e.next=9;break}e.t2=blog_default_version;case 9:return e.t3=e.t2,n=(0,e.t0)(e.t1,e.t3),e.t4=cons,e.t5="Newest Version: ".concat(t.version," ; Local Version: "),e.next=15,db.read("blog_version");case 15:return e.t6=e.sent,e.t7=e.t5.concat.call(e.t5,e.t6," | Update answer: ").concat(n),e.t4.d.call(e.t4,e.t7),e.next=20,db.write("blog_version",n);case 20:set_blog_config(n);case 21:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){cons.e("Get Blog Newest Version Erorr!Reseon:".concat(e)),set_blog_config(blog_default_version)}));case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),choose_the_newest_version=function(c,o){function s(e){var t=e.split(".")[0];return[parseInt(t),e.replace(t+".","")]}return function e(t,n){var r=_slicedToArray(s(t),2),a=r[0],t=r[1],r=_slicedToArray(s(n),2),n=r[0],r=r[1];return n<a?c:a<n?o:t.match(/\./)||r.match(/\./)?e(t,r):parseInt(t)>parseInt(r)?c:o}(c,o)};setInterval(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,set_newest_blogver();case 2:case"end":return e.stop()}},e)})),12e4),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,set_newest_blogver();case 2:case"end":return e.stop()}},e)})),1e3),self.addEventListener("fetch",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t.respondWith(handle(t.request))}catch(e){t.respondWith(handleerr(t.request,e))}case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());