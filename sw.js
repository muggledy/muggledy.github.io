"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var n;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,c,o,i=[],s=!0,u=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=c.call(n)).done)&&(i.push(r.value),i.length!==e);s=!0);}catch(t){u=!0,a=t}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return o};var s,o={},t=Object.prototype,u=t.hasOwnProperty,l=Object.defineProperty||function(t,e,n){t[e]=n.value},e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",a=e.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(s){c=function(t,e,n){return t[e]=n}}function i(t,e,n,r){var a,c,o,i,e=e&&e.prototype instanceof y?e:y,e=Object.create(e.prototype),r=new T(r||[]);return l(e,"_invoke",{value:(a=t,c=n,o=r,i=h,function(t,e){if(i===m)throw new Error("Generator is already running");if(i===g){if("throw"===t)throw e;return{value:s,done:!0}}for(o.method=t,o.arg=e;;){var n=o.delegate;if(n){n=function t(e,n){var r=n.method,a=e.iterator[r];if(a===s)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=s,t(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;r=p(a,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,d;a=r.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=s),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}(n,o);if(n){if(n===d)continue;return n}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(i===h)throw i=g,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=m;n=p(a,c,o);if("normal"===n.type){if(i=o.done?g:f,n.arg===d)continue;return{value:n.arg,done:o.done}}"throw"===n.type&&(i=g,o.method="throw",o.arg=n.arg)}})}),e}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}o.wrap=i;var h="suspendedStart",f="suspendedYield",m="executing",g="completed",d={};function y(){}function b(){}function v(){}var e={},_=(c(e,r,function(){return this}),Object.getPrototypeOf),_=_&&_(_(E([]))),x=(_&&_!==t&&u.call(_,r)&&(e=_),v.prototype=y.prototype=Object.create(e));function w(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function k(o,i){var e;l(this,"_invoke",{value:function(n,r){function t(){return new i(function(t,e){!function e(t,n,r,a){var c,t=p(o[t],o,n);if("throw"!==t.type)return(n=(c=t.arg).value)&&"object"==_typeof(n)&&u.call(n,"__await")?i.resolve(n.__await).then(function(t){e("next",t,r,a)},function(t){e("throw",t,r,a)}):i.resolve(n).then(function(t){c.value=t,r(c)},function(t){return e("throw",t,r,a)});a(t.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}})}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function E(e){if(e||""===e){var n,t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=s,t.done=!0,t}).next=t}throw new TypeError(_typeof(e)+" is not iterable")}return l(x,"constructor",{value:b.prototype=v,configurable:!0}),l(v,"constructor",{value:b,configurable:!0}),b.displayName=c(v,a,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,a,"GeneratorFunction")),t.prototype=Object.create(x),t},o.awrap=function(t){return{__await:t}},w(k.prototype),c(k.prototype,n,function(){return this}),o.AsyncIterator=k,o.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var c=new k(i(t,e,n,r),a);return o.isGeneratorFunction(e)?c:c.next().then(function(t){return t.done?t.value:c.next()})},w(x),c(x,a,"Generator"),c(x,r,function(){return this}),c(x,"toString",function(){return"[object Generator]"}),o.keys=function(t){var e,n=Object(t),r=[];for(e in n)r.push(e);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},o.values=E,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return c.type="throw",c.arg=n,r.next=t,e&&(r.method="next",r.arg=s),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var a=this.tryEntries[e],c=a.completion;if("root"===a.tryLoc)return t("end");if(a.tryLoc<=this.prev){var o=u.call(a,"catchLoc"),i=u.call(a,"finallyLoc");if(o&&i){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);if(this.prev<a.finallyLoc)return t(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return t(a.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return t(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}var c=(a=a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc?null:a)?a.completion:{};return c.type=t,c.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,r,a=this.tryEntries[e];if(a.tryLoc===t)return"throw"===(n=a.completion).type&&(r=n.arg,j(a)),r}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=s),d}},o}function asyncGeneratorStep(t,e,n,r,a,c,o){try{var i=t[c](o),s=i.value}catch(t){return void n(t)}i.done?e(s):Promise.resolve(s).then(r,a)}function _asyncToGenerator(i){return function(){var t=this,o=arguments;return new Promise(function(e,n){var r=i.apply(t,o);function a(t){asyncGeneratorStep(r,e,n,a,c,"next",t)}function c(t){asyncGeneratorStep(r,e,n,a,c,"throw",t)}a(void 0)})}}var CACHE_NAME="MuggledyBlogCacheHelper",cachelist=["/404.html"],blog_default_version="1.0.19",generate_uuid=(self.cons={s:function(t){console.log("%c[SUCCESS]%c ".concat(t),"color:white;background:green;","")},w:function(t){console.log("%c[WARNING]%c ".concat(t),"color:brown;background:yellow;","")},i:function(t){console.log("%c[INFO]%c ".concat(t),"color:white;background:blue;","")},e:function(t){console.log("%c[ERROR]%c ".concat(t),"color:white;background:red;","")},d:function(t){console.log("%c[DEBUG]%c ".concat(t),"color:white;background:black;","")}},self.db={read:function(n,t){return new Promise(function(e,t){caches.open(CACHE_NAME).then(function(t){t.match(new Request("https://LOCALCACHE/".concat(encodeURIComponent(n)))).then(function(t){t||e(null),t.text().then(function(t){return e(t)})}).catch(function(){e(null)})})})},write:function(n,r){return new Promise(function(e,t){caches.open(CACHE_NAME).then(function(t){t.put(new Request("https://LOCALCACHE/".concat(encodeURIComponent(n))),new Response(r)),e()}).catch(function(){t()})})}},function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}),handleerr=(self.addEventListener("activate",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:self.clients.claim();case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()),self.addEventListener("install",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:self.skipWaiting(),e.waitUntil(caches.open(CACHE_NAME).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,db.read("uuid");case 2:if(t.sent){t.next=5;break}return t.next=5,db.write("uuid",generate_uuid());case 5:return t.abrupt("return",e.addAll(cachelist));case 6:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()),function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Response("<h1>MuggledyBlogCacheHelper Error</h1>\n    <b>".concat(n,"</b>"),{headers:{"content-type":"text/html; charset=utf-8"}}));case 1:case"end":return t.stop()}},t)}));return function(t,e){return n.apply(this,arguments)}}()),cdn={gh:{statically:{url:"https://cdn.statically.io/gh"},jsdelivr:{url:"https://cdn.jsdelivr.net/gh"},githack:{url:"https://rawcdn.githack.com"}},combine:{jsdelivr:{url:"https://cdn.jsdelivr.net/combine"}},unpkg_version:{unpkg:{url:"https://unpkg.com"},jsdelivr:{url:"https://cdn.jsdelivr.net/npm"},eleme:{url:"https://npm.elemecdn.com"},jjz:{url:"https://jsd.onmicrosoft.cn/npm"},sourceg:{url:"https://npm.sourcegcdn.com"},cloudflare:{url:"https://cdnjs.cloudflare.com/ajax/libs"},bootcss:{url:"https://cdn.bootcss.com"}},npm:{eleme:{url:"https://npm.elemecdn.com"},jsdelivr:{url:"https://cdn.jsdelivr.net/npm"},jjz:{url:"https://jsd.onmicrosoft.cn/npm"},jjz_unpkg:{url:"https://npkg.onmicrosoft.cn"},sourceg:{url:"https://npm.sourcegcdn.com"},GNT:{url:"https://cdn.bilicdn.tk/npm"}}},handle=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(o){var i,e,s,r,n,u,a,c,l,p,h,f,m,g,d,y,b,v,_;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=set_blog_config,t.next=3,db.read("blog_version");case 3:if(t.t1=t.sent,t.t1){t.next=6;break}t.t1=blog_default_version;case 6:return t.t2=t.t1,(0,t.t0)(t.t2),t.next=10,o.clone();case 10:return t.sent,i=o.url,e=new URL(i),t.next=15,db.read("uuid");case 15:if(t.sent,s=e.href.substr(e.origin.length),r=i.split("/")[2],s.match(/\/sw\.js/g))return t.abrupt("return",fetch(o));t.next=20;break;case 20:return n=function(t){return e.searchParams.get(t)},u=[],p=l=c=a=null,t.t4=JSON,t.next=29,db.read("msg");case 29:if(t.t5=t.sent,t.t3=t.t4.parse.call(t.t4,t.t5),t.t3){t.next=33;break}t.t3=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,db.write("msg","[]");case 2:return t.abrupt("return","[]");case 3:case"end":return t.stop()}},t)}))();case 33:if(h=t.t3,f=i.split("?")[0],m=new Request(f),g=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,caches.open(CACHE_NAME);case 2:return n=t.sent,t.next=5,n.delete(e);case 5:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),"true"==n("nosw"))return t.abrupt("return",fetch(o));t.next=39;break;case 39:if("true"==n("delete"))return g(m),h.push({name:"文件已删除",time:new Date,info:"已删除".concat(f)}),t.next=44,db.write("msg",JSON.stringify(h));t.next=45;break;case 44:return t.abrupt("return",new Response(JSON.stringify({ok:1})));case 45:if("true"==n("forceupdate"))return h.push({name:"文件已强制更新",time:new Date,info:"已更新".concat(f)}),t.next=49,db.write("msg",JSON.stringify(h));t.next=52;break;case 49:return t.next=51,fetch(o).then(function(e){return caches.open(CACHE_NAME).then(function(t){return g(m),t.put(o,e.clone()),e})});case 51:return t.abrupt("return",new Response(JSON.stringify({ok:1})));case 52:t.t6=_regeneratorRuntime().keys(cdn);case 53:if((t.t7=t.t6()).done){t.next=104;break}d=t.t7.value,t.t8=_regeneratorRuntime().keys(cdn[d]);case 56:if((t.t9=t.t8()).done){t.next=102;break}if(y=t.t9.value,r!=cdn[d][y].url.split("https://")[1].split("/")[0]||!i.match(cdn[d][y].url)){t.next=100;break}u=[],t.t10=_regeneratorRuntime().keys(cdn[d]);case 61:(t.t11=t.t10()).done?t.next=95:(v=t.t11.value,a=i.replace(cdn[d][y].url,cdn[d][v].url),"gh"!==d?t.next=68:(a.match("https://cdn.jsdelivr.net/gh")&&!i.match("https://cdn.jsdelivr.net/gh")?null===(c=a.split("https://")[1].split("/"))[3].match("@")&&(a=a.replace("".concat(c[2],"/").concat(c[3],"/"),"".concat(c[2],"/").concat(c[3],"@"))):a.match("https://cdn.statically.io/gh")&&i.match("https://cdn.jsdelivr.net/gh")?a=null!==(l=a.split("https://")[1].split("/"))[3].match("@")?a.replace("".concat(l[2],"/").concat(l[3],"/"),"".concat(l[2],"/").concat(l[3].split("@").join("/"),"/")):a.replace("".concat(l[2],"/").concat(l[3],"/"),"".concat(l[2],"/").concat(l[3],"/master/")):a.match("https://rawcdn.githack.com")&&!i.match("https://rawcdn.githack.com")&&(l=a.split("https://")[1].split("/"),i.match("https://cdn.jsdelivr.net/gh")&&(a=null!==l[2].match("@")?a.replace("".concat(l[1],"/").concat(l[2],"/"),"".concat(l[1],"/").concat(l[2].split("@").join("/"),"/")):a.replace("".concat(l[1],"/").concat(l[2],"/"),"".concat(l[1],"/").concat(l[2],"/master/"))),!l[l.length-1].endsWith(".min.js")&&!l[l.length-1].endsWith(".min.css")||"celestezj"===l[1]&&/\b(swiper.min.css|swiper.min.js|swiper_init.min.js|APlayer.min.js|APlayer.min.css|all.min.css|font-awesome-animation.min.css|buttons.min.css|Valine.min.js|activate-power-mode.min.js)\b/.test(l[l.length-1])||(a=a.replace(/(.*).min.(js|css)/,"$1.$2"))),t.next=92));break;case 68:"unpkg_version"!==d?t.next=92:!a.match("https://cdnjs.cloudflare.com/ajax/libs")||i.match("https://cdnjs.cloudflare.com/ajax/libs")||i.match("https://cdn.bootcss.com")?t.next=80:((l=a.split("https://")[1].split("/"))[3].startsWith("@")&&(a=a.replace("".concat(l[3],"/"),""),l=a.split("https://")[1].split("/")),null===l[3].match("@")?t.next=77:(a=(p=a.replace("".concat(l[2],"/").concat(l[3],"/").concat("typed.js"===l[3].split("@")[0]?"lib":"dist","/"),"".concat(l[2],"/").concat(l[3].split("@").join("/"),"/")))===a?a.replace("".concat(l[2],"/").concat(l[3],"/"),"".concat(l[2],"/").concat(l[3].split("@").join("/"),"/")):p,t.next=78));break;case 77:return t.abrupt("continue",61);case 78:t.next=92;break;case 80:!a.match("https://cdn.bootcss.com")||i.match("https://cdnjs.cloudflare.com/ajax/libs")||i.match("https://cdn.bootcss.com")?t.next=91:((l=a.split("https://")[1].split("/"))[1].startsWith("@")&&(a=a.replace("".concat(l[1],"/"),""),l=a.split("https://")[1].split("/")),null===l[1].match("@")?t.next=88:(a=(p=a.replace("".concat(l[0],"/").concat(l[1],"/").concat("typed.js"===l[1].split("@")[0]?"lib":"dist","/"),"".concat(l[0],"/").concat(l[1].split("@").join("/"),"/")))===a?a.replace("".concat(l[0],"/").concat(l[1],"/"),"".concat(l[0],"/").concat(l[1].split("@").join("/"),"/")):p,t.next=89));break;case 88:return t.abrupt("continue",61);case 89:t.next=92;break;case 91:a.match("https://cdnjs.cloudflare.com/ajax/libs")||a.match("https://cdn.bootcss.com")||!i.match("https://cdnjs.cloudflare.com/ajax/libs")&&!i.match("https://cdn.bootcss.com")||(c=a.split("https://")[1].split("/"),a=a.match("https://cdn.jsdelivr.net/npm")||a.match("https://jsd.onmicrosoft.cn/npm")?a.replace("".concat(c[2],"/").concat(c[3],"/"),"".concat(c[2].toLowerCase(),"@").concat(c[3],"/").concat("typed.js"===c[2]?"lib":"dist","/")):a.replace("".concat(c[1],"/").concat(c[2],"/"),"".concat(c[1].toLowerCase(),"@").concat(c[2],"/").concat("typed.js"===c[1]?"lib":"dist","/")));case 92:u.push(a),t.next=61;break;case 95:return t.next=97,privconf.read("cache");case 97:if(t.sent){t.next=99;break}return t.abrupt("return",lfetch(u,i));case 99:return t.abrupt("return",caches.match(o).then(function(t){return t||lfetch(u,i).then(function(e){return caches.open(CACHE_NAME).then(function(t){return t.put(o,e.clone()),e})})}));case 100:t.next=56;break;case 102:t.next=53;break;case 104:b=_regeneratorRuntime().mark(function t(){var e,n,c;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.split(":")[0]!=blog.origin[_].split(":")[0])t.next=9;else{if(blog.local)return t.abrupt("return",{v:fetch(o)});t.next=3}break;case 3:for(e in setTimeout(_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,set_newest_blogver();case 2:case"end":return t.stop()}},t)})),3e4),u=[],blog.plus)u.push("https://".concat(blog.plus[e])+fullpath(s));for(n in blog.npmmirror)u.push(blog.npmmirror[n]+fullpath(s));return c=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Response,t.next=3,e.arrayBuffer();case 3:return t.t1=t.sent,t.t2={headers:{"Content-Type":"text/html;charset=utf-8"},status:e.status,statusText:e.statusText},t.abrupt("return",new t.t0(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),t.abrupt("return",{v:new Promise(function(a,t){setTimeout(function(){caches.match(o).then(function(t){t?(cons.s("Cache Hited! | Origin:".concat(i)),setTimeout(function(){a(t)},200),setTimeout(function(){lfetch(u,i).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",caches.open(CACHE_NAME).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.delete(o),cons.s("Cache Updated! | Origin:".concat(i)),fullpath(s).match(/\.html$/g))return t.next=5,c(r);t.next=10;break;case 5:n=t.sent,e.put(o,n.clone()),a(n),t.next=12;break;case 10:e.put(o,r.clone()),a(r);case 12:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}())},0)):(cons.w("Cache Missed! | Origin:".concat(i)),setTimeout(function(){lfetch(u,i).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",caches.open(CACHE_NAME).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(fullpath(s).match(/\.html$/g))return t.next=3,c(r);t.next=8;break;case 3:n=t.sent,e.put(o,n.clone()),a(n),t.next=10;break;case 8:e.put(o,r.clone()),a(r);case 10:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()).catch(function(t){a(caches.match(new Request("/404.html")))})},0),setTimeout(function(){a(caches.match(new Request("/404.html")))},5e3))})},0)})});case 9:case"end":return t.stop()}},t)}),t.t12=_regeneratorRuntime().keys(blog.origin);case 106:if((t.t13=t.t12()).done){t.next=114;break}return _=t.t13.value,t.delegateYield(b(),"t14",109);case 109:if(v=t.t14)return t.abrupt("return",v.v);t.next=112;break;case 112:t.next=106;break;case 114:return t.abrupt("return",fetch(o));case 115:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),lfetch=function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,o){var i,s,r,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return cons.i("LFetch Handled! | Mirrors Count:".concat(e.length," | Origin: ").concat(o)),console.log(e),i=(new Date).getTime(),t.next=5,db.read("uuid");case 5:return t.sent,t.next=8,privconf.read("mirror");case 8:if(t.sent){t.next=10;break}return t.abrupt("return",fetch(o));case 10:return Promise.any||(Promise.any=function(t){return new Promise(function(e,n){var r=(t=Array.isArray(t)?t:[]).length,a=[];if(0===r)return n(new AggregateError("All promises were rejected"));t.forEach(function(t){t.then(function(t){e(t)},function(t){r--,a.push(t),0===r&&n(new AggregateError(a))})})})}),s=new AbortController,r=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Response,t.next=3,e.arrayBuffer();case 3:return t.t1=t.sent,t.t2={status:e.status,headers:e.headers},t.abrupt("return",new t.t0(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),n=Promise.any(e.map(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(c){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function t(n,a){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:fetch(c,{signal:s.signal}).then(r).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:200==(e=r.clone()).status?(setTimeout(_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=db,t.next=4,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t1=JSON,t.next=4,db.read("HIT_HOT");case 4:if(t.t2=t.sent,t.t0=t.t1.parse.call(t.t1,t.t2),t.t0){t.next=8;break}t.t0={site:{},static:{}};case 8:return t.abrupt("return",t.t0);case 11:return t.prev=11,t.t3=t.catch(0),t.abrupt("return",{site:{},static:{}});case 14:case"end":return t.stop()}},t,null,[[0,11]])}))();case 2:return e=t.sent,n=c.split("/")[2],e[n]=e[n]?e[n]+1:1,-1<blog.plus.indexOf(n)?e.site[n]=e.site[n]?e.site[n]+1:1:e.static[n]=e.static[n]?e.static[n]+1:1,t.abrupt("return",JSON.stringify(e));case 7:case"end":return t.stop()}},t)}))();case 4:return t.t1=t.sent,t.t0.write.call(t.t0,"HIT_HOT",t.t1),t.t2=db,t.next=9,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t1=JSON,t.next=4,db.read("HIT_HOT_SIZE");case 4:if(t.t2=t.sent,t.t0=t.t1.parse.call(t.t1,t.t2),t.t0){t.next=8;break}t.t0={site:{},static:{}};case 8:return t.abrupt("return",t.t0);case 11:return t.prev=11,t.t3=t.catch(0),t.abrupt("return",{site:{},static:{}});case 14:case"end":return t.stop()}},t,null,[[0,11]])}))();case 2:return e=t.sent,n=c.split("/")[2],e[n]=e[n]?e[n]+Number(r.headers.get("Content-Length")):Number(r.headers.get("Content-Length")),-1<blog.plus.indexOf(n)?e.site[n]=e.site[n]?e.site[n]+Number(r.headers.get("Content-Length")):Number(r.headers.get("Content-Length")):e.static[n]=e.static[n]?e.static[n]+Number(r.headers.get("Content-Length")):Number(r.headers.get("Content-Length")),t.abrupt("return",JSON.stringify(e));case 7:case"end":return t.stop()}},t)}))();case 9:t.t3=t.sent,t.t2.write.call(t.t2,"HIT_HOT_SIZE",t.t3),t.next=15;break;case 13:t.prev=13,t.t4=t.catch(0);case 15:case"end":return t.stop()}},t,null,[[0,13]])})),0),s.abort(),cons.s("LFetch Success! | Time: ".concat((new Date).getTime()-i,"ms | Origin: ").concat(o," ")),n(e)):a(null);case 2:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()).catch(function(t){String(t).match("The user aborted a request")||String(t).match("Failed to fetch")||(String(t).match("been blocked by CORS policy")?cons.e("LFetch Blocked by CORS policy! | Origin: ".concat(o)):cons.e("LFetch Error! | Origin: ".concat(o," | Resean: ").concat(t))),a(null)});case 1:case"end":return t.stop()}},t)}));return function(t,e){return n.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}())).then(function(t){return t}).catch(function(){return null}),t.abrupt("return",n);case 15:case"end":return t.stop()}},t)}));return function(t,e){return n.apply(this,arguments)}}(),privconf={read:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=JSON,t.next=4,db.read("priv_config");case 4:if(t.t1=t.sent,t.t1){t.next=7;break}t.t1="{}";case 7:return t.t2=t.t1,n=t.t0.parse.call(t.t0,t.t2),t.abrupt("return","boolean"==typeof n[e]?n[e]:"globalcompute"!=e);case 12:return t.prev=12,t.t3=t.catch(0),t.abrupt("return",!0);case 15:case"end":return t.stop()}},t,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),change:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,db.read("priv_config");case 3:if(t.t1=t.sent,t.t1){t.next=6;break}t.t1="{}";case 6:return t.t2=t.t1,"boolean"!=typeof(n=t.t0.parse.call(t.t0,t.t2))[e]&&(n[e]=!0),n[e]=!n[e],t.next=12,db.write("priv_config",JSON.stringify(n));case 12:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()},fullpath=function(t){return(t=t.split("?")[0].split("#")[0]).match(/\/$/)&&(t+="index"),t.match(/\.[a-zA-Z]+$/)||(t+=".html"),t},set_blog_config=function(t){self.packagename="muggledy-blog-html",self.blogversion=t,self.blog={local:0,origin:["muggledy.top","muggledy.github.io","localhost:4000","127.0.0.1:4000"],plus:["vercel.muggledy.top"],npmmirror:["https://unpkg.com/".concat(packagename,"@").concat(blogversion),"https://npm.elemecdn.com/".concat(packagename,"@").concat(blogversion),"https://cdn.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://cdn-jsd.pigax.cn/npm/".concat(packagename,"@").concat(blogversion),"https://fastly.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://testingcf.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://originfastly.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://gcore.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion),"https://quantil.jsdelivr.net/npm/".concat(packagename,"@").concat(blogversion)]}},set_newest_blogver=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return self.packagename="muggledy-blog-html",e=["https://registry.npmmirror.com/".concat(packagename,"/latest"),"https://registry.npmjs.org/".concat(packagename,"/latest"),"https://mirrors.cloud.tencent.com/npm/".concat(packagename,"/latest")],t.abrupt("return",lfetch(e,e[0]).then(function(t){return t.json()}).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.version){t.next=2;break}throw"No Version Found!";case 2:return t.t0=choose_the_newest_version,t.t1=e.version,t.next=6,db.read("blog_version");case 6:if(t.t2=t.sent,t.t2){t.next=9;break}t.t2=blog_default_version;case 9:return t.t3=t.t2,n=(0,t.t0)(t.t1,t.t3),t.t4=cons,t.t5="Newest Version: ".concat(e.version," ; Local Version: "),t.next=15,db.read("blog_version");case 15:return t.t6=t.sent,t.t7=t.t5.concat.call(t.t5,t.t6," | Update answer: ").concat(n),t.t4.d.call(t.t4,t.t7),t.next=20,db.write("blog_version",n);case 20:set_blog_config(n);case 21:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()).catch(function(t){cons.e("Get Blog Newest Version Erorr!Reseon:".concat(t)),set_blog_config(blog_default_version)}));case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),choose_the_newest_version=function(c,o){function i(t){var e=t.split(".")[0];return[parseInt(e),t.replace(e+".","")]}return function t(e,n){var e=_slicedToArray(i(e),2),r=e[0],e=e[1],n=_slicedToArray(i(n),2),a=n[0],n=n[1];return a<r?c:r<a?o:e.match(/\./)||n.match(/\./)?t(e,n):parseInt(e)>parseInt(n)?c:o}(c,o)};setInterval(_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,set_newest_blogver();case 2:case"end":return t.stop()}},t)})),12e4),setTimeout(_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,set_newest_blogver();case 2:case"end":return t.stop()}},t)})),1e3),self.addEventListener("fetch",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:try{e.respondWith(handle(e.request))}catch(t){e.respondWith(handleerr(e.request,t))}case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}());